(window["webpackJsonpfire-fight-rl"]=window["webpackJsonpfire-fight-rl"]||[]).push([[0],{142:function(t,e,a){t.exports=a(325)},147:function(t,e,a){},325:function(t,e,a){"use strict";a.r(e);var n=a(5),r=a.n(n),i=a(84),s=a.n(i),c=(a(147),a(0)),o=a(1),u=a(3),l=a(2),h=a(4),p=(a(87),a(8)),f=a(141),y=a.n(f),d={TITLE:0,LEVEL:1},g=a(20),b=a(14),m=a.n(b),v=a(21),O=a(23),j=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;if(!(t<=0))return new Promise(function(e){return setTimeout(e,t)})},k=function(t){return t[Math.floor(Math.random()*t.length)]},E=function(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t))+t},x=function(t){return"".concat(t.x,",").concat(t.y)},w=function(t,e,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4,r=t.map,i=function(e,a){var n=r[e+","+a];return!!n&&t.tileKey[n.type].passable},s=new O.e.AStar(e.x,e.y,i,{topology:n}),c=[];return s.compute(a.x,a.y,function(t,e){c.push({x:t,y:e})}),c.slice(1)},P=function(t,e,a,n,r){return w(t,e,a,n).slice(0,r+1)},A=function(t){var e=Object.keys(t),a=k(e).split(",");return{coordinates:{x:parseInt(a[0]),y:parseInt(a[1])},text:a}},C=function(t){return t.filter(function(t){return t.hasOwnProperty("durability")})},T=function(t){return 2/3*(Math.pow(t,3)-9*Math.pow(t,2)+32*t-18)},D=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,n=T(a),r=[],i=0;i<n;i++){var s=Math.round(t+Math.cos(2*Math.PI/n*i)*a),c=Math.round(e+Math.sin(2*Math.PI/n*i)*a);r.push({x:s,y:c})}return r},S=a(13),I=a(22),N=a(7),R=a(25),L=a.n(R),M=a(16),G=a.n(M),F=function(t){if(t.energy=0,t.pos){var e=t.game.map[x(t.pos)];t.game.map[x(t.pos)].entities=e.entities.filter(function(e){return e.id!==t.id})}t.game.engine.removeStatusEffectByActorId(t.id),t.game.draw(),t.active=!1},B="#424242",_="#606b79",W="#B7C3CD",q="#CED5DD",H="#E16264",U={base03:"#002b36",base02:"#073642",base01:"#586e75",base00:"#657b83",base0:"#839496",base1:"#93a1a1",base2:"#eee8d5",base3:"#fdf6e3",yellow:"#b58900",orange:"#cb4b16",red:"#dc322f",magenta:"#d33682",violet:"#6c71c4",blue:"#268bd2",cyan:"#2aa198",green:"#859900"},z={GROUND:{background:U.base03,foreground:U.base01,character:".",passable:!0},FLOOR:{background:U.base02,foreground:U.base0,character:"",passable:!0},SAFE_FLOOR:{background:U.base02,foreground:U.base0,character:"",passable:!0},BURNT:{background:U.base03,foreground:U.red,character:"X",passable:!0,animation:[{background:U.base03,foreground:U.red,character:"X",passable:!0},{background:U.base03,foreground:U.red,character:"x",passable:!0},{background:U.base03,foreground:U.red,character:"X",passable:!0},{background:U.base03,foreground:U.orange,character:"x",passable:!0},{background:U.base03,foreground:U.orange,character:"X",passable:!0},{background:U.base03,foreground:U.yellow,character:"x",passable:!0},{background:U.base03,foreground:U.red,character:"X",passable:!0}]},WET:{background:U.base03,foreground:U.blue,character:"=",passable:!0,animation:[{background:U.base03,foreground:U.blue,character:"=",passable:!0},{background:U.base03,foreground:U.blue,character:"~",passable:!0},{background:U.base03,foreground:U.blue,character:"=",passable:!0},{background:U.base03,foreground:U.base0,character:"~",passable:!0},{background:U.base03,foreground:U.base1,character:"=",passable:!0},{background:U.base03,foreground:U.base1,character:"~",passable:!0},{background:U.base03,foreground:U.blue,character:"=",passable:!0}]},WALL:{background:U.base02,foreground:U.base2,character:"#",passable:!1},DOOR:{background:U.base02,foreground:U.base0,character:"+",passable:!0},SAFE:{background:U.base02,foreground:U.green,character:"+",passable:!0},WATER:{animation:[{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#8aa",character:"\u2592",passable:!1},{background:"#424242",foreground:"#8aa",character:"\u2593",passable:!1}],background:"#9dc3d3",character:"\u2591",passable:!1},WIN:{background:"white",foreground:"black",character:"W",passable:!0}},K={N:[0,-1],NE:[1,-1],W:[-1,0],NW:[-1,-1],SW:[-1,1],S:[0,1],SE:[1,1],E:[1,0],NONE:[0,0]},V={HEAD:"HEAD",TORSO:"TORSO",BACK:"BACK",HAND:"HAND",FEET:"FEET",GENERIC:"GENERIC"},Y={human:function(){return[{type:V.HEAD,name:"head",item:null},{type:V.TORSO,name:"torso",item:null},{type:V.BACK,name:"back",item:null},{type:V.HAND,name:"left_hand",item:null},{type:V.HAND,name:"right_hand",item:null},{type:V.FEET,name:"feet",item:null}]},limited:function(){return[{type:V.GENERIC,name:"slot_1",item:null},{type:V.GENERIC,name:"slot_2",item:null}]}},X={verticalLine:{x_offset:1,y_offset:1,positions:[{x:0,y:0,taken:!1},{x:0,y:1,taken:!1},{x:0,y:-1,taken:!1}]},smallSquare:{x_offset:1,y_offset:1,positions:[{x:0,y:0,taken:!1},{x:0,y:1,taken:!1},{x:1,y:1,taken:!1},{x:1,y:0,taken:!1}]},square:{x_offset:2,y_offset:2,positions:[{x:0,y:0,taken:!1},{x:0,y:1,taken:!1},{x:1,y:1,taken:!1},{x:1,y:0,taken:!1},{x:1,y:-1,taken:!1},{x:0,y:-1,taken:!1},{x:-1,y:-1,taken:!1},{x:-1,y:0,taken:!1},{x:-1,y:1,taken:!1}]},bigSquare:{x_offset:2,y_offset:2,positions:[{x:0,y:0,taken:!1},{x:0,y:1,taken:!1},{x:1,y:1,taken:!1},{x:1,y:0,taken:!1},{x:1,y:-1,taken:!1},{x:0,y:-1,taken:!1},{x:-1,y:-1,taken:!1},{x:-1,y:0,taken:!1},{x:-1,y:1,taken:!1},{x:0,y:1,taken:!1},{x:2,y:2,taken:!1},{x:2,y:0,taken:!1},{x:2,y:-2,taken:!1},{x:0,y:-2,taken:!1},{x:-2,y:-2,taken:!1},{x:-2,y:0,taken:!1},{x:-2,y:2,taken:!1}]},circle:{x_offset:0,y_offset:0,positions:[].concat(Object(g.a)(D(0,0,2)),Object(g.a)(D(0,0,3)))}},J={default:{renderer:{character:"*",color:"black",background:"white"}},fail:{renderer:{character:"x",color:"black",background:"red"}},succede:{renderer:{character:"x",color:U.base3,background:U.green}},damage:{renderer:{character:"*",color:"darkred",background:"red"}},leaf:{renderer:{character:"\u2724",color:"#36635b",background:"#F0D8C0"}},water:{renderer:{character:"~",color:U.base3,background:U.blue}}},Q={directional:0,path:1},Z=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],$=a(32),tt={INFORMATION:{color:W,backgroundColor:B},ACTION:{color:_,backgroundColor:q},DANGER:{color:H,backgroundColor:B},STATUS_EFFECT:{color:U.base3,backgroundColor:U.violet},ERROR:{color:U.base3,backgroundColor:U.yellow}},et=function t(e){var a=e.text,n=void 0===a?"":a,r=e.type,i=void 0===r?tt.INFORMATION:r;Object(c.a)(this,t);var s=L()();this.id=s,this.text=n,this.type=i},at="Axe",nt="Water Gun",rt=function(t){return new zt({game:t.game,name:nt,passable:!0,attackDamage:0,equipmentType:V.GENERIC,renderer:{character:"w",color:U.blue,background:""}})},it=function(t){return new Kt({game:t.game,name:"Fire Jacket",passable:!0,defense:1,equipmentType:V.GENERIC,renderer:{character:"J",color:U.magenta,background:""}})};function st(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,n)}return a}function ct(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?st(a,!0).forEach(function(e){Object(p.a)(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):st(a).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}var ot=function(){function t(e){var a=e.game,n=e.actor,r=e.energyCost,i=void 0===r?100:r,s=e.processDelay,o=void 0===s?50:s,u=e.particles,l=void 0===u?[]:u,h=e.particleTemplate,p=void 0===h?J.default:h,f=e.onBefore,y=void 0===f?function(){return null}:f,d=e.onAfter,g=void 0===d?function(){return null}:d,b=e.onSuccess,m=void 0===b?function(){return null}:b,v=e.onFailure,O=void 0===v?function(){return null}:v,j=e.interrupt,k=void 0!==j&&j;Object(c.a)(this,t),this.actor=n,this.game=a,this.energyCost=i,this.processDelay=o,this.particles=l,this.particleTemplate=p,this.onBefore=y,this.onAfter=g,this.onSuccess=m,this.onFailure=O,this.interrupt=k}return Object(o.a)(t,[{key:"addParticle",value:function(t,e,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ct({},this.particleTemplate.renderer),r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Q.directional,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=new Yt({game:this.game,name:"particle",passable:!0,life:t,pos:e,direction:a,energy:100,renderer:n,type:r,path:i});this.particles.push(s)}},{key:"removeDeadParticles",value:function(){this.particles=this.particles.filter(function(t){return t.life>0})}},{key:"perform",value:function(){return console.log("".concat(this.actor.name," performs")),this.actor.energy-=this.energyCost,{success:!0,alternative:null}}}]),t}(),ut=function(t){function e(t){var a,n=t.message,r=t.messageType,i=void 0===r?tt.INFORMATION:r,s=t.processDelay,o=void 0===s?50:s,h=Object(N.a)(t,["message","messageType","processDelay"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,ct({},h)))).message=n,a.messageType=i,a.processDelay=o,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"perform",value:function(){return this.game.addMessage("".concat(this.actor.name,' says "').concat(this.message,'"'),this.messageType),this.actor.energy-=this.energyCost,{success:!0,alternative:null}}}]),e}(ot),lt=function(t){function e(t){var a,n=t.targetPos,r=t.radius,i=void 0===r?1:r,s=Object(N.a)(t,["targetPos","radius"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,ct({},s)))).targetPos=n,a.radius=i,a.particleTemplate=J.water,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"perform",value:function(){var t=this;if(!this.actor.hasItemNameEquipped(nt))return this.game.addMessage("".concat(this.actor.name," doesn't have a ").concat(nt,"."),tt.ERROR),{success:!1,alternative:null};var e={x_offset:0,y_offset:0,positions:Array(this.radius).fill("").reduce(function(t,e,a){return t.concat.apply(t,Object(g.a)(D(0,0,a+1)))},[])},a=e.positions.map(function(a){return{x:t.targetPos.x+a.x+e.x_offset,y:t.targetPos.y+a.y+e.y_offset}}).concat(ct({},this.targetPos));return a.forEach(function(e){var a=t.game.map[x(e)];a&&("BURNT"===a.type&&(a.type="GROUND"),"FLOOR"===a.type&&(a.type="WET"))}),a.forEach(function(e){t.addParticle(3,ct({},e),{x:Math.sign(e.x-t.targetPos.x),y:Math.sign(e.y-t.targetPos.y)})}),this.actor.energy-=this.energyCost,{success:!0,alternative:null}}}]),e}(ot),ht=function(t){function e(t){var a,n=t.item,r=Object(N.a)(t,["item"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,ct({},r)))).item=n,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"perform",value:function(){var t=this,e=!1;if(this.item.equipmentType)if(this.actor.getItemInSlot(this.item.equipmentType))this.game.addMessage("".concat(this.actor.name,"'s equipment slots are full."),tt.ERROR);else{this.actor.equip(this.item.equipmentType,this.item);var a=this.game.map[x(this.actor.pos)].entities;this.game.map[x(this.actor.pos)].entities=a.filter(function(e){return e.id!==t.item.id}),this.game.addMessage("".concat(this.actor.name," equips ").concat(this.item.name,"."),tt.ACTION),e=!0,this.actor.energy-=this.energyCost}return{success:e,alternative:null}}}]),e}(ot),pt=function(t){function e(t){var a,n=t.item,r=Object(N.a)(t,["item"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,ct({},r)))).item=n,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"perform",value:function(){return this.game.addMessage("".concat(this.actor.name," drops ").concat(this.item.name,"."),tt.ACTION),this.actor.unequip(this.item),this.game.map[x(this.actor.pos)].entities.splice(0,0,this.item),this.actor.energy-=this.energyCost,{success:!0,alternative:null}}}]),e}(ot),ft=function(t){function e(t){var a,n=t.processDelay,r=void 0===n?0:n,i=Object(N.a)(t,["processDelay"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,ct({},i)))).processDelay=r,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"perform",value:function(){return this.actor.energy-=this.energyCost,this.actor.destroy(),{success:!0,alternative:null}}}]),e}(ot),yt=function(t){function e(t){var a,n=t.targetPos,r=t.processDelay,i=void 0===r?0:r,s=Object(N.a)(t,["targetPos","processDelay"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,ct({},s)))).targetPos=n,a.processDelay=i,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"perform",value:function(){var t=this,e=!1,a=this.actor.initiatedBy.pos,n=w(this.game,this.targetPos,a,8);if((!this.actor.range||n.length<=this.actor.range)&&this.game.cursorCanOccupyPosition(this.targetPos)){var r=this.game.map[x(this.actor.pos)];this.game.map[x(this.actor.pos)]=ct({},r,{entities:r.entities.filter(function(e){return e.id!==t.actor.id})}),this.actor.pos=this.targetPos,this.game.map[x(this.targetPos)].entities.push(this.actor),e=!0}return{success:e,alternative:null}}}]),e}(ot),dt=function(t){function e(t){var a,n=t.targetPos,r=t.entity,i=t.interrupt,s=void 0===i||i,o=t.forcePlacement,h=void 0!==o&&o,p=Object(N.a)(t,["targetPos","entity","interrupt","forcePlacement"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,ct({},p)))).targetPos=n,a.entity=r,a.interrupt=s,a.forcePlacement=h,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"perform",value:function(){var t=!1,e=!!this.forcePlacement||this.game.canOccupyPosition(this.targetPos,this.entity),a=this.game.map[x(this.targetPos)];return e&&a&&(this.entity.pos=this.targetPos,a.entities.push(this.entity),this.game.engine.addActorAsNext(this.entity),t=!0),t&&(this.actor.energy-=this.energyCost),{success:t,alternative:null}}}]),e}(ot),gt=function(t){function e(t){var a,n=t.targetPos,r=t.processDelay,i=void 0===r?25:r,s=Object(N.a)(t,["targetPos","processDelay"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,ct({},s)))).targetPos=n,a.processDelay=i,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"perform",value:function(){var t=!1,e=null;return this.actor.move(this.targetPos)?(this.actor.energy-=this.energyCost,t=!0):(t=!0,e=new jt({targetPos:this.targetPos,game:this.game,actor:this.actor,energyCost:100})),{success:t,alternative:e}}}]),e}(ot),bt=function(t){function e(t){var a,n=t.targetPos,r=t.damageToSelf,i=void 0===r?1:r,s=t.processDelay,o=void 0===s?25:s,h=Object(N.a)(t,["targetPos","damageToSelf","processDelay"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,ct({},h)))).targetPos=n,a.processDelay=o,a.damageToSelf=i,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"perform",value:function(){var t=!1,e=null;return this.actor.move(this.targetPos)?(this.actor.energy-=this.energyCost,t=!0):(t=!0,e=new kt({targetPos:this.targetPos,game:this.game,actor:this.actor,energyCost:100,damageToSelf:this.damageToSelf})),{success:t,alternative:e}}}]),e}(ot),mt=function(t){function e(t){var a,n=t.targetPos,r=t.direction,i=Object(N.a)(t,["targetPos","direction"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,ct({},i)))).targetPos=n,a.direction=r,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"perform",value:function(){var t=!1,e=null;return this.actor.shove(this.targetPos,this.direction)?(this.actor.energy-=this.energyCost,t=!0):(t=!0,e=new jt({targetPos:this.targetPos,game:this.game,actor:this.actor,energyCost:100})),{success:t,alternative:e}}}]),e}(ot),vt=function(t){function e(t){var a,n=t.targetPos,r=Object(N.a)(t,["targetPos"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,ct({},r)))).targetPos=n,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"perform",value:function(){var t=!1;return this.actor.grab(this.targetPos)&&(this.actor.energy-=this.energyCost,t=!0,this.addParticle(2,ct({},this.targetPos),{x:0,y:0},J.succede.renderer)),{success:t,alternative:null}}}]),e}(ot),Ot=function(t){function e(t){var a=Object(I.a)({},t);return Object(c.a)(this,e),Object(u.a)(this,Object(l.a)(e).call(this,ct({},a)))}return Object(h.a)(e,t),Object(o.a)(e,[{key:"perform",value:function(){var t=!1,e=this.actor.release();return e&&(this.actor.energy-=this.energyCost,this.addParticle(2,ct({},e.pos),{x:0,y:0},J.succede.renderer),t=!0),{success:t,alternative:null}}}]),e}(ot),jt=function(t){function e(t){var a,n=t.targetPos,r=t.processDelay,i=void 0===r?100:r,s=Object(N.a)(t,["targetPos","processDelay"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,ct({},s)))).targetPos=n,a.processDelay=i,a.particleTemplate=J.damage,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"perform",value:function(){var t;return this.actor.entityTypes.includes("ATTACKING")?((t=this.actor.attack(this.targetPos))&&(this.addParticle(1,ct({},this.targetPos),{x:0,y:0}),this.actor.energy-=this.energyCost),{success:t,alternative:null}):{success:!0,alternative:new ut({message:"Ooh I don't know how to attack",game:this.game,actor:this.actor})}}}]),e}(ot),kt=function(t){function e(t){var a,n=t.damageToSelf,r=Object(N.a)(t,["damageToSelf"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,ct({},r)))).damageToSelf=n,a.onSuccess=function(){console.log("Self destruct success"),a.actor.decreaseDurabilityWithoutDefense(n)},a.onFailure=function(){console.log("Self destruct fails"),a.actor.destroy()},a}return Object(h.a)(e,t),e}(jt),Et=function(t){function e(t){var a=Object(I.a)({},t);return Object(c.a)(this,e),Object(u.a)(this,Object(l.a)(e).call(this,ct({},a)))}return Object(h.a)(e,t),Object(o.a)(e,[{key:"perform",value:function(){var t=!1,a=null;this.actor.passable=!1;var n=Object(S.a)(Object(l.a)(e.prototype),"perform",this).call(this);(n.success&&(this.actor.path.shift(),t=!0),0===this.actor.path.length&&(t=!0,a=new ft({game:this.game,actor:this.actor,energyCost:100,processDelay:0})),n.alternative)&&(this.actor.attack(this.targetPos)&&(a=new ft({game:this.game,actor:this.actor,energyCost:100,processDelay:0})));return{success:t,alternative:a}}}]),e}(gt),xt=function(t){function e(t){var a,n=Object(I.a)({},t);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,ct({},n)))).processDelay=0,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"perform",value:function(){var t=!1,a=null;this.actor.passable=!1;var n=Object(S.a)(Object(l.a)(e.prototype),"perform",this).call(this);return n.success&&(this.actor.path.shift(),t=!0),0===this.actor.path.length&&(t=!0,a=new ft({game:this.game,actor:this.actor,energyCost:100,processDelay:0})),n.alternative&&this.actor.attack(this.targetPos),{success:t,alternative:a}}}]),e}(gt),wt=function(t){function e(t){var a,n=t.engine,r=Object(N.a)(t,["engine"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,ct({},r)))).engine=n,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"perform",value:function(){var t=Object(v.a)(m.a.mark(function t(){var e,a;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=!0,a=null,console.log("".concat(this.actor.name," is cranking its engine.")),t.prev=3,t.next=6,this.engine.start();case 6:this.actor.energy-=this.energyCost,t.next=14;break;case 9:t.prev=9,t.t0=t.catch(3),console.log("CrankEngine"),console.log(t.t0),a=new ft({game:this.game,actor:this.actor,energyCost:100});case 14:return t.abrupt("return",{success:e,alternative:a});case 15:case"end":return t.stop()}},t,this,[[3,9]])}));return function(){return t.apply(this,arguments)}}()}]),e}(ot);function Pt(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,n)}return a}function At(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?Pt(a,!0).forEach(function(e){Object(p.a)(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):Pt(a).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}var Ct=function t(e){var a=e.game,n=void 0===a?null:a,r=e.passable,i=void 0!==r&&r,s=e.name,o=void 0===s?"nameless":s;Object(c.a)(this,t);var u=L()();this.entityTypes=["Entity"],this.id=u,this.name=o,this.game=n,this.passable=i,this.active=!0},Tt=function(t){return function(t){function e(t){var a,n=t.children,r=void 0===n?[]:n,i=t.engine,s=void 0===i?new fe({}):i,o=Object(N.a)(t,["children","engine"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,At({},o)))).entityTypes=a.entityTypes.concat("PARENT"),a.children=r,a.engine=s,a.isInitialized=!1,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"destroyChild",value:function(t){t.energy=0;var e=this.game.map[x(t.pos)];this.game.map[x(t.pos)].entities=e.entities.filter(function(e){return e.id!==t.id}),this.engine.actors=this.engine.actors.filter(function(e){return e.id!==t.id}),this.game.draw()}},{key:"canAttack",value:function(t){return!this.children.map(function(t){return t.id}).includes(t.id)}},{key:"initialize",value:function(){var t=this;this.isInitialized=!0,this.engine.game=this.game,this.engine.actors=this.children,this.engine.actors.forEach(function(e){e.game=t.game,e.destroy=function(){t.destroyChild(e)},e.canAttack=t.canAttack.bind(t),t.game.placeActorOnMap(e),t.engine.addActor(e),t.game.draw()})}},{key:"getAction",value:function(t){return this.isInitialized||this.initialize(),new wt({game:t,actor:this,engine:this.engine,energyCost:100,processDelay:10})}}]),e}(t)},Dt=function(t){return function(t){function e(t){var a,n=t.attackDamage,r=void 0===n?1:n,i=Object(N.a)(t,["attackDamage"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,At({},i)))).entityTypes=a.entityTypes.concat("ATTACKING"),a.attackDamage=r,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"getAttackDamage",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.attackDamage+t}},{key:"canAttack",value:function(t){return!0}},{key:"attack",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=!1,n=this.game.map[x(t)];if(!n)return a;var r=C(n.entities);if(r.length>0){var i=r[0];if(this.canAttack(i)){var s=this.getAttackDamage(e);this.entityTypes.includes("EQUIPING")&&this.equipment.forEach(function(t){t.item&&t.item.entityTypes.includes("ATTACKING")&&(s+=t.item.getAttackDamage())}),this.game.addMessage("".concat(this.name," does ").concat(s," to ").concat(i.name),tt.DANGER),i.decreaseDurability(s),a=!0}}return a}}]),e}(t)},St=function(t){return function(t){function e(t){var a,n=t.name,r=void 0===n?"nameless":n,i=t.equipmentType,s=void 0===i?V.HAND:i,o=Object(N.a)(t,["name","equipmentType"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,At({},o)))).entityTypes=a.entityTypes.concat("EQUIPABLE"),a.name=r,a.equipmentType=s,a}return Object(h.a)(e,t),e}(t)},It=function(t){return function(t){function e(t){var a,n=t.actions,r=void 0===n?[]:n,i=t.speed,s=void 0===i?100:i,o=(t.energy,Object(N.a)(t,["actions","speed","energy"]));return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,At({},o)))).entityTypes=a.entityTypes.concat("ACTING"),a.actions=r,a.speed=s,a.energy=s,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"getAction",value:function(){var t=k(this.actions);if(t)return t}},{key:"gainEnergy",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.speed;this.energy+=t}},{key:"hasEnoughEnergy",value:function(){return this.energy>0}}]),e}(t)},Nt=function(t){return function(t){function e(t){var a,n=t.pos,r=void 0===n?{x:0,y:0}:n,i=t.renderer,s=Object(N.a)(t,["pos","renderer"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,At({},s)))).entityTypes=a.entityTypes.concat("RENDERING"),a.pos=r,a.renderer=At({},i),a.currentFrame=0,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"getPosition",value:function(){return this.pos}},{key:"move",value:function(t){var e=this,a=!1;if(this.game.canOccupyPosition(t,this)){var n=this.game.map[x(this.pos)];this.game.map[x(this.pos)]=At({},n,{entities:n.entities.filter(function(t){return t.id!==e.id})}),this.pos=t,this.game.map[x(t)].entities.push(this),a=!0}return a}},{key:"shove",value:function(t,e){var a=this.game.map[x(t)];return a&&a.entities.map(function(t){if(!t.passable){var a={x:t.pos.x+e[0],y:t.pos.y+e[1]};t.move(a)}}),this.move(t)}}]),e}(t)},Rt=function t(e){var a=e.itemType,n=e.items;Object(c.a)(this,t),this.itemType=a,this.items=n},Lt=function(t){return function(t){function e(t){var a,n=t.container,r=void 0===n?[]:n,i=Object(N.a)(t,["container"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,At({},i)))).entityTypes=a.entityTypes.concat("CONTAINING"),a.container=r,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"createSlot",value:function(t){var e=new Rt({itemType:t.name,items:[t]});this.container.push(e)}},{key:"contains",value:function(t){var e=this.container.filter(function(e){return e.itemType===t});return e.length>0&&e[0].items[0]}},{key:"addToContainer",value:function(t){var e=this.container.findIndex(function(e){return e.itemType===t.name});e>=0?this.container[e].items.push(t):this.createSlot(t)}},{key:"removeFromContainer",value:function(t){var e=this;this.container.forEach(function(a,n){a.items=a.items.filter(function(e){return e.id!==t.id}),a.items.length||e.container.splice(n,1)})}}]),e}(t)},Mt=function(t){return function(t){function e(t){var a,n=t.keymap,r=void 0===n?{}:n,i=Object(N.a)(t,["keymap"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,At({},i)))).entityTypes=a.entityTypes.concat("PLAYING"),a.nextAction=null,a.keymap=r,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"setNextAction",value:function(t){this.nextAction=t}},{key:"getAction",value:function(){var t=this.nextAction;return this.nextAction=null,t}}]),e}(t)},Gt=function(t){return function(t){function e(t){var a,n=t.targetEntity,r=void 0===n?null:n,i=Object(N.a)(t,["targetEntity"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,At({},i)))).entityTypes=a.entityTypes.concat("CHASING"),a.targetEntity=r,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"getAction",value:function(t){var e=w(t,this.targetEntity.pos,this.pos),a=e.length>0?e[0]:this.pos;return new gt({targetPos:a,game:t,actor:this,energyCost:100})}}]),e}(t)},Ft=function(t){return function(t){function e(t){var a,n=Object(I.a)({},t);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,At({},n)))).entityTypes=a.entityTypes.concat("DRAGGABLE"),a}return Object(h.a)(e,t),e}(t)},Bt=function(t){return function(t){function e(t){var a,n=t.durability,r=void 0===n?1:n,i=t.defense,s=void 0===i?0:i,o=t.onDestroy,h=void 0===o?function(){return null}:o,p=Object(N.a)(t,["durability","defense","onDestroy"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,At({},p)))).entityTypes=a.entityTypes.concat("DESTRUCTABLE"),a.durability=r,a.defense=s,a.onDestroy=h,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"getDefense",value:function(){var t=this.defense;return this.entityTypes.includes("EQUIPING")&&this.equipment.forEach(function(e){e.item&&e.item.entityTypes.includes("DESTRUCTABLE")&&(t+=e.item.getDefense())}),t}},{key:"decreaseDurabilityWithoutDefense",value:function(t){this.durability-=t,this.durability<=0&&this.destroy()}},{key:"decreaseDurability",value:function(t){var e=this.durability,a=e-(t-this.getDefense());this.durability=Math.min(e,a),this.renderer.character=this.durability,this.game.draw(),this.durability<=0&&this.destroy()}},{key:"increaseDurability",value:function(t){this.durability+=t}},{key:"destroy",value:function(){this.onDestroy(),F(this)}}]),e}(t)},_t=function(t){return function(t){function e(t){var a,n=Object(I.a)({},t);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,At({},n)))).entityTypes=a.entityTypes.concat("BURNABLE"),a.canBurn=!0,a.willResetCanBurn=!1,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"resetCanBurn",value:function(){this.willResetCanBurn=!1,this.canBurn=!0}},{key:"burn",value:function(){return!!this.canBurn&&(this.decreaseDurability(2),!0)}}]),e}(t)},Wt=G()(It,Nt,Mt,function(t){return function(t){function e(t){var a,n=t.initiatedBy,r=void 0===n?null:n,i=t.range,s=void 0===i?null:i,o=Object(N.a)(t,["initiatedBy","range"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,At({},o)))).entityTypes=a.entityTypes.concat("UI"),a.initiatedBy=r,a.active=!0,a.range=s,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"hasEnoughEnergy",value:function(){return this.active}}]),e}(t)})(Ct),qt=(G()(It,Nt)(Ct),G()(It,Nt,Bt,function(t){return function(t){function e(t){var a,n=t.messages,r=void 0===n?["I have nothing to say."]:n,i=t.messageType,s=Object(N.a)(t,["messages","messageType"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,At({},s)))).entityTypes=a.entityTypes.concat("SPEAKING"),a.messages=r,a.messageType=i,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"getAction",value:function(t){var e=this.messages.shift();return this.messages.push(e),new ut({actor:this,game:t,message:e,messageType:this.messageType,processDelay:0})}}]),e}(t)},Ft,_t,function(t){return function(t){function e(t){var a,n=Object(I.a)({},t);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,At({},n)))).entityTypes=a.entityTypes.concat("HELPLESS"),a}return Object(h.a)(e,t),e}(t)})(Ct)),Ht=(G()(Nt,Bt)(Ct),G()(Nt,Lt,Ft,_t,Bt,function(t){return function(t){function e(t){var a,n=t.flammability,r=void 0===n?1:n,i=t.explosivity,s=void 0===i?1:i,o=Object(N.a)(t,["flammability","explosivity"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,At({},o)))).entityTypes=a.entityTypes.concat("EXPLODING"),a.flammability=r,a.explosivity=s,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"enflame",value:function(){var t=this;Array(this.flammability).fill("").map(function(e){return new Vt({name:"Pyro",pos:At({},t.pos),game:t.game,renderer:{character:"*",color:U.base3,background:U.red},timeToSpread:1,spreadCount:1,durability:1,attackDamage:1,speed:100})}).forEach(function(e){t.game.placeActorOnMap(e),t.game.engine.addActor(e)})}},{key:"explode",value:function(){var t=this,e={x_offset:0,y_offset:0,positions:Array(this.explosivity).fill("").reduce(function(t,e,a){return t.concat.apply(t,Object(g.a)(D(0,0,a+1)))},[])};e.positions.forEach(function(a){var n={x:t.pos.x+a.x+e.x_offset,y:t.pos.y+a.y+e.y_offset},r=t.game.map[x(n)];r&&(r.type="BURNT")})}},{key:"destroy",value:function(){this.enflame(),this.explode(),Object(S.a)(Object(l.a)(e.prototype),"destroy",this).call(this)}}]),e}(t)})(Ct)),Ut=(G()(It,Nt,function(t){return function(t){function e(t){var a,n=t.path,r=void 0!==n&&n,i=t.direction,s=void 0===i?{x:0,y:0}:i,o=t.range,h=void 0===o?3:o,p=Object(N.a)(t,["path","direction","range"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,At({},p)))).entityTypes=a.entityTypes.concat("DIRECTIONAL_PUSHING"),a.path=r,a.direction=s,a.range=h,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"getAction",value:function(t){var e=this,a={x:this.pos.x+this.direction[0],y:this.pos.y+this.direction[1]};return this.passable=!1,this.range>0?new mt({targetPos:a,direction:this.direction,game:t,actor:this,energyCost:100,onSuccess:function(){return e.range-=1}}):new ft({game:t,actor:this,energyCost:0})}}]),e}(t)},Bt)(Ct),G()(It,Nt,Gt,Bt)(Ct),G()(It,Nt,Gt,Bt,Dt)(Ct),G()(It,Nt,function(t){return function(t){function e(t){var a,n=t.targetEntity,r=void 0===n?null:n,i=t.getProjectile,s=void 0===i?function(){return null}:i,o=Object(N.a)(t,["targetEntity","getProjectile"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,At({},o)))).entityTypes=a.entityTypes.concat("RANGED_CHASING"),a.targetEntity=r,a.getProjectile=s,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"targetInPath",value:function(t,e){var a=!1;return t.forEach(function(t){t.x===e.x&&t.y===e.y&&(a=!0)}),a}},{key:"getAction",value:function(t){var e={x:Math.sign(this.targetEntity.pos.x-this.pos.x),y:Math.sign(this.targetEntity.pos.y-this.pos.y)},a=this.getProjectile({pos:{x:this.pos.x,y:this.pos.y},targetPos:At({},this.targetEntity.pos),direction:[e.x,e.y],range:10});if(a.createPath(t),this.targetInPath(a.path,this.targetEntity.pos))return t.canOccupyPosition(a.pos,a)?new dt({targetPos:At({},a.pos),entity:a,game:t,actor:this,energyCost:100}):new ut({message:"I'll get you with this kunai!",game:t,actor:this,energyCost:100});var n=w(t,this.targetEntity.pos,this.pos),r=n.length>0?n[0]:this.pos;return new gt({targetPos:r,game:t,actor:this,energyCost:100})}}]),e}(t)},Bt,Dt)(Ct),G()(It,Nt,function(t){return function(t){function e(t){var a,n=t.draggedEntity,r=void 0===n?null:n,i=Object(N.a)(t,["draggedEntity"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,At({},i)))).entityTypes=a.entityTypes.concat("DRAGGING"),a.draggedEntity=r,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"grab",value:function(t){var e=this.game.map[x(t)];if(!e)return!1;if(e.entities.length>0){var a=e.entities[0];if(!this.draggedEntity&&a.entityTypes.includes("DRAGGABLE"))return this.draggedEntity=a,!0}return!1}},{key:"release",value:function(){if(!this.draggedEntity)return!1;var t=At({},this.draggedEntity);return this.draggedEntity=null,t}},{key:"drag",value:function(t){var e=this,a=this.draggedEntity.pos,n=this.game.map[x(a)];this.game.map[x(a)]=At({},n,{entities:n.entities.filter(function(t){return t.id!==e.draggedEntity.id})}),this.draggedEntity.pos=t,this.game.map[x(t)].entities.push(this.draggedEntity)}},{key:"move",value:function(t){var a=At({},this.pos);if(this.draggedEntity){var n=Object(S.a)(Object(l.a)(e.prototype),"move",this).call(this,t);return n?(this.drag(a),!0):n}return Object(S.a)(Object(l.a)(e.prototype),"move",this).call(this,t)}}]),e}(t)},function(t){return function(t){function e(t){var a,n=t.charge,r=void 0===n?10:n,i=Object(N.a)(t,["charge"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,At({},i)))).entityTypes=a.entityTypes.concat("CHARGING"),a.charge=r,a.chargeMax=r,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"decreaseCharge",value:function(t){this.charge=Math.max(0,this.charge-t)}},{key:"increaseCharge",value:function(t){this.charge=Math.min(this.chargeMax,this.charge+t)}}]),e}(t)},function(t){return function(t){function e(t){var a,n=Object(I.a)({},t);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,At({},n)))).entityTypes=a.entityTypes.concat("SIGNING"),a.signHistory=[],a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"addSign",value:function(t){this.signHistory.length>=4&&this.signHistory.shift(),this.signHistory.push(t)}},{key:"clearSigns",value:function(){this.signHistory=[]}}]),e}(t)},Lt,function(t){return function(t){function e(t){var a,n=t.equipment,r=void 0===n?Y.human():n,i=Object(N.a)(t,["equipment"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,At({},i)))).entityTypes=a.entityTypes.concat("EQUIPING"),a.equipment=r,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"hasItemNameEquipped",value:function(t){return this.equipment.filter(function(e){return!(!e.item||e.item.name!==t)}).length>0}},{key:"getItemInSlot",value:function(t){if(this.equipment.filter(function(e){return null===e.item&&e.type===t}).length>0)return!1;var e=this.equipment.find(function(e){return e.type===t});return!!e&&(!!e.item&&e.item)}},{key:"equip",value:function(t,e){var a=!1;return this.equipment=this.equipment.map(function(n){return a||n.type!==t||null!==n.item||(n.item=e,a=!0),n}),a}},{key:"unequip",value:function(t){this.equipment=this.equipment.map(function(e){return e.item&&e.item.id===t.id&&(e.item=null),e})}}]),e}(t)},Dt,function(t){return function(t){function e(t){var a,n=t.currentGate,r=void 0===n?null:n,i=(t.gates,Object(N.a)(t,["currentGate","gates"]));return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,At({},i)))).entityTypes=a.entityTypes.concat("HAS_INNER_GATES"),a.currentGate=r,a.gates=[{name:"Gate of Opening",damageBuff:1,speedBuff:100,durabilityDebuff:1,character:"1"},{name:"Gate of Healing",damageBuff:1,speedBuff:100,durabilityDebuff:1,character:"2"},{name:"Gate of Life",damageBuff:1,speedBuff:100,durabilityDebuff:1,character:"3"},{name:"Gate of Pain",damageBuff:1,speedBuff:100,durabilityDebuff:1,character:"4"},{name:"Gate of Limit",damageBuff:1,speedBuff:100,durabilityDebuff:1,character:"5"}],a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"setNextGate",value:function(){var t=this.currentGate,e=null;if(t){var a=this.gates.findIndex(function(e){return t.name===e.name})+1;this.gates.length>a&&(e=this.gates[a],this.currentGate=At({},e))}else e=this.gates[0],this.currentGate=At({},e);return e}},{key:"getNextGate",value:function(){var t=this.currentGate,e=null;if(t){var a=this.gates.findIndex(function(e){return t.name===e.name})+1;this.gates.length>a&&(e=this.gates[a])}else e=this.gates[0];return e}}]),e}(t)},Bt,function(t){return function(t){function e(t){var a,n=t.cloneLimit,r=void 0===n?1:n,i=Object(N.a)(t,["cloneLimit"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,At({},i)))).entityTypes=a.entityTypes.concat("CLONING"),a.cloneLimit=r,a.clones=[],a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"destroy",value:function(){this.clones&&this.clones.map(function(t){F(t)}),F(this)}},{key:"destroyClone",value:function(t){var e=this.clones.findIndex(function(e){return e.id==t});e>=0&&(this.clones[e].super__destroy(),this.clones.splice(e,1))}},{key:"createClone",value:function(t){var e=this;if(this.clones.length<this.cloneLimit){var a=Object($.cloneDeep)(this);if(a.name="Clone",a.game=this.game,a.id=L()(),delete a.clones,a.super__destroy=a.destroy,a.destroy=function(){e.destroyClone(a.id)},t.forEach(function(t){a[t.attribute]=t.value}),this.game.placeActorOnMap(a))return this.game.engine.addActorAsNext(a),this.game.draw(),this.clones.push(a),!0}return!1}}]),e}(t)},Mt,_t)(Ct)),zt=G()(Nt,St,Dt)(Ct),Kt=G()(Nt,St,Bt)(Ct),Vt=(G()(It,Nt,Dt,function(t){return function(t){function e(t){var a,n=t.path,r=void 0!==n&&n,i=t.targetPos,s=void 0===i?null:i,o=t.attackDamage,h=void 0===o?1:o,p=t.range,f=void 0===p?3:p,y=Object(N.a)(t,["path","targetPos","attackDamage","range"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,At({},y)))).entityTypes=a.entityTypes.concat("DESTRUCTIVE_PROJECTING"),a.path=r,a.targetPos=s,a.attackDamage=h,a.range=f,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"createPath",value:function(t){var e=P(t,this.targetPos,this.pos,8,this.range);this.path=e}},{key:"getAction",value:function(t){this.path||this.createPath(t);var e=this.path.length>0?this.path[0]:this.pos;return new Et({targetPos:e,game:t,actor:this,energyCost:100})}}]),e}(t)},Bt)(Ct),G()(It,Nt,Dt,function(t){return function(t){function e(t){var a,n=t.path,r=void 0!==n&&n,i=t.direction,s=void 0===i?{x:0,y:0}:i,o=t.attackDamage,h=void 0===o?1:o,p=t.range,f=void 0===p?3:p,y=Object(N.a)(t,["path","direction","attackDamage","range"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,At({},y)))).entityTypes=a.entityTypes.concat("DIRECTIONAL_PROJECTING"),a.path=r,a.direction=s,a.attackDamage=h,a.range=f,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"createPath",value:function(t){for(var e=[],a=1;a<this.range+1;a++)e.push({x:this.pos.x+this.direction[0]*a,y:this.pos.y+this.direction[1]*a});this.path=e}},{key:"getAction",value:function(t){var e=this,a={x:this.pos.x+this.direction[0],y:this.pos.y+this.direction[1]};return this.passable=!1,this.range>0?new bt({targetPos:a,game:t,actor:this,energyCost:100,damageToSelf:1,onSuccess:function(){return e.range-=1},onAfter:function(){e.energy<=100&&t.engine.setActorToPrevious()}}):new ft({game:t,actor:this,energyCost:0})}}]),e}(t)},Bt)(Ct),G()(It,Nt,Dt,function(t){return function(t){function e(t){var a,n=t.owner_id,r=void 0===n?null:n,i=t.path,s=void 0!==i&&i,o=t.targetPos,h=void 0===o?null:o,p=t.attackDamage,f=void 0===p?1:p,y=t.range,d=void 0===y?3:y,g=Object(N.a)(t,["owner_id","path","targetPos","attackDamage","range"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,At({},g)))).entityTypes=a.entityTypes.concat("GASEOUS_DESTRUCTIVE_PROJECTING"),a.path=s,a.targetPos=h,a.attackDamage=f,a.range=d,a.owner_id=r,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"canAttack",value:function(t){var a=Object(S.a)(Object(l.a)(e.prototype),"canAttack",this).call(this);return a&&(a=null===this.owner_id||t.owner_id!==this.owner_id),a}},{key:"createPath",value:function(t){var e=P(t,this.targetPos,this.pos,8,this.range);this.path=e}},{key:"getAction",value:function(t){this.path||this.createPath(t);var e=this.path.length>0?this.path[0]:this.pos;return new xt({targetPos:e,game:t,actor:this,energyCost:100})}}]),e}(t)},Bt,function(t){return function(t){function e(t){var a,n=t.isClone,r=void 0!==n&&n,i=t.cloneCount,s=void 0===i?0:i,o=t.clonePattern,h=void 0===o?X.square:o,p=Object(N.a)(t,["isClone","cloneCount","clonePattern"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,At({},p)))).entityTypes=a.entityTypes.concat("GASEOUS"),a.isClone=r,a.cloneCount=s,a.clonePattern=Object($.cloneDeep)(h),a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"getAction",value:function(t){var a=this.clonePattern.positions.find(function(t){return!t.taken});if(!this.isClone&&a){a.taken=!0;var n=Object($.cloneDeepWith)(this,function(t,e){switch(e){case"id":case"game":case"engine":case"clones":return null;default:return}});if(n.game=t,n.id=L()(),this.hasOwnProperty("pos")){var r=this.pos;n.pos={x:r.x+a.x,y:r.y+a.y}}n.hasOwnProperty("path")&&(n.path=n.path.map(function(t){return{x:t.x+a.x,y:t.y+a.y}})),n.isClone=!0,this.cloneCount+=1,t.placeActorOnMap(n),t.engine.addActor(n),t.draw()}return Object(S.a)(Object(l.a)(e.prototype),"getAction",this).call(this,t)}}]),e}(t)})(Ct),G()(It,Bt,Tt)(Ct),G()(It,Nt,Bt,Dt,function(t){return function(t){function e(t){var a,n=t.timeToSpread,r=void 0===n?5:n,i=t.spreadCount,s=void 0===i?1:i,o=Object(N.a)(t,["timeToSpread","spreadCount"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,At({},o)))).entityTypes=a.entityTypes.concat("SPREADING"),a.timeToSpreadMax=r,a.timeToSpread=r,a.spreadCountMax=s,a.spreadCount=s,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"getAction",value:function(t){var e=this;if(this.spreadCount<=0)return new ft({game:t,actor:this,energyCost:100,processDelay:0,onAfter:function(){t.map[x(e.pos)].type="BURNT"}});if(this.timeToSpread<=0){for(var a=[{x:this.pos.x+1,y:this.pos.y+0},{x:this.pos.x+-1,y:this.pos.y+0},{x:this.pos.x+0,y:this.pos.y+1},{x:this.pos.x+0,y:this.pos.y+-1}],n=null,r=100;r>0;){var i=k(a),s=this.game.map[x(i)],c=Boolean(s),o=!0,u=!1;if(s&&(o="BURNT"!==s.type,u=["WALL","FLOOR","DOOR"].includes(s.type)),c&&o&&u){n=i;break}r-=1}if(n){var l=new Vt({name:"Pyro",pos:{x:0,y:0},game:t,renderer:{character:"*",color:U.base3,background:U.red},timeToSpread:this.timeToSpreadMax,spreadCount:this.spreadCountMax,durability:this.durability,attackDamage:this.attackDamage,speed:this.speed});return this.timeToSpread=this.timeToSpreadMax,this.spreadCount-=1,new dt({targetPos:n,entity:l,game:t,actor:this,interrupt:!1,energyCost:100,processDelay:0,forcePlacement:!0})}this.timeToSpread=this.timeToSpreadMax,this.spreadCount-=1}return this.timeToSpread-=1,new ut({message:"burning",game:t,actor:this,processDelay:0})}}]),e}(t)})(Ct)),Yt=G()(It,Nt,function(t){return function(t){function e(t){var a,n=t.pos,r=void 0===n?{x:1,y:1}:n,i=t.direction,s=void 0===i?{x:0,y:0}:i,o=t.life,h=void 0===o?1:o,p=t.speed,f=void 0===p?1:p,y=t.type,d=void 0===y?Q.directional:y,g=t.path,b=void 0===g?null:g,m=Object(N.a)(t,["pos","direction","life","speed","type","path"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,At({},m)))).pos=r,a.direction=s,a.life=h,a.speed=f,a.type=d,a.path=b,a.entityTypes=a.entityTypes.concat("PARTICLE"),a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"getNextPos",value:function(t){switch(this.type){case Q.directional:return{x:this.pos.x+this.direction.x*this.speed*t,y:this.pos.y+this.direction.y*this.speed*t};case Q.path:var e=this.path.shift();return At({},e||this.pos)}}},{key:"update",value:function(t){this.life-=t,this.life>0&&(this.pos=this.getNextPos(t))}}]),e}(t)})(Ct),Xt=(G()(It,Bt,Tt)(Ct),function(t,e){var a=Z.filter(function(e){return!Object.keys(t).includes(e)});t[a[0]]=e}),Jt=function(t,e){var a=t.actors[t.currentActor];t.game.removeActor(a),t.game[e]=null},Qt=function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"move",n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return{w:{activate:function(){return t(K.N,e)},label:"".concat(a," N"),hidden:n},d:{activate:function(){return t(K.E,e)},label:"".concat(a," E"),hidden:n},s:{activate:function(){return t(K.S,e)},label:"".concat(a," S"),hidden:n},a:{activate:function(){return t(K.W,e)},label:"".concat(a," W"),hidden:n}}};function Zt(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,n)}return a}function $t(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?Zt(a,!0).forEach(function(e){Object(p.a)(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):Zt(a).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}var te=function(t){var e=t.actors[t.currentActor];t.game.visibleEquipment=e.equipment;var a=new Wt({initiatedBy:e,pos:$t({},e.pos),renderer:{character:"E",color:"white",background:""},name:"Equipment",game:t.game});t.addActorAsPrevious(a),t.game.placeActorOnMap(a),t.game.draw(),a.keymap=function(t,e){var a={Escape:{activate:function(){return Jt(t,"visibleEquipment")},label:"Close"}};return e.equipment.filter(function(t){return t.item}).map(function(n){var r={activate:null,label:""};return r.activate=function(){e.setNextAction(new pt({item:n.item,game:t.game,actor:e})),Jt(t,"visibleEquipment")},r.label="Unequip ".concat(n.item.name),Xt(a,r),!0}),a}(t,e)};var ee=function(t,e){var a=e.actors[e.currentActor],n=a.pos.x+t[0],r=a.pos.y+t[1];a.setNextAction(new yt({targetPos:{x:n,y:r},game:e.game,actor:a,energyCost:0}))};function ae(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,n)}return a}function ne(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?ae(a,!0).forEach(function(e){Object(p.a)(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):ae(a).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}var re=function(t,e,a,n){var r=function(){var a=t.actors[t.currentActor];a.active=!1,t.game.removeActor(a),e.willResetCanBurn=!0};return ne({Escape:{activate:r,label:"Close"}},Qt(ee,t),{t:{activate:function(){e.canBurn=!0,function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=t.actors[t.currentActor];e.setNextAction(new lt({targetPos:ne({},n.pos),radius:a,game:t.game,actor:e,energyCost:100}))}(t,e,n),r()},label:"activate"}})},ie=function(t,e){var a=e.actors[e.currentActor],n=a.pos.x+t[0],r=a.pos.y+t[1];a.setNextAction(new mt({targetPos:{x:n,y:r},game:e.game,actor:a,direction:t,energyCost:100,processDelay:25}))};function se(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,n)}return a}var ce=function(t){var e=t.actors[t.currentActor],a=[];[K.N,K.E,K.S,K.W].forEach(function(n){var r={x:e.pos.x+n[0],y:e.pos.y+n[1]},i=t.game.display.addAnimation(1,{x:r.x,y:r.y,color:U.green});a.push(i)}),e.keymap=function(t,e,a,n){var r=t.actors[t.currentActor],i=function(){e.keymap=a,n.length&&n.forEach(function(e){return t.game.display.removeAnimation(e.id)})};return{Escape:{activate:i,label:"Cancel Chop"},w:{activate:function(){var e={x:r.pos.x+K.N[0],y:r.pos.y+K.N[1]};r.setNextAction(new jt({targetPos:e,game:t.game,actor:r})),i()},label:"activate N"},d:{activate:function(){var e={x:r.pos.x+K.E[0],y:r.pos.y+K.E[1]};r.setNextAction(new jt({targetPos:e,game:t.game,actor:r})),i()},label:"activate E"},s:{activate:function(){var e={x:r.pos.x+K.S[0],y:r.pos.y+K.S[1]};r.setNextAction(new jt({targetPos:e,game:t.game,actor:r})),i()},label:"activate S"},a:{activate:function(){var e={x:r.pos.x+K.W[0],y:r.pos.y+K.W[1]};r.setNextAction(new jt({targetPos:e,game:t.game,actor:r})),i()},label:"activate W"}}}(t,e,function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?se(a,!0).forEach(function(e){Object(p.a)(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):se(a).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}({},e.keymap),a)};function oe(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,n)}return a}var ue=function(t,e,a,n){return function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?oe(a,!0).forEach(function(e){Object(p.a)(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):oe(a).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}({},Qt(function(t,r){!function(t,e,a,n){var r={x:a.pos.x+t[0],y:a.pos.y+t[1]};a.setNextAction(new vt({targetPos:r,game:e.game,actor:a,energyCost:100}))}(t,r,e),e.keymap=a,n.length&&n.forEach(function(t){return r.game.display.removeAnimation(t.id)})},t,"grab"))};function le(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,n)}return a}function he(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?le(a,!0).forEach(function(e){Object(p.a)(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):le(a).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}var pe=function(){function t(e){var a=e.statusEffects,n=void 0===a?[]:a,r=e.actors,i=void 0===r?[]:r,s=e.currentActor,o=void 0===s?0:s,u=e.isRunning,l=void 0!==u&&u,h=e.game,p=void 0===h?null:h;Object(c.a)(this,t),this.statusEffects=n,this.actors=i,this.currentActor=o,this.isRunning=l,this.game=p}return Object(o.a)(t,[{key:"processV1",value:function(){var t=Object(v.a)(m.a.mark(function t(){var e,a,n;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if((e=this.actors[this.currentActor]).gainEnergy(e.speed),!e.hasEnoughEnergy()){t.next=18;break}if(a=e.getAction(this.game)){t.next=6;break}return t.abrupt("return",!1);case 6:return n=a.perform(),this.game.draw(),t.next=11,j(a.processDelay);case 11:if(n.success){t.next=13;break}return t.abrupt("return",!1);case 13:if(null!==n.alternative){t.next=15;break}return t.abrupt("break",18);case 15:a=n.alternative,t.next=6;break;case 18:return this.currentActor=(this.currentActor+1)%this.actors.length,t.abrupt("return",!0);case 20:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"processV2",value:function(){var t=Object(v.a)(m.a.mark(function t(){var e,a,n,r,i;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=this.actors[this.currentActor],a=!0;case 2:if(!a){t.next=50;break}if(e){t.next=5;break}return t.abrupt("return",!1);case 5:if(e.active){t.next=7;break}return t.abrupt("break",50);case 7:if(n=0,!e.hasEnoughEnergy()){t.next=46;break}if(r=e.getAction(this.game)){t.next=12;break}return t.abrupt("return",!1);case 12:n+=r.energyCost;case 13:return r.onBefore(),t.next=17,r.perform();case 17:return(i=t.sent).success?r.onSuccess():r.onFailure(),r.onAfter(),t.next=22,this.processActionFX(r,i.success);case 22:if(t.sent){t.next=31;break}if(!this.shouldAutoRun()){t.next=28;break}return t.next=26,j(25);case 26:t.next=30;break;case 28:return t.next=30,j(r.processDelay);case 30:this.game.draw();case 31:if(e.active){t.next=33;break}return t.abrupt("break",40);case 33:if(i.success){t.next=35;break}return t.abrupt("return",!1);case 35:if(null!==i.alternative){t.next=37;break}return t.abrupt("break",40);case 37:r=i.alternative,t.next=13;break;case 40:if(this.processStatusEffects(n),!r.interrupt){t.next=44;break}return a=!1,t.abrupt("break",50);case 44:t.next=48;break;case 46:e.gainEnergy(e.speed),a=!1;case 48:t.next=2;break;case 50:return this.actors=this.actors.filter(function(t){return t.active}),this.currentActor+=1,this.currentActor>=this.actors.length&&(this.currentActor=0),t.abrupt("return",!0);case 54:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"processV3",value:function(){var t=Object(v.a)(m.a.mark(function t(){var e,a,n,r;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.actors[this.currentActor]){t.next=3;break}return t.abrupt("return",!1);case 3:if(a=0,!e.hasEnoughEnergy()){t.next=29;break}if(n=e.getAction(this.game)){t.next=8;break}return t.abrupt("return",!1);case 8:a+=n.energyCost;case 9:return t.next=12,n.perform();case 12:return r=t.sent,t.next=15,this.processActionFX(n,r.success);case 15:if(t.sent){t.next=19;break}return t.next=18,j(n.processDelay);case 18:this.game.draw();case 19:if(r.success){t.next=21;break}return t.abrupt("return",!1);case 21:if(null!==r.alternative){t.next=23;break}return t.abrupt("break",26);case 23:n=r.alternative,t.next=9;break;case 26:this.processStatusEffects(a),t.next=30;break;case 29:e.gainEnergy(e.speed);case 30:return this.currentActor=(this.currentActor+1)%this.actors.length,0===this.currentActor&&this.sortActorsByEnergy(),t.abrupt("return",!0);case 33:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"start",value:function(){var t=Object(v.a)(m.a.mark(function t(){var e;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.isRunning=!0;case 1:if(!this.isRunning){t.next=7;break}return t.next=4,this.processV2();case 4:this.isRunning=t.sent,t.next=1;break;case 7:if(e=this.actors[this.currentActor]){t.next=11;break}return this.game.backToTitle(),t.abrupt("return",!1);case 11:return e.keymap&&(this.game.visibleKeymap=e.keymap),this.game.updateMode(),t.next=15,this.game.updateReact(this.game);case 15:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"stop",value:function(){this.isRunning=!1}},{key:"sortActorsByEnergy",value:function(){this.actors=this.actors.sort(function(t,e){return e.energy-t.energy})}},{key:"shouldAutoRun",value:function(){return!this.actors.filter(function(t){return t.entityTypes.includes("PLAYING")}).length}},{key:"addStatusEffect",value:function(t){return!t.allowDuplicates&&this.statusEffects.filter(function(e){return e.actor.id===t.actor.id&&e.name===t.name}).length>0?(console.log("".concat(t.name," cannot be applied twice to ").concat(t.actor.name)),!1):(t.onStart(),this.statusEffects.push(t),!0)}},{key:"removeStatusEffectById",value:function(t){this.statusEffects=this.statusEffects.filter(function(e){return e.id!==t||(e.onStop(),!1)})}},{key:"removeStatusEffectByActorId",value:function(t){this.statusEffects=this.statusEffects.filter(function(e){return e.actor.id!==t||(e.onStop(),!1)})}},{key:"removeDeadStatusEffects",value:function(){this.statusEffects=this.statusEffects.filter(function(t){return!(t.lifespan>=0&&t.timeToLive<=0)||(t.onStop(),!1)})}},{key:"processStatusEffects",value:function(t){this.statusEffects.forEach(function(e){e.timeSinceLastStep+=t,e.timeToLive-=t,e.timeSinceLastStep>=e.stepInterval&&(e.onStep(),e.timeSinceLastStep=0)}),this.removeDeadStatusEffects()}},{key:"processActionFX",value:function(){var t=Object(v.a)(m.a.mark(function t(e,a){var n,r=this;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a){t.next=11;break}return n=new Yt({game:this.game,name:"particle",passable:!0,pos:he({},e.actor.pos),renderer:J.fail.renderer}),this.game.placeActorOnMap(n),this.game.draw(),t.next=6,j(100);case 6:return this.game.removeActorFromMap(n),n.update(1),this.game.draw(),e.removeDeadParticles(),t.abrupt("return",!0);case 11:if(!e.particles.length){t.next=23;break}case 12:if(!(e.particles.length>0)){t.next=22;break}return e.particles.forEach(function(t){r.game.placeActorOnMap(t)}),this.game.draw(),t.next=17,j(e.processDelay);case 17:e.particles.forEach(function(t){r.game.removeActorFromMap(t),t.update(1)}),this.game.draw(),e.removeDeadParticles(),t.next=12;break;case 22:return t.abrupt("return",!0);case 23:return t.abrupt("return",!1);case 24:case"end":return t.stop()}},t,this)}));return function(e,a){return t.apply(this,arguments)}}()},{key:"addActor",value:function(t){this.actors.push(t)}},{key:"addActorAsPrevious",value:function(t){this.actors.splice(this.currentActor,0,t)}},{key:"addActorAsNext",value:function(t){this.actors.splice(this.currentActor+1,0,t)}},{key:"setActorToPrevious",value:function(t){this.currentActor-=1,this.currentActor<=-1&&(this.currentActor=this.actors.length-1)}},{key:"setActorToNext",value:function(t){this.currentActor=(this.currentActor+1)%this.actors.length}}]),t}(),fe=function(t){function e(){return Object(c.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(h.a)(e,t),Object(o.a)(e,[{key:"process",value:function(){var t=Object(v.a)(m.a.mark(function t(){var e,a,n,r;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=this.actors[this.currentActor],a=!0;case 2:if(!a){t.next=26;break}if(!e.hasEnoughEnergy()){t.next=23;break}if(n=e.getAction(this.game)){t.next=7;break}return t.abrupt("return",!1);case 7:return this.game.draw(),t.next=11,n.perform();case 11:return r=t.sent,t.next=14,j(n.processDelay);case 14:if(r.success){t.next=16;break}return t.abrupt("return",!1);case 16:if(null!==r.alternative){t.next=18;break}return t.abrupt("break",21);case 18:n=r.alternative,t.next=7;break;case 21:t.next=24;break;case 23:a=!1;case 24:t.next=2;break;case 26:if(this.currentActor+=1,!(this.currentActor+1>=this.actors.length)){t.next=31;break}return this.currentActor=0,this.actors.forEach(function(t){return t.gainEnergy(t.speed)}),t.abrupt("return",!1);case 31:return t.abrupt("return",!0);case 32:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"start",value:function(){var t=Object(v.a)(m.a.mark(function t(){var e;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.isRunning=!0;case 1:if(!this.isRunning){t.next=7;break}return t.next=4,this.process();case 4:this.isRunning=t.sent,t.next=1;break;case 7:return(e=this.actors[this.currentActor]).keymap&&(this.game.visibleKeymap=e.keymap),this.game.mode.update(),t.next=12,this.game.updateReact(this.game);case 12:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}]),e}(pe),ye=a(30),de=a.n(ye);function ge(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,n)}return a}function be(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?ge(a,!0).forEach(function(e){Object(p.a)(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):ge(a).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}var me=0,ve=1,Oe=2,je=function(){function t(e){var a=e.display;Object(c.a)(this,t);var n=L()();this.id=n,this.lifeTime=0,this.active=!0,this.display=a,this.node=null}return Object(o.a)(t,[{key:"getActive",value:function(){return!1}},{key:"initialize",value:function(){}},{key:"update",value:function(t){this.lifeTime+=t.timeDiff,this.active=this.getActive(),this.active||this.display.removeAnimation(this.id)}}]),t}(),ke=function(t){function e(t){var a=Object(I.a)({},t);return Object(c.a)(this,e),Object(u.a)(this,Object(l.a)(e).call(this,be({},a)))}return Object(h.a)(e,t),Object(o.a)(e,[{key:"getActive",value:function(){return!(this.lifeTime>500)}}]),e}(je),Ee=function(t){function e(t){var a,n=t.x,r=t.y,i=t.lerpDirection,s=void 0===i?-1:i,o=t.color,h=void 0===o?"#fff":o,p=Object(N.a)(t,["x","y","lerpDirection","color"]);return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,be({},p)))).x=n,a.y=r,a.lerpDirection=s,a.color=h,a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"getActive",value:function(){return this.active}},{key:"initialize",value:function(){this.active=!0;var t=new de.a.Rect({name:"rect",x:this.display.tileWidth*this.x+(this.display.tileOffset+this.display.tileGutter),y:this.display.tileHeight*this.y+(this.display.tileOffset+this.display.tileGutter),offsetX:this.display.tileWidth/-4,offsetY:this.display.tileHeight/-4,width:this.display.tileWidth/2,height:this.display.tileHeight/2,fill:this.color,strokeEnabled:!1,transformsEnabled:"position",perfectDrawEnabled:!1,listening:!1,shadowForStrokeEnabled:!1});this.display.animationLayer.add(t),this.node=t,Object(S.a)(Object(l.a)(e.prototype),"initialize",this).call(this)}},{key:"update",value:function(t){var a,n,r,i=this.node.opacity();i>=1&&(this.lerpDirection=-1),i<=0&&(this.lerpDirection=1),i+=.05*this.lerpDirection,this.node.opacity((a=i,n=0,r=1,Math.min(Math.max(a,n),r))),Object(S.a)(Object(l.a)(e.prototype),"update",this).call(this,t)}}]),e}(je),xe=function(){function t(e){var a=e.containerId,n=void 0===a?null:a,r=e.width,i=void 0===r?100:r,s=e.height,o=void 0===s?100:s,u=e.tileWidth,l=void 0===u?10:u,h=e.tileHeight,p=void 0===h?10:h,f=e.tileGutter,y=void 0===f?0:f,d=e.tileOffset,g=void 0===d?10:d,b=e.cameraFollow,m=void 0!==b&&b;Object(c.a)(this,t),this.containerId=n,this.width=i,this.height=o,this.tilesWide=this.getTilesWide(i,g,l),this.tilesHigh=this.getTilesHigh(o,g,p),this.tileWidth=l,this.tileHeight=p,this.tileGutter=y,this.tileOffset=g,this.cameraFollow=m,this.stage=null,this.layer=null,this.animationLayer=null,this.animations=[],this.animationLoop=null}return Object(o.a)(t,[{key:"initialize",value:function(t){var e=this,a=t.getElementById(this.containerId),n=t.createElement("div");a.appendChild(n),this.stage=new de.a.Stage({container:"display",width:this.width,height:this.height}),this.layer=new de.a.Layer({hitGraphEnabled:!1}),this.stage.add(this.layer),this.animationLayer=new de.a.Layer({}),this.stage.add(this.animationLayer);var r=new de.a.Animation(function(t){e.animations.forEach(function(e){return e.update(t)}),e.animations.length<=0&&e.animationLoop&&e.animationLoop.isRunning()&&e.animationLoop.stop()},this.animationLayer);this.animationLoop=r,r.start()}},{key:"addAnimation",value:function(t,e){var a;switch(t){case me:a=new je(be({display:this},e));break;case Oe:a=new ke(be({display:this},e));break;case ve:a=new Ee(be({display:this},e));break;default:a=new je(be({display:this},e))}return a.initialize(),this.animations.push(a),this.animationLoop.isRunning()||this.animationLoop.start(),a}},{key:"removeAnimation",value:function(t){this.animations=this.animations.filter(function(e){return e.id!==t||(e.node.destroy(),!1)})}},{key:"updateTile",value:function(t,e,a,n){t.children[0].fill(n),t.children[1].fill(a),t.children[1].text(e)}},{key:"createTile",value:function(t,e,a,n,r){var i=new de.a.Group({id:"".concat(t,",").concat(e),x:this.tileWidth*t+(this.tileOffset+this.tileGutter),y:this.tileHeight*e+(this.tileOffset+this.tileGutter),width:this.tileWidth,height:this.tileHeight,transformsEnabled:"position",perfectDrawEnabled:!1,listening:!1,shadowForStrokeEnabled:!1}),s=new de.a.Rect({name:"rect",width:this.tileWidth,height:this.tileHeight,fill:r,strokeEnabled:!1,transformsEnabled:"position",perfectDrawEnabled:!1,listening:!1,shadowForStrokeEnabled:!1}),c=new de.a.Text({name:"text",text:a,width:this.tileWidth,height:this.tileHeight,fontSize:18,fill:n,align:"center",verticalAlign:"middle",transformsEnabled:"position",perfectDrawEnabled:!1,listening:!1,shadowForStrokeEnabled:!1});return i.add(s),i.add(c),this.layer.add(i),i}},{key:"getAbsoultueX",value:function(t){return this.tileWidth*t+(this.tileOffset+this.tileGutter)}},{key:"getAbsoultueY",value:function(t){return this.tileWidth*t+(this.tileOffset+this.tileGutter)}},{key:"getTilesWide",value:function(t,e,a){return Math.floor((t-e)/a)}},{key:"getTilesHigh",value:function(t,e,a){return Math.floor((t-e)/a)}},{key:"draw",value:function(t){if(this.cameraFollow&&t){var e=this.tilesWide,a=this.tilesHigh,n=Math.floor(this.width/this.tileWidth),r=Math.floor(this.height/this.tileHeight),i=Math.ceil(e-n/2),s=Math.ceil(a-r/2),c=0,o=0;t.x>e-i&&(c=e-i-t.x),t.y>a-s&&(o=a-s-t.y),this.layer.x(this.getAbsoultueX(c)),this.layer.y(this.getAbsoultueY(o))}this.layer.batchDraw()}}]),t}();function we(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,n)}return a}function Pe(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?we(a,!0).forEach(function(e){Object(p.a)(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):we(a).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}var Ae=function(){return[{x:0,y:0}]},Ce=function(t){for(var e=k(t),a=Te(e),n=De(a,t),r=1e3;n;)if(e=k(t.filter(function(t){return n=e,!((a=t).x===n.x&&a.y===n.y);var a,n})),a=Te(e),n=De(a,t),(r-=1)<=0){n=!1,a=!1;break}return a},Te=function(t){return k(Ie(t))},De=function(t,e){return e.filter(function(e){return e.x===t.x&&e.y===t.y}).length>0},Se=function(t,e,a,n){return{x:t.x+e+n*t.x,y:t.y+a+n*t.y}},Ie=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=[{x:t.x,y:t.y+1},{x:t.x+1,y:t.y},{x:t.x,y:t.y-1},{x:t.x-1,y:t.y}];return e&&(a=a.concat([{x:t.x+1,y:t.y+1},{x:t.x+1,y:t.y-1},{x:t.x-1,y:t.y-1},{x:t.x-1,y:t.y+1}])),a},Ne=function(t,e,a,n){for(var r=a+1-n,i=!1,s=0;s<r;s++)for(var c=0;c<r;c++){var o={x:e.x+s,y:e.y+c};t[x(o)]||(i=!0)}if(!i)for(var u=0;u<r;u++)for(var l=0;l<r;l++){var h={x:e.x+u,y:e.y+l},p="FLOOR";0!==u&&u!==r-1||(p="WALL"),0!==l&&l!==r-1||(p="WALL");var f=t[x(h)];f&&(f.type=p)}return!i},Re=function(t){Object.keys(t).filter(function(e){return"WALL"===t[e].type}).filter(function(e){var a=e.split(",").map(function(t){return parseInt(t)}),n={x:a[0],y:a[1]};return 8===Ie(n,!0).filter(function(e){var a=t[x(e)];return!(!a||!["WALL","FLOOR"].includes(a.type))}).length}).forEach(function(e){t[e].type="FLOOR"})},Le=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,a=Object.keys(t).filter(function(e){if("WALL"!==t[e].type)return!1;var a=e.split(",").map(function(t){return parseInt(t)}),n={x:a[0],y:a[1]};return 2===Ie(n,!1).filter(function(e){var a=t[x(e)];return!(!a||!["GROUND"].includes(a.type))}).length}),n=0;n<e;){var r=k(a),i=r.split(",").map(function(t){return parseInt(t)}),s={x:i[0],y:i[1]},c=Ie(s,!1).filter(function(e){var a=t[x(e)];return!(!a||!["WALL"].includes(a.type))}),o=k(c);if(o){for(var u={x:Math.sign(o.x-s.x),y:Math.sign(o.y-s.y)},l=100,h=!0,p=Pe({},s),f=[];h;){p.x+=u.x,p.y+=u.y;var y=t[x(p)];if(!y)break;if("FLOOR"===y.type)y.type="WALL",f.push(Pe({},p));else if("GROUND"===y.type||"WALL"===y.type&&f.length){var d={x:p.x-2*u.x,y:p.y-2*u.y};t[x(d)].type="DOOR",d={x:p.x-3*u.x,y:p.y-3*u.y},t[x(d)].type="DOOR",f.length<=0&&e<=100&&(e+=1);break}(l-=1)<=0&&(h=!1)}n+=1}}};function Me(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,n)}return a}var Ge=function(t){function e(t){var a=Object(I.a)({},t);return Object(c.a)(this,e),Object(u.a)(this,Object(l.a)(e).call(this,function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?Me(a,!0).forEach(function(e){Object(p.a)(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):Me(a).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}({},a)))}return Object(h.a)(e,t),Object(o.a)(e,[{key:"initialize",value:function(){var t=this;Object(S.a)(Object(l.a)(e.prototype),"initialize",this).call(this);var a=Math.floor(this.game.mapWidth/2),n=Math.floor(this.game.mapHeight/2);!function(t,e,a){for(var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:12,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4,i=(arguments.length>5&&void 0!==arguments[5]&&arguments[5],{}),s=Ae(),c=1e3;s.length<n+1;){var o=Ce(s);if(o){var u=Se(o,e,a,r),l=Ne(t,u,r,0);l&&s.push(o)}if((c-=1)<=0)break}Re(t),Le(t,s.length)}(this.game.map,a,n),function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GROUND",n=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,s=0;s<r;s++)for(var c=0;c<i;c++)if(s>=t.y&&s<=t.y+(e-1)&&c>=t.x&&c<=t.x+(e-1)){var o="".concat(c,",").concat(s),u=0;z[a].animation&&(u=E(0,z[a].animation.length)),n[o]={type:a,currentFrame:u,entities:[]}}}({x:0,y:0},3,"SAFE",this.game.map,this.game.mapHeight,this.game.mapWidth),this.placeInitialItems(),this.placePlayersInSafeZone();for(var r=Object.keys(this.game.map).filter(function(e){return"FLOOR"===t.game.map[e].type}),i=0;i<this.data.debrisCount;i++){var s=k(r).split(",").map(function(t){return parseInt(t)});this.addDebris({x:s[0],y:s[1]})}for(var c=0;c<this.data.gasCanCount;c++){var o=k(r).split(",").map(function(t){return parseInt(t)});this.addDebris({x:o[0],y:o[1]},"gas can","X",1,3,U.orange)}for(var u=0;u<this.data.fireIntensity;u++){var h=k(r).split(",").map(function(t){return parseInt(t)});this.addFire({x:h[0],y:h[1]})}for(var p=0;p<this.data.npcCount;p++){var f=k(r).split(",").map(function(t){return parseInt(t)});this.addNPC({x:f[0],y:f[1]})}}},{key:"checkRemoveSafeFloors",value:function(){var t=this;"Fire Fighter"===this.game.engine.actors[this.game.engine.currentActor].name&&(this.data.turnCount+=1,this.data.turnCount>50*this.getSaveCountRequirement()&&Object.keys(this.game.map).filter(function(e){return"SAFE_FLOOR"==t.game.map[e].type}).forEach(function(e){t.game.map[e].type="FLOOR"}))}},{key:"update",value:function(){Object(S.a)(Object(l.a)(e.prototype),"update",this).call(this),this.propogateFire(),this.burnEntities(),this.checkRemoveSafeFloors(),this.hasLost()&&(this.reset(),this.game.initializeGameData()),this.hasWon()&&(this.nextLevel(),this.increaseIntensity(),this.game.initializeGameData())}},{key:"setLevel",value:function(t){this.data.level=t,this.data.turnCount=0}},{key:"nextLevel",value:function(){this.setLevel(this.data.level+1)}},{key:"reset",value:function(){this.resetIntensity(),this.setLevel(1),this.initialize()}},{key:"increaseIntensity",value:function(){switch(this.data.level){case 1:this.data.fireIntensity=1,this.data.npcCount=1,this.data.debrisCount=4,this.data.gasCanCount=0;break;case 2:this.data.fireIntensity=2,this.data.npcCount=1,this.data.debrisCount=4,this.data.gasCanCount=1;break;case 3:this.data.fireIntensity=3,this.data.npcCount=2,this.data.debrisCount=50,this.data.gasCanCount=1;break;case 4:this.data.fireIntensity=4,this.data.npcCount=2,this.data.debrisCount=6,this.data.gasCanCount=3;break;case 5:this.data.fireIntensity=5,this.data.npcCount=3,this.data.debrisCount=6,this.data.gasCanCount=3;break;case 6:this.data.fireIntensity=4,this.data.npcCount=3,this.data.debrisCount=10,this.data.gasCanCount=3;break;case 7:this.data.fireIntensity=1,this.data.npcCount=3,this.data.debrisCount=80,this.data.gasCanCount=25;break;case 8:this.data.fireIntensity=3,this.data.npcCount=3,this.data.debrisCount=20,this.data.gasCanCount=6;break;default:this.data.fireIntensity=3,this.data.npcCount=3,this.data.debrisCount=20,this.data.gasCanCount=5}}},{key:"resetIntensity",value:function(){this.data.fireIntensity=1,this.data.npcCount=1,this.data.debrisCount=4}},{key:"countNpcSafe",value:function(){var t=this;return this.game.engine.actors.filter(function(e){if(e.entityTypes.includes("HELPLESS")&&"SAFE"===t.game.map[x(e.pos)].type)return!0;return!1}).length}},{key:"getSaveCountRequirement",value:function(){var t=Math.ceil(.66*this.data.npcCount);return Math.max(1,t)}},{key:"hasWon",value:function(){return this.countNpcSafe()>=this.getSaveCountRequirement()}},{key:"hasLost",value:function(){return this.game.engine.actors.filter(function(t){return t.entityTypes.includes("HELPLESS")}).length<this.getSaveCountRequirement()}},{key:"addDebris",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"box",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"%",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:U.base01,s=new Ht({pos:t,renderer:{character:a,color:U.base2,background:i},name:e,game:this.game,durability:n,explosivity:r,flammability:0});this.game.placeActorOnMap(s),this.game.draw()}},{key:"addNPC",value:function(t){var e=new qt({name:"Helpless Citizen",messages:["help!","ahh!","It's getting hot in hurr."],messageType:tt.ACTION,pos:t,game:this.game,renderer:{character:"C",color:U.base3,background:U.violet},durability:2});this.game.placeActorOnMap(e)&&(this.game.map[x(e.pos)].type="SAFE_FLOOR",this.game.engine.addActor(e),this.game.draw())}},{key:"addFire",value:function(t){var e=new Vt({name:"Pyro",pos:t,game:this.game,renderer:{character:"*",color:U.base3,background:U.red},timeToSpread:1,spreadCount:1,durability:1,attackDamage:2,speed:100});this.game.placeActorOnMap(e)&&(this.game.engine.addActor(e),this.game.draw())}},{key:"propogateFire",value:function(){var t=this;if(this.game.engine.actors.filter(function(t){return"Pyro"===t.name}).length<this.data.fireIntensity){var e=Object.keys(this.game.map).filter(function(e){return"BURNT"==t.game.map[e].type}),a=k(e);if(a){var n={x:parseInt(a.split(",")[0]),y:parseInt(a.split(",")[1])};this.addFire(n)}}}},{key:"burnEntities",value:function(){var t=this;Object.keys(this.game.map).filter(function(e){return"BURNT"===t.game.map[e].type}).reduce(function(e,a){return e.concat(t.game.map[a].entities)},[]).forEach(function(e){e.entityTypes.includes("BURNABLE")&&(e.burn()&&t.game.addMessage("".concat(e.name," is burned."),tt.DANGER),e.willResetCanBurn&&e.resetCanBurn())})}},{key:"placeInitialItems",value:function(){var t,e=this,a=[(t=this.game.engine,new zt({game:t.game,name:at,passable:!0,attackDamage:5,equipmentType:V.GENERIC,renderer:{character:"a",color:"white",background:""}})),rt(this.game.engine),it(this.game.engine)],n=Object.keys(this.game.map).filter(function(t){return"SAFE"==e.game.map[t].type});a.forEach(function(t){var a=n.pop();if(a){var r={x:parseInt(a.split(",")[0]),y:parseInt(a.split(",")[1])};t.pos=r;var i=e.game.map[a];i&&i.entities.push(t)}})}},{key:"placePlayersInSafeZone",value:function(){var t=this,e=this.game.engine.actors.filter(function(t){return t.entityTypes.includes("PLAYING")}),a=Object.keys(this.game.map).filter(function(e){return"SAFE"==t.game.map[e].type});e.forEach(function(e){var n=a.shift();if(n){var r={x:parseInt(n.split(",")[0]),y:parseInt(n.split(",")[1])};e.pos=r;var i=t.game.map[n];i&&i.entities.push(e)}})}}]),e}(function(){function t(e){var a=e.game,n=void 0===a?null:a,r=e.data,i=void 0===r?{}:r;Object(c.a)(this,t);var s=L()();this.id=s,this.game=n,this.data=i}return Object(o.a)(t,[{key:"initialize",value:function(){}},{key:"update",value:function(){}}]),t}());function Fe(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,n)}return a}function Be(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?Fe(a,!0).forEach(function(e){Object(p.a)(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):Fe(a).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}var _e=50,We=25,qe=30,He=30,Ue=5,ze=_e*qe+Ue,Ke=We*He+Ue,Ve=function(){function t(e){var a=e.engine,n=void 0===a?null:a,r=e.map,i=void 0===r?{}:r,s=e.mapInitialized,o=void 0!==s&&s,u=e.tileMap,l=void 0===u?{}:u,h=e.mapWidth,p=void 0===h?_e:h,f=e.mapHeight,y=void 0===f?We:f,d=e.getSelectedCharacter,g=void 0===d?function(){return!1}:d,b=e.display,m=void 0===b?new xe({containerId:"display",width:ze,height:Ke,tileWidth:qe,tileHeight:He,tileOffset:Ue,cameraFollow:!1}):b,v=e.tileKey,O=void 0===v?z:v,j=e.mode,k=void 0===j?new Ge({game:this,data:{level:1,highestLevel:null,fireIntensity:1,npcCount:1,debrisCount:4,gasCanCount:0,turnCount:0}}):j,E=e.messages,x=void 0===E?[]:E;Object(c.a)(this,t),this.engine=n,this.map=i,this.mapInitialized=o,this.tileMap=l,this.mapWidth=p,this.mapHeight=y,this.display=m,this.tileKey=O,this.mode=k,this.messages=x,this.getSelectedCharacter=g}return Object(o.a)(t,[{key:"initializeMode",value:function(){this.mode.initialize()}},{key:"updateMode",value:function(){this.mode.update()}},{key:"randomlyPlaceActorOnMap",value:function(t){for(var e=0,a=!1;!a;){var n=A(this.map).coordinates;if(this.canOccupyPosition(n,t)){var r=this.map[x(n)];t.pos=Be({},n),r.entities.push(t),a=!0}(e+=1)>=100&&(a=!0)}return a}},{key:"randomlyPlaceAllActorsOnMap",value:function(){var t=this;this.engine.actors.forEach(function(e){t.randomlyPlaceActorOnMap(e)})}},{key:"placeActorsOnMap",value:function(){var t=this;this.engine.actors.forEach(function(e){var a=t.map[x(e.pos)];a?a.entities.push(e):console.log("could not place ".concat(e.id,": ").concat(e.name," on map"))})}},{key:"placeActorOnMap",value:function(t){var e=this.map[x(t.pos)];return e?(e.entities.push(t),!0):(console.log("could not place ".concat(t.id,": ").concat(t.name," on map")),!1)}},{key:"removeActorFromMap",value:function(t){var e=this.map[x(t.pos)];return!!e&&(this.map[x(t.pos)].entities=e.entities.filter(function(e){return e.id!==t.id}),!0)}},{key:"createLevel",value:function(){var t=new O.d.Arena(this.mapWidth,this.mapHeight),e=[];t.create(function(t,a,n){var r=t+","+a,i="GROUND",s=0;n&&(i="WALL"),z[i].animation&&(s=E(0,z[i].animation.length)),this.map[r]={type:i,currentFrame:s,entities:[]},e.push(r)}.bind(this)),this.randomlyPlaceAllActorsOnMap()}},{key:"createEmptyLevel",value:function(){for(var t=0;t<this.mapHeight;t++)for(var e=0;e<this.mapWidth;e++){var a="".concat(e,",").concat(t),n=0;z.GROUND.animation&&(n=E(0,z.GROUND.animation.length)),this.map[a]={type:"GROUND",currentFrame:n,entities:[]}}}},{key:"createCustomLevel",value:function(t){var e=this;Object.keys(t.tiles).forEach(function(a,n){var r=t.tiles[a],i=JSON.parse(r.data),s=0;i||(i="GROUND"),z[i].animation&&(s=E(0,z[i].animation.length)),e.map[a]={type:i,currentFrame:s,entities:[]}}),this.placeInitialEntities()}},{key:"canOccupyPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{passable:!1},a=!1,n=this.map[x(t)];if(n){var r=n.entities.filter(function(t){return!t.passable}).length>0;if(!r||e.passable){var i=this.map[x(t)];this.tileKey[i.type].passable&&(a=!0)}}return a}},{key:"cursorCanOccupyPosition",value:function(t){var e=!1;return this.map[x(t)]&&(e=!0),e}},{key:"show",value:function(t){this.display.initialize(t)}},{key:"processTileMap",value:function(t){for(var e in this.map){var a=e.split(","),n=parseInt(a[0]),r=parseInt(a[1]),i=this.map[e],s=this.tileKey[i.type],c=s.character,o=s.foreground,u=s.background,l=this.tileKey[i.type],h=this.animateTile(i,l);if(c=h.character,o=h.foreground,u=h.background,i.entities.length>0){var p=i.entities[i.entities.length-1];c=(h=this.animateEntity(p)).character,o=h.foreground,h.background&&(u=h.background)}t(e,n,r,c,o,u)}}},{key:"initializeMap",value:function(){var t=this;if(this.mapInitialized)return!1;this.mapInitialized=!0,this.processTileMap(function(e,a,n,r,i,s){var c=t.display.createTile(a,n,r,i,s);t.tileMap[e]=c}),this.display.draw()}},{key:"getPlayers",value:function(){return this.engine.actors.filter(function(t){return t.entityTypes.includes("PLAYING")})}},{key:"draw",value:function(){var t=this;this.processTileMap(function(e,a,n,r,i,s){t.display.updateTile(t.tileMap[e],r,i,s)});var e=null,a=this.getPlayers();a.length&&(e=a[0].pos),this.display.draw(e)}},{key:"animateEntity",value:function(t){var e=t.renderer,a=Be({},e),n=a.character,r=a.color,i=a.background;if(e.animation){var s=e.animation[t.currentFrame];n=s.character,r=s.foreground,i=s.background,t.currentFrame=(t.currentFrame+1)%e.animation.length}return{character:n,foreground:r,background:i}}},{key:"animateTile",value:function(t,e){var a=Be({},e),n=a.character,r=a.foreground,i=a.background;if(e.animation){var s=e.animation[t.currentFrame];n=s.character,r=s.foreground,i=s.background,t.currentFrame=(t.currentFrame+1)%e.animation.length}return{character:n,foreground:r,background:i}}},{key:"addActor",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.engine,a=this.placeActorOnMap(t);return!!a&&(e.actors.push(t),this.draw(),!0)}},{key:"placeAndDrawActor",value:function(t){this.placeActorsOnMap(),this.draw()}},{key:"removeActor",value:function(t){this.engine.actors=this.engine.actors.filter(function(e){return e.id!==t.id}),this.removeActorFromMap(t),this.draw()}},{key:"initializeUI",value:function(t,e){this.show(e),t.current.focus()}},{key:"initializeGameData",value:function(){var t=this;this.engine.game=this;var e=this.getSelectedCharacter();this.engine.actors=[e],this.engine.actors.forEach(function(e){e.game=t}),this.createEmptyLevel(),this.initializeMap(),this.draw(),this.mode.initialize()}},{key:"initialize",value:function(t,e){this.initializeUI(t,e),this.initializeGameData()}},{key:"addMessage",value:function(t,e){var a=new et({text:t,type:e});this.messages.push(a)}}]),t}(),Ye=function(t,e){if(!e.isRunning){var a=e.actors[e.currentActor].keymap,n=t.key;if(!(n in a))return;a[n].activate(),e.start()}},Xe=function(t){function e(){return Object(c.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(h.a)(e,t),Object(o.a)(e,[{key:"render",value:function(){var t=this,e=null;try{e=r.a.createElement("span",null,r.a.createElement("div",{className:"Instructions__block"},"Wave ".concat(this.props.game.mode.data.level)),r.a.createElement("div",{className:"Instructions__block"},"".concat(this.props.game.mode.countNpcSafe()," of  ").concat(this.props.game.mode.getSaveCountRequirement()," are safe!")))}catch(a){return}return r.a.createElement("div",{className:"Instructions UI"},r.a.createElement("p",{className:"flow-text"},"Save all of the citizens from the burning building and get them to the safe zone!"),r.a.createElement("div",{className:"flow-text"},e,r.a.createElement("div",{className:"Instructions__block",onClick:function(){return t.props.setActiveScreen(d.TITLE)}},r.a.createElement("button",{className:"btn btn-main",onClick:function(){return t.props.setActiveScreen(d.TITLE)}},"Restart"))))}}]),e}(r.a.Component);var Je=function(t){var e=t.color;return e||(e="grey"),r.a.createElement("button",{onClick:t.onClick,className:"Button btn ".concat(e)},t.children)},Qe=(r.a.Component,r.a.Component,r.a.Component,a(24)),Ze=function(t){function e(){return Object(c.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(h.a)(e,t),Object(o.a)(e,[{key:"render",value:function(){return r.a.createElement("div",{className:"Keymap UI"},r.a.createElement("div",{className:"flow-text center"},"Keymap"),this.props.keymap&&Object.entries(this.props.keymap).map(function(t,e){var a=Object(Qe.a)(t,2),n=a[0],i=a[1];if(!(!!i.hasOwnProperty("hidden")&&i.hidden))return r.a.createElement(Je,{key:e,onClick:function(){return null},color:"grey darken-1"},n," ",i.label)}))}}]),e}(r.a.Component);function $e(t){return r.a.createElement("div",{className:"Message",style:{color:t.color,backgroundColor:t.backgroundColor,borderColor:t.color}},t.children)}var ta=function(t){function e(){return Object(c.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(h.a)(e,t),Object(o.a)(e,[{key:"render",value:function(){return r.a.createElement("div",{className:"Messages UI"},r.a.createElement("div",{className:"flow-text center"},"Messages"),this.props.messages&&this.props.messages.map(function(t,e){return r.a.createElement($e,{key:e,color:t.type.color,backgroundColor:t.type.backgroundColor},"".concat(t.text))}))}}]),e}(r.a.Component),ea=function(t){function e(t){var a;Object(c.a)(this,e),a=Object(u.a)(this,Object(l.a)(e).call(this,t));var n=new pe({}),i=new Ve({engine:n,getSelectedCharacter:function(){return a.props.selectedCharacter.initialize(n)}});return a.state={game:i,activeTab:0},a.presserRef=r.a.createRef(),a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"componentDidMount",value:function(){var t=Object(v.a)(m.a.mark(function t(){var e=this;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.state.game.initialize(this.presserRef,document),this.state.game.backToTitle=function(){return e.props.setActiveScreen(d.TITLE)},this.state.game.updateReact=function(t){e.setState({game:t})},this.state.game.engine.start();case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t,e,a,n=this,i=(this.state.game.engine.actors[this.state.game.engine.currentActor],[{label:"Wave",value:"Current: ".concat(this.state.game.mode.data.level,", Highest: ").concat(this.state.game.mode.data.highestLevel)}]);return i=i.concat(Object(g.a)(this.state.game.engine.actors.map(function(t,e){var a=Object(p.a)({label:t.name,value:e},"value","HP: ".concat(t.durability,", En/Sp: ").concat(t.energy,"/").concat(t.speed));return e===n.state.game.engine.currentActor&&(a.color="red"),a}))),r.a.createElement("div",{className:"Level"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s10"},r.a.createElement("div",{className:"game_display_container"},(t=this.presserRef,e=Ye,a=this.state.game.engine,r.a.createElement("div",{id:"display",ref:t,onKeyDown:function(t){return e(t,a)},tabIndex:"0"}))),r.a.createElement(Xe,{game:this.state.game,setActiveScreen:this.props.setActiveScreen})),r.a.createElement("div",{className:"col s2"},r.a.createElement(Ze,{keymap:this.state.game.visibleKeymap}),r.a.createElement(ta,{messages:this.state.game.messages.slice(-5).reverse()}))))}}]),e}(r.a.Component),aa=function(t){return r.a.createElement("div",{className:"CharacterSelect"},t.characters.map(function(e,a){return t.selectedCharacter&&(t.selectedCharacter.name===e.name?"red":""),r.a.createElement("button",{key:a,style:{position:"relative",top:"280px"},className:"CharacterSelect__button btn btn-main",onClick:function(){t.setSelectedCharacter(e),t.setActiveScreen(d.LEVEL)}},"Play Game")}))},na=function(t){function e(t){var a;return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,t))).state={},a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"render",value:function(){return r.a.createElement("div",{className:"Title"},r.a.createElement("div",{style:{width:"100vw",height:"100vh",backgroundColor:"rgb(4, 49, 61)",backgroundImage:'url("/fire_man_blue.jpg")',backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundPositionY:"10px"}},r.a.createElement(aa,{characters:this.props.characters,selectedCharacter:this.props.selectedCharacter,setSelectedCharacter:this.props.setSelectedCharacter,setActiveScreen:this.props.setActiveScreen})))}}]),e}(r.a.Component);function ra(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,n)}return a}var ia=function(t){return new Ut({pos:{x:19,y:22},renderer:{character:"F",color:U.base3,background:U.yellow},name:"Fire Fighter",equipment:Y.limited(),actions:[],speed:100,durability:4,keymap:function(t){return function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?ra(a,!0).forEach(function(e){Object(p.a)(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):ra(a).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}({},Qt(ie,t,"push",!0),{t:{activate:function(){return function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,n=t.actors[t.currentActor],r=t.game,i=n.pos;n.canBurn=!1;var s=new Wt({initiatedBy:n,range:a,pos:i,renderer:{character:"\u2588",color:"white",background:""},name:"Cursor",game:r,keymap:re(t,n,ne({},n.keymap),e)});t.addActorAsPrevious(s),r.placeActorOnMap(s),r.draw()}(t,1,5)},label:"shoot water"},c:{activate:function(){return ce(t)},label:"chop"},e:{activate:function(){return te(t)},label:"equipment"},p:{activate:function(){return function(t){var e=t.actors[t.currentActor],a=t.game.map[x(e.pos)].entities.filter(function(t){return t.id!==e.id});a.length>0?e.setNextAction(new ht({item:k(a),game:t.game,actor:e,energyCost:100})):t.game.addMessage("nothing to equip.",tt.ACTION)}(t)},label:"pick up"},g:{activate:function(){return function(t){var e=t.game,a=t.actors[e.engine.currentActor],n=a.keymap,r=[];[K.N,K.E,K.S,K.W].forEach(function(e){var n={x:a.pos.x+e[0],y:a.pos.y+e[1]},i=t.game.display.addAnimation(1,{x:n.x,y:n.y,color:U.base3});r.push(i)}),a.keymap=ue(t,a,n,r)}(t)},label:"grab"},r:{activate:function(){return function(t){var e=t.actors[t.currentActor];e.setNextAction(new Ot({game:t.game,actor:e,energyCost:100}))}(t)},label:"release"}})}(t)})},sa=function(){return{FireFighter:ia}};function ca(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,n)}return a}function oa(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?ca(a,!0).forEach(function(e){Object(p.a)(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):ca(a).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}var ua=function(t){function e(){var t;Object(c.a)(this,e),t=Object(u.a)(this,Object(l.a)(e).call(this));var a=sa(),n=Object.keys(a).map(function(t,e){return{initialize:a[t],selected:!1,name:t}});return t.state={activeScreen:d.TITLE,characters:n,selectedCharacter:null},t}return Object(h.a)(e,t),Object(o.a)(e,[{key:"setActiveScreen",value:function(t){this.setState({activeScreen:t})}},{key:"setSelectedCharacter",value:function(t){this.setState({selectedCharacter:oa({},t)})}},{key:"getActiveScreen",value:function(){var t=r.a.createElement(na,{key:d.TITLE,setActiveScreen:this.setActiveScreen.bind(this),setSelectedCharacter:this.setSelectedCharacter.bind(this),selectedCharacter:this.state.selectedCharacter,characters:this.state.characters}),e=r.a.createElement(ea,{key:d.LEVEL,setActiveScreen:this.setActiveScreen.bind(this),selectedCharacter:this.state.selectedCharacter});switch(this.state.activeScreen){case d.TITLE:return t;case d.LEVEL:return e;default:return t}}},{key:"render",value:function(){var t=this.getActiveScreen();return r.a.createElement("div",{className:"Nystrum"},r.a.createElement(y.a,{transitionName:"fade",transitionAppear:!0,transitionEnter:!0,transitionLeave:!0,transitionAppearTimeout:500,transitionEnterTimeout:500,transitionLeaveTimeout:300},t))}}]),e}(r.a.Component),la=function(t,e){for(var a in t){var n=a.split(","),r=parseInt(n[0]),i=parseInt(n[1]),s=t[a],c={GROUND:{background:"#974",foreground:"#aaa",character:".",passable:!0}}[s.type],o=c.character,u=c.foreground,l=c.background;if(s.entities.length>0){var h=s.entities[s.entities.length-1];o=h.components.renderer.character,u=h.components.renderer.color,h.components.renderer.background&&(l=h.components.renderer.background)}e.draw(r,i,o,u,l)}},ha=function(t){return"".concat(t.x,",").concat(t.y)},pa=function(t){return t.filter(function(t){return t.components.hasOwnProperty("impasse")&&!t.components.impasse.passable})},fa=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return new Promise(function(e){return setTimeout(e,t)})};function ya(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,n)}return a}function da(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?ya(a,!0).forEach(function(e){Object(p.a)(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):ya(a).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}var ga=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Empty",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3?arguments[3]:void 0,r={id:t,name:e,components:a,world:n,sendEvent:function(t,e,a){return ba(t,e,a,n)}};return r},ba=function(){var t=Object(v.a)(m.a.mark(function t(){var e,a,n,r,i,s,c,o=arguments;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=o.length>0&&void 0!==o[0]?o[0]:null,a=o.length>1&&void 0!==o[1]?o[1]:null,n=o.length>2&&void 0!==o[2]?o[2]:null,r=o.length>3&&void 0!==o[3]?o[3]:null,i=!1,t.t0=m.a.keys(e.components);case 6:if((t.t1=t.t0()).done){t.next=19;break}if(s=t.t1.value,!(c=e.components[s]).hasOwnProperty(a)){t.next=17;break}if(console.log("SUCCESSFUL EVENT: ",a),i=!0,"PREPARE_RENDER"===a){t.next=15;break}return t.next=15,fa();case 15:c[a](da({},n,{self:e,component:c})),la(r.map,r.display);case 17:t.next=6;break;case 19:i||console.log("FAILED EVENT");case 20:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}();function ma(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,n)}return a}function va(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?ma(a,!0).forEach(function(e){Object(p.a)(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):ma(a).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}var Oa=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{passable:t,MAKE_PASSABLE:function(t){t.component.passable=!0},MAKE_IMPASSABLE:function(t){t.component.passable=!1}}},ja=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0};return t?{pos:e,MOVE:function(e){var a=e.self,n=e.component,r=e.currentPos,i=e.targetPos;if(t.canOccupy(t.map,i)){n.pos=i;var s=t.map[ha(r)];t.map[ha(r)]=va({},s,{entities:[]}),a.sendEvent(a,"PREPARE_RENDER")}else console.log("can't move there")}}:(console.log("No world to occupy"),{})},ka=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return{durability:e,DECREASE_DURABILITY:function(t){var e=t.self,a=t.component,n=t.value;a.durability-=n,a.durability<=0&&e.sendEvent(e,"DESTROY")},INCREASE_DURABILITY:function(t){var e=t.component,a=t.value;e.durability+=a},DESTROY:function(e){var a=e.self,n=(e.component,e.value,t.map[ha(a.components.body.pos)]);t.map[ha(a.components.body.pos)].entities=n.entities.filter(function(t){return t.id!==a.id})}}},Ea=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"white",n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return{character:e,color:a,background:n,PREPARE_RENDER:function(e){var a=e.self;a.components.hasOwnProperty("body")&&t.map[ha(a.components.body.pos)].entities.push(a)}}};function xa(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,n)}return a}function wa(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?xa(a,!0).forEach(function(e){Object(p.a)(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):xa(a).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}var Pa,Aa,Ca=new O.g.Simple,Ta={canAct:!0,scheduler:Ca,engine:new O.c(Ca),map:{},display:new O.b({fontSize:24,bg:"#099"}),canOccupy:function(t,e){if(!t.hasOwnProperty(ha(e)))return!1;var a=t[ha(e)];return!(!{GROUND:{background:"#974",foreground:"#aaa",character:".",passable:!0}}[a.type].passable||0!==pa(a.entities).length)||void 0}},Da=wa({},ga(1,"Naruto",{reciever:(Pa={x:10,y:30},{responded:!1,RECIEVE:function(t){var e=t.self,a=t.component,n=t.message;console.log(n,Pa.x,Pa.y),a.responded||(a.responded=!0,e.sendEvent(t.sender,"hello","RECIEVE",{message:"copy",sender:e}))}}),body:ja(Ta,{x:19,y:21}),renderer:Ea(Ta,"N","orange","black")},Ta)),Sa=wa({},ga(2,"Box",{body:ja(Ta,{x:22,y:21}),renderer:Ea(Ta,"#","black"),impasse:Oa(),destructible:ka(Ta)},Ta)),Ia=wa({},ga(2,"Box",{body:ja(Ta,{x:22,y:19}),renderer:Ea(Ta,"#","black"),impasse:Oa(),destructible:ka(Ta)},Ta)),Na=wa({},ga(2,"Box",{body:ja(Ta,{x:22,y:17}),renderer:Ea(Ta,"#","black"),impasse:Oa(),destructible:ka(Ta)},Ta)),Ra=wa({},ga(3,"Kunai",{body:ja(Ta,{x:20,y:21}),renderer:Ea(Ta,"<>","black"),destructible:ka(Ta),attack:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return{damage:t}}(),throwable:(Aa=Ta,{THROW:function(t){var e=t.self,a=(t.component,t.direction),n=e.components.body.pos,r={x:n.x+a.x,y:n.y+a.y},i=Aa.map[ha(r)];if(Aa.canOccupy(Aa.map,r))e.sendEvent(e,"MOVE",{currentPos:n,targetPos:r}),e.sendEvent(e,"THROW",{direction:a});else{if(Aa.map.hasOwnProperty(ha(r))){var s=pa(i.entities).filter(function(t){return t.components.hasOwnProperty("destructible")});s.length>0&&e.sendEvent(s[0],"DECREASE_DURABILITY",{value:1})}e.sendEvent(e,"DECREASE_DURABILITY",{value:1})}}})},Ta)),La=(r.a.Component,function(t){function e(){return Object(c.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(h.a)(e,t),Object(o.a)(e,[{key:"render",value:function(){return r.a.createElement("div",{className:"App container-fluid"},r.a.createElement(ua,null))}}]),e}(r.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(La,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})},87:function(t,e,a){}},[[142,1,2]]]);
//# sourceMappingURL=main.608131e3.chunk.js.map