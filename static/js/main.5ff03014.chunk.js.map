{"version":3,"sources":["nystrum/Screen/constants.js","helper.js","nystrum/Entities/helper.js","nystrum/constants.js","nystrum/message.js","nystrum/items.js","nystrum/sounds.js","nystrum/actions.js","nystrum/entites.js","nystrum/Keymap/helper.js","nystrum/Keymap/KeyActions/activateEquipment.js","nystrum/Keymap/KeyActions/moveCursor.js","nystrum/Keymap/KeyActions/activateProjectile.js","nystrum/Keymap/KeyActions/push.js","nystrum/Keymap/KeyActions/chop.js","nystrum/Keymap/KeyActions/activateGrab.js","nystrum/engine.js","nystrum/Display/konvaCustom.js","nystrum/Maps/generator.js","nystrum/Modes/play.js","nystrum/Maps/helper.js","nystrum/Modes/default.js","nystrum/game.js","nystrum/UI/Instructions.js","nystrum/UI/Button.js","nystrum/UI/Information.js","nystrum/UI/Equipment.js","nystrum/UI/Inventory.js","nystrum/UI/Keymap.js","nystrum/UI/Messages.js","original/components/index.js","nystrum/Screen/Level.js","nystrum/Screen/Title.js","nystrum/Screen/Lose.js","nystrum/Screen/Win.js","nystrum/Characters/FireFighter.js","nystrum/Keymap/KeyActions/pickupRandom.js","nystrum/Characters/index.js","nystrum/Nystrum.js","original/lib/helper.js","original/lib/entity.js","original/Original.js","App.js","serviceWorker.js","index.js"],"names":["SCREENS","delay","timeDelayed","Promise","resolve","setTimeout","getRandomInArray","array","Math","floor","random","length","getRandomInt","min","max","ceil","coordsToString","coords","x","y","calculatePath","game","targetPos","currentPos","topology","map","isPassable","tile","tileKey","type","passable","astar","ROT","AStar","path","compute","push","slice","calculatePathWithRange","range","getRandomPos","keys","Object","key","split","coordinates","parseInt","text","getDestructableEntities","entites","filter","entity","hasOwnProperty","getGranularity","radius","pow","getPointsOnCircumference","centerX","centerY","r","n","list","i","round","cos","PI","sin","destroyEntity","energy","pos","Helper","entities","e","id","engine","removeStatusEffectByActorId","draw","active","COLORS","THEMES","base03","base02","base01","base00","base0","base1","base2","base3","yellow","orange","red","magenta","violet","blue","cyan","green","TILE_KEY","background","foreground","character","sprite","animation","DIRECTIONS","N","NE","W","NW","SW","S","SE","E","NONE","EQUIPMENT_TYPES","EQUIPMENT_LAYOUTS","name","item","CLONE_PATTERNS","verticalLine","x_offset","y_offset","positions","taken","smallSquare","square","bigSquare","circle","PARTICLE_TEMPLATES","default","renderer","color","fail","succede","damage","leaf","water","PARTICLE_TYPE","ALPHABET","MESSAGE_TYPE","INFORMATION","backgroundColor","ACTION","DANGER","STATUS_EFFECT","ERROR","Message","uuid","this","TYPE","waterGun","Entity","attackDamage","equipmentType","Constant","fireJacket","defense","console","log","window","PUBLIC_URL","fire_0","Howl","src","volume","loop","fire_1","scream_0","scream_1","scream_2","water_0","water_1","chop_0","chop_1","equip_0","equip_1","explosion_0","save","lose","grab_0","release_0","Base","actor","energyCost","processDelay","particles","particleTemplate","onBefore","onAfter","onSuccess","onFailure","interrupt","life","direction","particle","Particle","success","alternative","Say","message","messageType","args","addMessage","SprayWater","hasItemNameEquipped","ITEM_TYPES","structure","Array","fill","reduce","acc","curr","concat","slot","forEach","position","addParticle","sign","SOUNDS","play","EquipItemFromTile","getItemInSlot","equip","it","UnequipItemToTile","unequip","splice","DestroySelf","destroy","CursorMove","initiatedFrom","initiatedBy","cursorCanOccupyPosition","PlaceActor","forcePlacement","canOccupyPosition","addActorAsNext","Move","move","Action","ProjectileMove","damageToSelf","Shove","shove","GrabDirection","grab","ReleaseGrab","releasedEntity","release","Attack","entityTypes","includes","attack","SelfDestructiveAttack","decreaseDurabilityWithoutDefense","ThrowProjectile","move_result","shift","ThrowProjectileGas","CrankEngine","start","Parent","superclass","children","Engine","isInitialized","child","actors","destroyChild","canAttack","bind","placeActorOnMap","addActor","initialize","Attacking","additional","targets","target","getAttackDamage","equipment","decreaseDurability","Equipable","Acting","actions","speed","action","value","Rendering","currentFrame","targetTile","pushable","newPos","ContainerSlot","itemType","items","Containing","container","slots","index","findIndex","createSlot","Playing","keymap","nextAction","Chasing","targetEntity","Draggable","draggable","Pushable","Destructable","durability","onDestroy","getDefense","current","newDurability","Burnable","canBurn","willResetCanBurn","UI_Actor","pipe","Speaker","messages","saved","Debris","flammability","explosivity","FireSpread","timeToSpread","spreadCount","fire","enflame","explode","Player","getProjectile","pathToCheck","inPath","throwDirection","projectile","createPath","targetInPath","movePath","draggedEntity","lastPos","moveSuccess","drag","charge","chargeMax","signHistory","itemName","slotName","find","foundSlot","currentGate","gates","damageBuff","speedBuff","durabilityDebuff","nextGate","nextGateIndex","gate","cloneLimit","clones","clone","c","super__destroy","cloneArgs","cloneDeep","destroyClone","arg","attribute","Weapon","Armor","setActorToPrevious","owner_id","isClone","cloneCount","clonePattern","offset","cloneDeepWith","referencePos","timeToSpreadMax","spreadCountMax","adjacentPositions","adjacentPos","kill","newTile","tileExists","Boolean","notBurnt","step","nextPos","getNextPos","addAlphabeticallyToKeymap","obj","alphabetAllowed","letter","deactivateUIKeymap","visibleUIKey","currentUiActor","currentActor","removeActor","createFourDirectionMoveOptions","moveFunction","label","hidden","w","activate","d","s","a","activateEquipment","visibleEquipment","ui","addActorAsPrevious","Escape","setNextAction","keymapEquipment","moveCursor","newX","newY","previousKeymap","goToPreviousKeymap","cursor","t","trigger","chop","animations","display","addAnimation","removeAnimation","keyMapChop","keymapCursorToGrabEntity","initialKeymap","grabDirection","statusEffects","isRunning","gainEnergy","hasEnoughEnergy","getAction","result","perform","acting","timePassed","processActionFX","shouldAutoRun","processStatusEffects","sortActorsByEnergy","processV2","visibleKeymap","updateMode","updateReact","sort","b","newEffect","allowDuplicates","effect","onStart","onStop","actorId","lifespan","timeToLive","timeSinceLastStep","stepInterval","onStep","removeDeadStatusEffects","actionSuccess","removeActorFromMap","update","removeDeadParticles","process","mode","ANIMATION_TYPES","Animation","lifeTime","node","frame","timeDiff","getActive","ExampleAnimation","BlinkTile","lerpDirection","rect","Konva","Rect","tileWidth","tileOffset","tileGutter","tileHeight","offsetX","offsetY","width","height","strokeEnabled","transformsEnabled","perfectDrawEnabled","listening","shadowForStrokeEnabled","animationLayer","add","opacity","Display","containerId","cameraFollow","tilesWide","getTilesWide","tilesHigh","getTilesHigh","stage","layer","animationLoop","document","getElementById","displayContainer","createElement","appendChild","Stage","Layer","hitGraphEnabled","stop","anim","Group","Text","fontSize","fontFamily","align","verticalAlign","playerPos","tilesAcrossOnScreen","tilesDownOnScreen","bufferX","bufferY","getAbsoultueX","getAbsoultueY","batchDraw","createFloorPlan","createRoomInFloorPlan","floorPlan","origin","newUnit","getNeighboringUnit","unitAlreadyExists","unitExists","pnt","pos_two","pos_one","getNeighboringPoints","existingUnits","unit","getUnitPosition","floorPlanPos","mapOffsetX","mapOffsetY","unitSize","eightWay","neighbors","createUnit","size","border","unitCollidesWithEdge","j","newPosition","removeInnerWalls","coordArray","point","addInnerWalls","count","corners","wallCount","corner","wallNeighbors","selectedWallPos","build","currentPosition","previousFloorPositions","prevPos","Play","mapWidth","mapHeight","unitCount","data","unitPosition","didCreate","generateBuilding","MapHelper","placeInitialItems","placePlayersInSafeZone","debrisCount","posXY","coord","addDebris","mediumDebrisCount","heavyDebrisCount","smallGasCanCount","mediumCanCount","largeGasCanCount","fireIntensity","addFire","npcCount","addNPC","playing","turnCount","getSaveCountRequirement","propogateFire","burnEntities","checkRemoveSafeFloors","hasLost","reset","initializeGameData","hasWon","nextLevel","increaseIntensity","level","setLevel","resetIntensity","mediumGasCanCount","toWin","gasCanCount","minimum","countNpcSafe","toLose","box","ent","burn","resetCanBurn","objects","Item","pop","players","player","Game","mapInitialized","tileMap","getSelectedCharacter","MAP_WIDTH","MAP_HEIGHT","spriteMode","Mode","highestLevel","placed","randomlyPlaceActorOnMap","ac","digger","Arena","freeCells","create","randomlyPlaceAllActorsOnMap","tiles","JSON","parse","placeInitialEntities","hasImpassableEntity","callback","parts","tileRenderer","nextFrame","animateTile","animateEntity","processTileMap","createTile","updateTile","getPlayers","getEntityRenderer","getTileRenderer","isPlaced","placeActorsOnMap","presserRef","show","focus","selectedCharacter","createEmptyLevel","initializeMap","initializeUI","handleKeyPress","event","code","Instructions","modeDetails","className","props","onClick","setActiveScreen","toggleSpriteMode","React","Component","Button","Keymap","entries","refocus","style","borderColor","world","Messages","Level","ENGINE","state","activeTab","createRef","newGameState","setState","ref","onKeyDown","tabIndex","reverse","CharacterSelect","characters","top","setSelectedCharacter","Title","backgroundImage","backgroundRepeat","backgroundPosition","backgroundPositionY","Lose","Win","p","g","Characters","FireFighter","Nystrum","characterKey","selected","activeScreen","titleScreen","loseScreen","winScreen","levelScreen","getActiveScreen","transitionName","transitionAppear","transitionEnter","transitionLeave","transitionAppearTimeout","transitionEnterTimeout","transitionLeaveTimeout","DRAW","components","getImpassableEntities","impasse","createEntity","sendEvent","eventType","parameters","component","self","MAKE_PASSABLE","MAKE_IMPASSABLE","body","MOVE","canOccupy","destructible","DECREASE_DURABILITY","INCREASE_DURABILITY","DESTROY","PREPARE_RENDER","scheduler","Simple","canAct","bg","naruto","reciever","responded","RECIEVE","sender","Components","box2","box3","kunai","throwable","THROW","nextTile","impassable_and_destructable_entities","App","location","hostname","match","ReactDOM","render","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.5ff03014.chunk.js","sourcesContent":["export const SCREENS = {\n  TITLE: 0,\n  LEVEL: 1,\n  LOSE: 2,\n  WIN: 3,\n}","import * as ROT from 'rot-js';\n\nexport const delay = (timeDelayed = 100) => {\n  // return;\n  if (timeDelayed <= 0) return;\n  return new Promise(resolve => setTimeout(resolve, timeDelayed));\n}\n\nexport const clamp = (value, min, max) => {\n  return Math.min(Math.max(value, min), max);\n};\n\nexport const getRandomInArray = (array) => {\n  return array[Math.floor(Math.random() * array.length)];\n}\n\nexport const getRandomInt = (min, max) => {\n  min = Math.ceil(min);\n  max = Math.floor(max);\n  return Math.floor(Math.random() * (max - min)) + min;\n}\n\nexport const getRandomIntInclusive = (min, max) => {\n  min = Math.ceil(min);\n  max = Math.floor(max);\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n}\n\nexport const coordsAreEqual = (pos_one, pos_two) => pos_one.x === pos_two.x && pos_one.y === pos_two.y\n\nexport const coordsToString = (coords) => `${coords.x},${coords.y}`\n\nexport const calculatePath = (game, targetPos, currentPos, topology = 4) => {\n  let map = game.map\n  let isPassable = function (x, y) {\n    const tile = map[x + \",\" + y];\n    if (tile) {\n      return (game.tileKey[tile.type].passable);\n    } else {\n      return false\n    }\n  }\n  let astar = new ROT.Path.AStar(targetPos.x, targetPos.y, isPassable, { topology });\n  let path = [];\n  astar.compute(currentPos.x, currentPos.y, function (x, y) {\n    path.push({ x, y })\n  });\n\n  return path.slice(1);\n}\n\nexport const calculatePathWithRange = (game, targetPos, currentPos, topology, range) => {\n  let path = calculatePath(game, targetPos, currentPos, topology);\n  return path.slice(0, range + 1);\n}\n\nexport const getRandomPos = (map) => {\n  let keys = Object.keys(map);\n  let key = getRandomInArray(keys).split(',');\n  let pos = { x: parseInt(key[0]), y: parseInt(key[1])}\n  return {coordinates: pos, text: key}\n}\n\nexport const getDestructableEntities = (entites) => {\n  return entites.filter((entity) => entity.hasOwnProperty('durability'));\n}\n\nconst getGranularity = (radius) => {\n  let result = (2 / 3) * (Math.pow(radius, 3) - (9 * Math.pow(radius, 2)) + (32 * radius) - 18)\n  return result\n}\n\nexport const getPointsOnCircumference = (centerX = 0, centerY = 0, r = 3) => {\n  const n = getGranularity(r);\n  let list = [];\n  for (let i = 0; i < n; i++) {\n    let x = Math.round(centerX + (Math.cos(2 * Math.PI / n * i) * r))\n    let y = Math.round(centerY + (Math.sin(2 * Math.PI / n * i) * r))\n    list.push({ x, y });\n  }\n  return list\n}\n","import * as Helper from '../../helper';\n\nexport const destroyEntity = (entity) => {\n  entity.energy = 0;\n  if (entity.pos) {\n    let tile = entity.game.map[Helper.coordsToString(entity.pos)];\n    entity.game.map[Helper.coordsToString(entity.pos)].entities = tile.entities.filter((e) => e.id !== entity.id);\n  }\n  // entity.game.engine.actors = entity.game.engine.actors.filter((e) => e.id !== entity.id);\n  entity.game.engine.removeStatusEffectByActorId(entity.id);\n  entity.game.draw()\n  entity.active = false;\n}","import * as Helper from '../helper'\n\nexport const ENERGY_THRESHOLD = 100;\n\nexport const COLORS = {\n  black_1: '#424242',\n  gray_1: '#262d37',\n  gray_2: '#606b79',\n  gray_4: '#B7C3CD',\n  gray_5: '#CED5DD',\n  green_1: '#1d533c',\n  green_2: '#227743',\n  green_3: '#2d9c59',\n  red_4: '#D82D33',\n  red_5: '#E16264',\n  purple_3: '#c45ffd',\n}\n\nexport const THEMES = {\n  SOLARIZED: {\n    base03: '#002b36',\n    base02: '#073642',\n    base01: '#586e75',\n    base00: '#657b83',\n    base0: '#839496',\n    base1: '#93a1a1',\n    base2: '#eee8d5',\n    base3: '#fdf6e3',\n    yellow: '#b58900',\n    orange: '#cb4b16',\n    red: '#dc322f',\n    magenta: '#d33682',\n    violet: '#6c71c4',\n    blue: '#268bd2',\n    cyan: '#2aa198',\n    green: '#859900',\n  }\n}\n\nexport const NPC_NAME = 'Helpless Citizen';\nexport const PLAYER_NAME = 'Fire Fighter';\n\nexport const TILE_KEY = {\n  'GROUND': {\n    background: THEMES.SOLARIZED.base03,\n    foreground: THEMES.SOLARIZED.base01,\n    character: '.',\n    sprite: '',\n    passable: true,\n  },\n  'FLOOR': {\n    background: THEMES.SOLARIZED.base02,\n    foreground: THEMES.SOLARIZED.base0,\n    character: '',\n    passable: true,\n  },\n  'SAFE_FLOOR': {\n    background: THEMES.SOLARIZED.base02,\n    foreground: THEMES.SOLARIZED.base0,\n    character: '',\n    passable: true,\n  },\n  'BURNT': {\n    background: THEMES.SOLARIZED.base03,\n    foreground: THEMES.SOLARIZED.red,\n    character: 'X',\n    sprite: '',\n    passable: true,\n    animation: [\n      { background: THEMES.SOLARIZED.base03, foreground: THEMES.SOLARIZED.red, character: 'X', sprite: '', passable: true, },\n      { background: THEMES.SOLARIZED.base03, foreground: THEMES.SOLARIZED.red, character: 'x', sprite: '', passable: true, },\n      { background: THEMES.SOLARIZED.base03, foreground: THEMES.SOLARIZED.red, character: 'X', sprite: '', passable: true, },\n      { background: THEMES.SOLARIZED.base03, foreground: THEMES.SOLARIZED.orange, character: 'x', sprite: '', passable: true, },\n      { background: THEMES.SOLARIZED.base03, foreground: THEMES.SOLARIZED.orange, character: 'X', sprite: '', passable: true, },\n      { background: THEMES.SOLARIZED.base03, foreground: THEMES.SOLARIZED.yellow, character: 'x', sprite: '', passable: true, },\n      { background: THEMES.SOLARIZED.base03, foreground: THEMES.SOLARIZED.red, character: 'X', sprite: '', passable: true, },\n    ]\n  },\n  'WET': {\n    background: THEMES.SOLARIZED.base03,\n    foreground: THEMES.SOLARIZED.blue,\n    character: '=',\n    sprite: '',\n    passable: true,\n    animation: [\n      { background: THEMES.SOLARIZED.base03, foreground: THEMES.SOLARIZED.blue, character: '=', sprite: '', passable: true, },\n      { background: THEMES.SOLARIZED.base03, foreground: THEMES.SOLARIZED.blue, character: '~', sprite: '', passable: true, },\n      { background: THEMES.SOLARIZED.base03, foreground: THEMES.SOLARIZED.blue, character: '=', sprite: '', passable: true, },\n      { background: THEMES.SOLARIZED.base03, foreground: THEMES.SOLARIZED.base0, character: '~', sprite: '', passable: true, },\n      { background: THEMES.SOLARIZED.base03, foreground: THEMES.SOLARIZED.base1, character: '=', sprite: '', passable: true, },\n      { background: THEMES.SOLARIZED.base03, foreground: THEMES.SOLARIZED.base1, character: '~', sprite: '', passable: true, },\n      { background: THEMES.SOLARIZED.base03, foreground: THEMES.SOLARIZED.blue, character: '=', sprite: '', passable: true, },\n    ]\n  },\n  'WALL': {\n    background: THEMES.SOLARIZED.base02,\n    foreground: THEMES.SOLARIZED.base2,\n    character: '#',\n    sprite: '',\n    passable: false,\n  },\n  'DOOR': {\n    background: THEMES.SOLARIZED.base02,\n    foreground: THEMES.SOLARIZED.base0,\n    character: '+',\n    sprite: '',\n    passable: true,\n  },\n  'SAFE': {\n    background: THEMES.SOLARIZED.base02,\n    foreground: THEMES.SOLARIZED.green,\n    character: '+',\n    sprite: '',\n    passable: true,\n  },\n\n  'WATER': {\n    animation: [\n      { background: '#424242', foreground: '#9dc3d3', character: '░', passable: false,},\n      { background: '#424242', foreground: '#9dc3d3', character: '░', passable: false,},\n      { background: '#424242', foreground: '#9dc3d3', character: '░', passable: false,},\n      { background: '#424242', foreground: '#9dc3d3', character: '░', passable: false,},\n      { background: '#424242', foreground: '#9dc3d3', character: '░', passable: false,},\n      { background: '#424242', foreground: '#9dc3d3', character: '░', passable: false,},\n      { background: '#424242', foreground: '#9dc3d3', character: '░', passable: false,},\n      { background: '#424242', foreground: '#9dc3d3', character: '░', passable: false,},\n      { background: '#424242', foreground: '#9dc3d3', character: '░', passable: false,},\n      { background: '#424242', foreground: '#9dc3d3', character: '░', passable: false,},\n      { background: '#424242', foreground: '#9dc3d3', character: '░', passable: false,},\n      { background: '#424242', foreground: '#8aa', character: '▒', passable: false, },\n      { background: '#424242', foreground: '#8aa', character: '▓', passable: false, },\n    ],\n    background: '#9dc3d3',\n    character: '░',\n    passable: false,\n  },\n}\n\nexport const HAND_SIGNS = {\n  Power: {\n    type: 'Power',\n    name: 'Rin',\n    description: 'Strength of mind, body, spirit',\n  },\n  Energy: {\n    type: 'Energy',\n    name: 'Pyo',\n    description: 'energy direction',\n  },\n  Harmony: {\n    type: 'Harmony',\n    name: 'To',\n    description: 'one- ness with the universe or self',\n  },\n  Healing: {\n    type: 'Healing',\n    name: 'Sha',\n    description: 'of self and others',\n  },\n  Intuition: {\n    type: 'Intuition',\n    name: 'Kai',\n    description: 'premonition of danger, feeling others intent',\n  },\n  Awareness: {\n    type: 'Awareness',\n    name: 'Jin',\n    description: 'feeling thoughts of others, perhaps hiding your own',\n  },\n  Dimension: {\n    type: 'Dimension',\n    name: 'Retsu',\n    description: 'control of time and space',\n  },\n  Creation: {\n    type: 'Creation',\n    name: 'Zai',\n    description: 'understanding nature',\n  },\n  Absolute: {\n    type: 'Absolute',\n    name: 'Zen',\n    description: 'enlightenment',\n  }, \n}\n\nexport const DIRECTIONS = {\n  N: [0, -1],\n  NE: [1, -1],\n  W: [-1, 0],\n  NW: [-1, -1],\n  SW: [-1, 1],\n  S: [0, 1],\n  SE: [1, 1],\n  E: [1, 0],\n  NONE: [0, 0],\n}\n\nexport const getDirectionKey = (direction) => {\n  let directionString = `${direction}`;\n  let keys = Object.keys(DIRECTIONS);\n  let result = false\n  keys.forEach((key) => {\n    if (`${DIRECTIONS[key]}` === directionString) {\n      result = key\n    }\n  })\n  return result\n}\n\nexport const EQUIPMENT_TYPES = {\n  HEAD: 'HEAD',\n  TORSO: 'TORSO',\n  BACK: 'BACK',\n  HAND: 'HAND',\n  FEET: 'FEET',\n  GENERIC: 'GENERIC',\n}\n\nexport const EQUIPMENT_LAYOUTS = {\n  human: () => {\n    return [\n      {type: EQUIPMENT_TYPES.HEAD, name: 'head', item: null},\n      {type: EQUIPMENT_TYPES.TORSO, name: 'torso', item: null},\n      {type: EQUIPMENT_TYPES.BACK, name: 'back', item: null},\n      {type: EQUIPMENT_TYPES.HAND, name: 'left_hand', item: null},\n      {type: EQUIPMENT_TYPES.HAND, name: 'right_hand', item: null},\n      {type: EQUIPMENT_TYPES.FEET, name: 'feet', item: null},\n    ]\n  },\n  limited: () => {\n    return [\n      {type: EQUIPMENT_TYPES.GENERIC, name: 'slot_1', item: null},\n      {type: EQUIPMENT_TYPES.GENERIC, name: 'slot_2', item: null},\n    ]\n  }\n}\n\nexport const CLONE_PATTERNS = {\n  verticalLine: {\n    x_offset: 1,\n    y_offset: 1,\n    positions: [\n      { x: 0, y: 0, taken: false, },\n      { x: 0, y: 1, taken: false, },\n      { x: 0, y: -1, taken: false, },\n    ]\n  },\n  smallSquare: {\n    x_offset: 1,\n    y_offset: 1,\n    positions: [\n      { x: 0, y: 0, taken: false, },\n      { x: 0, y: 1, taken: false, },\n      { x: 1, y: 1, taken: false, },\n      { x: 1, y: 0, taken: false, },\n    ]\n  },\n  square: {\n    x_offset: 2,\n    y_offset: 2,\n    positions: [\n      { x: 0, y: 0, taken: false, },\n      { x: 0, y: 1, taken: false, },\n      { x: 1, y: 1, taken: false, },\n      { x: 1, y: 0, taken: false, },\n      { x: 1, y: -1, taken: false, },\n      { x: 0, y: -1, taken: false, },\n      { x: -1, y: -1, taken: false, },\n      { x: -1, y: 0, taken: false, },\n      { x: -1, y: 1, taken: false, },\n    ]\n  },\n  bigSquare: {\n    x_offset: 2,\n    y_offset: 2,\n    positions: [\n      { x: 0, y: 0, taken: false, },\n      { x: 0, y: 1, taken: false, },\n      { x: 1, y: 1, taken: false, },\n      { x: 1, y: 0, taken: false, },\n      { x: 1, y: -1, taken: false, },\n      { x: 0, y: -1, taken: false, },\n      { x: -1, y: -1, taken: false, },\n      { x: -1, y: 0, taken: false, },\n      { x: -1, y: 1, taken: false, },\n      { x: 0, y: 1, taken: false, },\n      { x: 2, y: 2, taken: false, },\n      { x: 2, y: 0, taken: false, },\n      { x: 2, y: -2, taken: false, },\n      { x: 0, y: -2, taken: false, },\n      { x: -2, y: -2, taken: false, },\n      { x: -2, y: 0, taken: false, },\n      { x: -2, y: 2, taken: false, },\n    ],\n  },\n  circle: {\n    x_offset: 0,\n    y_offset: 0,\n    positions: [\n      ...Helper.getPointsOnCircumference(0, 0, 2),\n      ...Helper.getPointsOnCircumference(0, 0, 3)\n    ]\n  },\n}\n\nexport const PARTICLE_TEMPLATES = {\n  default: {\n    renderer: {\n      character: '*',\n      color: 'black',\n      background: 'white',\n    }\n  },\n  fail: {\n    renderer: {\n      character: 'x',\n      color: 'black',\n      background: 'red',\n    }\n  },\n  succede: {\n    renderer: {\n      character: 'x',\n      color: THEMES.SOLARIZED.base3,\n      background: THEMES.SOLARIZED.green,\n    }\n  },\n  damage: {\n    renderer: {\n      character: '*',\n      color: 'darkred',\n      background: 'red',\n    }\n  },\n  leaf: {\n    renderer: {\n      character: '✤',\n      color: '#36635b',\n      background: '#F0D8C0',\n    }\n  },\n  water: {\n    renderer: {\n      character: '~',\n      color: THEMES.SOLARIZED.base3,\n      background: THEMES.SOLARIZED.blue,\n    }\n  },\n}\n\nexport const PARTICLE_TYPE = {\n  directional: 0,\n  path: 1,\n}\n\nexport const ALPHABET = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z'];","import { COLORS, THEMES } from './constants';\nimport uuid from 'uuid/v1';\n\nexport const MESSAGE_TYPE = {\n  INFORMATION: {\n    color: COLORS.gray_4,\n    backgroundColor: COLORS.black_1,\n  },\n  ACTION: {\n    color: COLORS.gray_2,\n    backgroundColor: COLORS.gray_5,\n  },\n  DANGER: {\n    color: COLORS.red_5,\n    backgroundColor: COLORS.black_1,\n  },\n  STATUS_EFFECT: {\n    color: THEMES.SOLARIZED.base3,\n    backgroundColor: THEMES.SOLARIZED.violet,\n  },\n  ERROR: {\n    color: THEMES.SOLARIZED.base3,\n    backgroundColor: THEMES.SOLARIZED.yellow,\n  },\n}\n\nexport class Message {\n  constructor({ text = '', type = MESSAGE_TYPE.INFORMATION }) {\n    let id = uuid();\n    this.id = id;\n    this.text = text;\n    this.type = type;\n  }\n}","import * as Entity from './entites';\nimport * as Constant from './constants';\n\nexport const TYPE = {\n  KUNAI: 'Kunai',\n  DIRECTIONAL_KUNAI: 'Directional Kunai',\n  SWORD: 'Sword',\n  AXE: 'Axe',\n  ARMOR: 'Armor',\n  WATER_GUN: 'Water Gun',\n  BARRIER: 'Barrier',\n}\n\nconst createProjectileCloud = ({ \n  engine, \n  actor, \n  targetPos, \n  throwDirection,\n  speed,\n  structureType,\n  createProjectile,\n}) => {\n  let structure = Constant.CLONE_PATTERNS[structureType];\n\n  let children = structure.positions.map((slot) => {\n    let position = {\n      x: actor.pos.x + slot.x + (throwDirection.x * structure.x_offset),\n      y: actor.pos.y + slot.y + (throwDirection.y * structure.y_offset)\n    }\n    \n    let targetPosition = {\n      x: targetPos.x + slot.x,\n      y: targetPos.y + slot.y,\n    }\n\n    return createProjectile(engine, position, targetPosition);\n  })\n\n  return new Entity.DestructiveCloudProjectileV2({\n    game: engine.game,\n    passable: true,\n    speed,\n    children,\n  })\n}\n\nconst createProjectileSingularity = ({ \n  engine, \n  actor, \n  targetPos, \n  speed,\n  structureType,\n  createProjectile,\n}) => {\n  let structure = Constant.CLONE_PATTERNS[structureType];\n\n  let children = structure.positions.map((slot) => {\n    let position = {\n      x: targetPos.x + slot.x + structure.x_offset,\n      y: targetPos.y + slot.y + structure.y_offset\n    }\n\n    let targetPosition = {\n      x: targetPos.x,\n      y: targetPos.y,\n    }\n\n    return createProjectile(engine, position, targetPosition);\n\n  })\n\n  return new Entity.DestructiveCloudProjectileV2({\n    game: engine.game,\n    passable: true,\n    speed,\n    children,\n  })\n}\n\nconst createProjectileBurst = ({ \n  engine, \n  actor, \n  targetPos, \n  speed,\n  structureType,\n  createProjectile,\n}) => {\n  let structure = Constant.CLONE_PATTERNS[structureType];\n\n  let children = structure.positions.map((slot) => {\n    let position = {\n      x: targetPos.x + structure.x_offset,\n      y: targetPos.y + structure.y_offset\n    }\n\n    let targetPosition = {\n      x: targetPos.x + slot.x,\n      y: targetPos.y + slot.y,\n    }\n\n    return createProjectile(engine, position, targetPosition);\n\n  })\n\n  return new Entity.DestructiveCloudProjectileV2({\n    game: engine.game,\n    passable: true,\n    speed,\n    children,\n  })\n}\n\nexport const sandTomb = ({\n  engine,\n  actor,\n  targetPos,\n}) => createProjectileSingularity({\n  engine,\n  actor,\n  targetPos,\n  speed: 100,\n  structureType: 'circle',\n  createProjectile: sandTombPart,\n})\n\nexport const sandBurst = ({\n  engine,\n  actor,\n  targetPos,\n}) => createProjectileBurst({\n  engine,\n  actor,\n  targetPos,\n  speed: 500,\n  structureType: 'circle',\n  createProjectile: sandTombPart,\n})\n\nexport const sandWallPulse = ({\n  engine,\n  actor,\n  targetPos,\n  throwDirection,\n}) => createProjectileCloud({\n  engine,\n  actor,\n  targetPos,\n  throwDirection,\n  speed: 500,\n  structureType: 'smallSquare',\n  createProjectile: movingSandWall,\n})\n\nexport const kunaiCloud = ({\n  engine,\n  actor,\n  targetPos,\n  throwDirection,\n}) => createProjectileCloud({\n  engine,\n  actor,\n  targetPos,\n  throwDirection,\n  speed: 500,\n  structureType: 'square',\n  createProjectile: kunai,\n})\n\nexport const fireballCloud = ({\n  engine,\n  actor,\n  targetPos,\n  throwDirection,\n}) => createProjectileCloud({\n  engine,\n  actor,\n  targetPos,\n  throwDirection,\n  speed: 500,\n  structureType: 'square',\n  createProjectile: fireball,\n})\n\nexport const kunai = (engine, pos, targetPos) => new Entity.DestructiveProjectile({\n  game: engine.game,\n  targetPos,\n  passable: true,\n  pos: { x: pos.x, y: pos.y },\n  renderer: {\n    character: '>',\n    color: 'white',\n    background: '',\n    animation: [\n      { background: '', foreground: 'white', character: '>', },\n      { background: '', foreground: 'white', character: 'v', },\n      { background: '', foreground: 'white', character: '<', },\n      { background: '', foreground: 'white', character: '^', },\n      { background: '', foreground: 'white', character: '>', },\n    ],\n  },\n  name: TYPE.KUNAI,\n  speed: 600,\n  energy: 0,\n  range: 30,\n})\n\nexport const directionalKunai = (engine, pos, direction, range) => new Entity.DirectionalProjectile({\n  game: engine.game,\n  direction,\n  passable: true,\n  pos: { x: pos.x, y: pos.y },\n  renderer: {\n    character: '>',\n    color: 'white',\n    background: '',\n    animation: [\n      { background: 'lightgrey', foreground: 'grey', character: '>', },\n      { background: 'lightgrey', foreground: 'grey', character: 'v', },\n      { background: 'lightgrey', foreground: 'grey', character: '<', },\n      { background: 'lightgrey', foreground: 'grey', character: '^', },\n      { background: 'lightgrey', foreground: 'grey', character: '>', },\n    ],\n  },\n  name: TYPE.DIRECTIONAL_KUNAI,\n  speed: 600,\n  energy: 0,\n  range,\n})\n\nexport const movingSandWall = (engine, pos, targetPos, range) => new Entity.MovingWall({\n  game: engine.game,\n  passable: false,\n  pos: { x: pos.x, y: pos.y },\n  targetPos,\n  renderer: {\n    // character: '>',\n    character: ']',\n    color: '#A89078',\n    background: '#D8C0A8',\n  },\n  name: TYPE.KUNAI,\n  // name: TYPE.BARRIER,\n  durability: 3,\n  range,\n  speed: 300,\n})\n\nexport const sandShuriken = (engine, pos, direction, range) => new Entity.DirectionalProjectile({\n  game: engine.game,\n  direction,\n  passable: true,\n  pos: { x: pos.x, y: pos.y },\n  renderer: {\n    // character: '>',\n    character: '✦️',\n    color: '#A89078',\n    background: '#D8C0A8',\n  },\n  name: TYPE.DIRECTIONAL_KUNAI,\n  speed: 600,\n  energy: 0,\n  range,\n})\n\nexport const sandTombPart = (engine, pos, targetPos) => new Entity.DestructiveProjectile({\n  game: engine.game,\n  targetPos,\n  passable: true,\n  pos: { x: pos.x, y: pos.y },\n  renderer: {\n    // character: '>',\n    character: '✦️',\n    color: '#A89078',\n    background: '#D8C0A8',\n  },\n  name: TYPE.KUNAI,\n  speed: 600,\n  energy: 0,\n  range: 30,\n})\n\nexport const fireball = (engine, pos, targetPos) => new Entity.DestructiveProjectile({\n  game: engine.game,\n  targetPos,\n  passable: true,\n  pos: { x: pos.x, y: pos.y },\n  renderer: {\n    // character: '>',\n    character: '🔥',\n    color: 'wheat',\n    background: 'tomato',\n  },\n  name: TYPE.KUNAI,\n  speed: 100,\n  energy: 0,\n  range: 30,\n})\n\nexport const fireballGas = (engine, actor, targetPos) => {\n  return new Entity.DestructiveCloudProjectile({\n    game: engine.game,\n    owner_id: actor ? actor.id : null,\n    targetPos,\n    passable: true,\n    pos: actor ? { x: actor.pos.x, y: actor.pos.y } : null,\n    renderer: {\n      // character: '@',\n      character: '🔥',\n      color: 'wheat',\n      background: 'tomato',\n    },\n    name: TYPE.KUNAI,\n    speed: 100,\n    range: 10,\n    clonePattern: Constant.CLONE_PATTERNS.bigSquare,\n    // clonePattern: Constant.CLONE_PATTERNS.square,\n  })\n}\n\nexport const waterball = (engine, actor, targetPos) => new Entity.DestructiveCloudProjectile({\n  game: engine.game,\n  owner_id: actor ? actor.id : null,\n  targetPos,\n  passable: true,\n  pos: actor ? { x: actor.pos.x, y: actor.pos.y } : null,\n  renderer: {\n    // character: '~',\n    character: '🌊',\n    color: 'silver',\n    background: 'lightslategrey',\n  },\n  name: TYPE.KUNAI,\n  speed: 800,\n  range: 10,\n  clonePattern: Constant.CLONE_PATTERNS.bigSquare,\n  // clonePattern: Constant.CLONE_PATTERNS.square,\n})\n\nexport const sword = (engine) => new Entity.Weapon({\n  game: engine.game,\n  name: TYPE.SWORD,\n  passable: true,\n  attackDamage: 1,\n  equipmentType: Constant.EQUIPMENT_TYPES.HAND,\n  renderer: {\n    // character: '|',\n    character: '🗡️',\n    color: 'white',\n    background: '',\n  },\n})\n\nexport const axe = (engine) => new Entity.Weapon({\n  game: engine.game,\n  name: TYPE.AXE,\n  passable: true,\n  attackDamage: 5,\n  equipmentType: Constant.EQUIPMENT_TYPES.GENERIC,\n  renderer: {\n    character: 'a',\n    sprite: '',\n    color: 'white',\n    background: '',\n  },\n})\n\nexport const waterGun = (engine) => new Entity.Weapon({\n  game: engine.game,\n  name: TYPE.WATER_GUN,\n  passable: true,\n  attackDamage: 0,\n  equipmentType: Constant.EQUIPMENT_TYPES.GENERIC,\n  renderer: {\n    character: 'w',\n    sprite: '',\n    color: Constant.THEMES.SOLARIZED.blue,\n    background: '',\n  },\n})\n\nexport const fireJacket = (engine) => new Entity.Armor({\n  game: engine.game,\n  name: 'Fire Jacket',\n  passable: true,\n  defense: 1,\n  equipmentType: Constant.EQUIPMENT_TYPES.GENERIC,\n  renderer: {\n    character: 'J',\n    sprite: '',\n    color: Constant.THEMES.SOLARIZED.magenta,\n    background: '',\n  },\n})\n\nexport const test = (engine, pos) => new Entity.Weapon({\n  game: engine.game,\n  name: TYPE.SWORD,\n  passable: true,\n  attackDamage: 1,\n  pos,\n  equipmentType: Constant.EQUIPMENT_TYPES.HAND,\n  renderer: {\n    // character: '|',\n    character: '🗡️',\n    color: 'white',\n    background: 'lightsteelblue',\n  },\n})\n","import { Howl, Howler } from 'howler';\n\nconsole.log(window.PUBLIC_URL);\n\n\nexport default {\n  fire_0: new Howl({\n    src: [window.PUBLIC_URL + '/sounds/fire-00.mp3'],\n    volume: 0.5,\n    loop: true,\n  }),\n  fire_1: new Howl({\n    src: [window.PUBLIC_URL + '/sounds/fire-01.mp3'],\n    volume: 0.05,\n    loop: true,\n  }),\n  scream_0: new Howl({\n    src: [window.PUBLIC_URL + '/sounds/scream-00.wav']\n  }),\n  scream_1: new Howl({\n    src: [window.PUBLIC_URL + '/sounds/scream-01.wav']\n  }),\n  scream_2: new Howl({\n    src: [window.PUBLIC_URL + '/sounds/scream-02.wav']\n  }),\n  water_0: new Howl({\n    src: [window.PUBLIC_URL + '/sounds/water-04.wav']\n  }),\n  water_1: new Howl({\n    src: [window.PUBLIC_URL + '/sounds/water-05.wav']\n  }),\n  chop_0: new Howl({\n    src: [window.PUBLIC_URL + '/sounds/chop-00.wav']\n  }),\n  chop_1: new Howl({\n    src: [window.PUBLIC_URL + '/sounds/chop-01.wav']\n  }),\n  equip_0: new Howl({\n    src: [window.PUBLIC_URL + '/sounds/equip-00.wav']\n  }),\n  equip_1: new Howl({\n    src: [window.PUBLIC_URL + '/sounds/equip-01.wav']\n  }),\n  explosion_0: new Howl({\n    src: [window.PUBLIC_URL + '/sounds/explosion-00.wav'],\n    volume: 0.2,\n  }),\n  save: new Howl({\n    src: [window.PUBLIC_URL + '/sounds/save.wav'],\n  }),\n  lose: new Howl({\n    src: [window.PUBLIC_URL + '/sounds/lose-00.wav'],\n  }),\n  grab_0: new Howl({\n    src: [window.PUBLIC_URL + '/sounds/grab-00.wav'],\n  }),\n  release_0: new Howl({\n    src: [window.PUBLIC_URL + '/sounds/grab-01.wav'],\n  }),\n}","import * as Helper from '../helper';\nimport * as Action from './actions';\nimport * as Constant from './constants';\nimport { cloneDeep } from 'lodash';\nimport uuid from 'uuid/v1';\nimport { Particle } from './entites';\nimport { MESSAGE_TYPE } from './message';\nimport { TYPE as ITEM_TYPES } from './items';\nimport SOUNDS from './sounds';\n\nexport class Base {\n  constructor({\n    game, \n    actor, \n    energyCost = 100, \n    processDelay = 50, \n    particles = [], \n    particleTemplate = Constant.PARTICLE_TEMPLATES.default,\n    onBefore = () => null,\n    onAfter = () => null,\n    onSuccess = () => null,\n    onFailure = () => null,\n    interrupt = false,\n  }) {\n    this.actor = actor\n    this.game = game\n    this.energyCost = energyCost\n    this.processDelay = processDelay\n    this.particles = particles\n    this.particleTemplate = particleTemplate\n    this.onBefore = onBefore\n    this.onAfter = onAfter\n    this.onSuccess = onSuccess\n    this.onFailure = onFailure\n    this.interrupt = interrupt\n  }\n\n  addParticle(\n    life, \n    pos, \n    direction, \n    renderer = {...this.particleTemplate.renderer}, \n    type = Constant.PARTICLE_TYPE.directional, \n    path = null\n  ) {\n    let particle = new Particle({\n      game: this.game,\n      name: 'particle',\n      passable: true,\n      life,\n      pos,\n      direction,\n      energy: 100,\n      renderer,\n      type,\n      path,\n    })\n    this.particles.push(particle);\n  }\n\n  removeDeadParticles() {\n    this.particles = this.particles.filter((particle) => particle.life > 0);\n  }\n\n  perform() {\n    console.log(`${this.actor.name} performs`)\n    this.actor.energy -= this.energyCost;\n    return {\n      success: true,\n      alternative: null,\n    }\n  }\n}\n\nexport class AddStatusEffect extends Base {\n  constructor({ effect, processDelay = 0, ...args }) {\n    super({ ...args });\n    this.effect = effect\n    this.processDelay = processDelay\n  }\n\n  perform() {\n    let success = this.game.engine.addStatusEffect(this.effect);\n    let positions = Helper.getPointsOnCircumference(this.actor.pos.x, this.actor.pos.y, 2);\n    positions.forEach((pos) => {\n      this.addParticle(\n        5, \n        {...pos}, \n        {\n          x: Math.sign(pos.x - this.actor.pos.x), \n          y: Math.sign(pos.y - this.actor.pos.y)\n        },\n      )\n    })\n    if (success) this.actor.energy -= this.energyCost;\n    return {\n      success,\n      alternative: null,\n    }\n  }\n};\n\nexport class Say extends Base {\n  constructor({ message, messageType = MESSAGE_TYPE.INFORMATION, processDelay = 50, ...args}) {\n    super({...args});\n    this.message = message\n    this.messageType = messageType\n    this.processDelay = processDelay\n  }\n  perform() {\n    this.game.addMessage(`${this.actor.name} says \"${this.message}\"`, this.messageType);\n    this.actor.energy -= this.energyCost;\n    return {\n      success: true,\n      alternative: null,\n    }\n  }\n};\n\nexport class SayManyThings extends Base {\n  constructor({ messages, processDelay = 50, ...args}) {\n    super({...args});\n    this.messages = messages\n    this.processDelay = processDelay\n  }\n  perform() {\n    let message = this.messages.shift();\n    if (message) {\n      this.game.addMessage(`${this.actor.name} says ${message}`, MESSAGE_TYPE.INFORMATION);\n      this.actor.energy -= this.energyCost;\n    }\n    if (this.messages.length) {\n      this.actor.setNextAction(this);\n    }\n    return {\n      success: true,\n      alternative: null,\n    }\n  }\n};\n\nexport class SprayWater extends Base {\n  constructor({ targetPos, radius = 1, ...args}) {\n    super({...args});\n    this.targetPos = targetPos\n    this.radius = radius\n    this.particleTemplate = Constant.PARTICLE_TEMPLATES.water\n  }\n  perform() {\n\n    if (!this.actor.hasItemNameEquipped(ITEM_TYPES.WATER_GUN)) {\n      this.game.addMessage(`${this.actor.name} doesn't have a ${ITEM_TYPES.WATER_GUN}.`, MESSAGE_TYPE.ERROR);\n      return {\n        success: false,\n        alternative: null,\n      }\n    }\n\n    let structure = {\n      x_offset: 0,\n      y_offset: 0,\n      positions: Array(this.radius).fill('').reduce((acc, curr, i) => {\n        return acc.concat(...Helper.getPointsOnCircumference(0, 0, i + 1))\n      }, [])\n    };\n\n    const positions = structure.positions.map((slot) => {\n      return {\n        x: this.targetPos.x + slot.x + structure.x_offset,\n        y: this.targetPos.y + slot.y + structure.y_offset\n      }\n    }).concat({...this.targetPos});\n\n    positions.forEach((position) => {\n      const tile = this.game.map[Helper.coordsToString(position)];\n      if (tile) { \n        if (tile.type === 'BURNT') tile.type = 'GROUND';\n        if (tile.type === 'FLOOR') tile.type = 'WET';\n      }\n    });\n\n    // adding particles\n    positions.forEach((pos) => {\n      this.addParticle(\n        3,\n        { ...pos },\n        {\n          x: Math.sign(pos.x - this.targetPos.x),\n          y: Math.sign(pos.y - this.targetPos.y)\n        },\n      )\n    })\n\n    // sounds\n    const sound = Helper.getRandomInArray([SOUNDS.water_0, SOUNDS.water_1])\n    sound.play();\n\n    this.actor.energy -= this.energyCost;\n    return {\n      success: true,\n      alternative: null,\n    }\n  }\n};\n\nexport class EquipItemFromContainer extends Base {\n  // entities can only equip items from their container/inventory\n  constructor({ item, ...args }) {\n    super({ ...args });\n    this.item = item;\n  }\n  perform() {\n    let success = false;\n    let alternative = null;\n    if (this.item.equipmentType) {\n      let itemInSlot = this.actor.getItemInSlot(this.item.equipmentType);\n      if (itemInSlot) {\n        this.actor.addToContainer(itemInSlot);\n        this.actor.unequip(itemInSlot);\n      }\n      this.actor.removeFromContainer(this.item);\n      this.actor.equip(this.item.equipmentType, this.item);\n      this.game.addMessage(`${this.actor.name} equips ${this.item.name}.`, MESSAGE_TYPE.ACTION);\n      success = true;\n    }\n\n    this.actor.energy -= this.energyCost;\n    \n    return {\n      success,\n      alternative,\n    }\n  }\n};\n\nexport class EquipItemFromTile extends Base {\n  // entities can only equip items from their container/inventory\n  constructor({ item, ...args }) {\n    super({ ...args });\n    this.item = item;\n  }\n\n  perform () {\n    let success = false;\n    let alternative = null;\n\n    if (this.item.equipmentType) {\n      let itemInSlot = this.actor.getItemInSlot(this.item.equipmentType);\n      // if (itemInSlot) {\n      //   this.game.map[Helper.coordsToString(this.actor.pos)].entities.push(itemInSlot);\n      // }\n      if (itemInSlot) {\n        this.game.addMessage(`${this.actor.name}\\'s equipment slots are full.`, MESSAGE_TYPE.ERROR);\n      } else {\n        this.actor.equip(this.item.equipmentType, this.item);\n        let entities = this.game.map[Helper.coordsToString(this.actor.pos)].entities\n        this.game.map[Helper.coordsToString(this.actor.pos)].entities = entities.filter((it) => it.id !== this.item.id);\n        this.game.addMessage(`${this.actor.name} equips ${this.item.name}.`, MESSAGE_TYPE.ACTION);\n        success = true;\n        this.actor.energy -= this.energyCost;\n      }\n\n    }\n\n    return {\n      success,\n      alternative,\n    }\n  }\n};\n\nexport class UnequipItem extends Base {\n  constructor({ item, ...args }) {\n    super({ ...args });\n    this.item = item;\n  }\n  perform() {\n    this.game.addMessage(`${this.actor.name} puts ${this.item.name} away.`, MESSAGE_TYPE.ACTION);\n    this.actor.unequip(this.item);\n    this.actor.addToContainer(this.item);\n    this.actor.energy -= this.energyCost;\n    return {\n      success: true,\n      alternative: null,\n    }\n  }\n};\n\nexport class UnequipItemToTile extends Base {\n  constructor({ item, ...args }) {\n    super({ ...args });\n    this.item = item;\n  }\n  perform() {\n    this.game.addMessage(`${this.actor.name} drops ${this.item.name}.`, MESSAGE_TYPE.ACTION);\n    this.actor.unequip(this.item);\n    this.game.map[Helper.coordsToString(this.actor.pos)].entities.splice(0, 0, this.item);\n    this.actor.energy -= this.energyCost;\n    return {\n      success: true,\n      alternative: null,\n    }\n  }\n};\n\nexport class DropItem extends Base {\n  constructor({ item, ...args }) {\n    super({ ...args });\n    this.item = item;\n  }\n  perform() {\n    this.game.addMessage(`${this.actor.name} drops ${this.item.name}.`, MESSAGE_TYPE.ACTION);\n    this.actor.removeFromContainer(this.item);\n    this.game.map[Helper.coordsToString(this.actor.pos)].entities.push(this.item);\n    this.actor.energy -= this.energyCost;\n    return {\n      success: true,\n      alternative: null,\n    }\n  }\n};\n\nexport class PickupItem extends Base {\n  constructor({ item, ...args }) {\n    super({ ...args });\n    this.item = item;\n  }\n  perform() {\n    this.game.addMessage(`${this.actor.name} picks up ${this.item.name}.`, MESSAGE_TYPE.ACTION);\n    this.actor.addToContainer(this.item);\n    let entities = this.game.map[Helper.coordsToString(this.actor.pos)].entities\n    this.game.map[Helper.coordsToString(this.actor.pos)].entities = entities.filter((it) => it.id !== this.item.id);\n    this.actor.energy -= this.energyCost;\n    return {\n      success: true,\n      alternative: null,\n    }\n  }\n};\n\nexport class DestroySelf extends Base {\n  constructor({processDelay = 0, ...args}) {\n    super({...args});\n    this.processDelay = processDelay\n  }\n  perform() {\n    // console.log(`${this.actor.name} is self-destructing`);\n    this.actor.energy -= this.energyCost;\n    this.actor.destroy();\n    return {\n      success: true,\n      alternative: null,\n    }\n  }\n};\n\nexport class CloneSelf extends Base {\n  constructor({cloneArgs = [], ...args}) {\n    super({...args});\n    this.cloneArgs = cloneArgs;\n  }\n\n  perform() {\n    let success = false;\n    if (this.actor.createClone(this.cloneArgs)) {\n      success = true;\n      this.actor.energy -= this.energyCost;\n      this.game.addMessage(`${this.actor.name} is cloning itself`, MESSAGE_TYPE.ACTION);\n    }\n    // let clone = cloneDeep(this.actor);\n    // clone.game = this.actor.game;\n    // clone.id = uuid();\n    // this.cloneArgs.forEach((arg) => {\n    //   console.log(arg);\n      \n    //   clone[arg.attribute] = arg.value\n    // });\n    // if (this.game.placeActorOnMap(clone)) {\n    //   this.game.engine.addActorAsNext(clone);\n    //   this.game.draw();\n    //   success = true;\n    // };\n    return {\n      success,\n      alternative: null,\n    }\n  }\n};\n\nexport class Charge extends Base {\n  constructor({chargeAmount, ...args}) {\n    super({...args});\n    this.chargeAmount = chargeAmount;\n  }\n  perform() {\n    this.game.addMessage(`${this.actor.name} is charging up!`, MESSAGE_TYPE.ACTION);\n    this.actor.energy -= this.energyCost;\n    this.actor.increaseCharge(this.chargeAmount);\n    return {\n      success: true,\n      alternative: null,\n    }\n  }\n};\n\nexport class Release extends Base {\n  constructor({ chargeCost, ...args }) {\n    super({ ...args });\n    this.chargeCost = chargeCost;\n  }\n  perform() {\n    let success = false;\n    if (this.actor.charge >= this.chargeCost) {\n      this.game.addMessage(`${this.actor.name} is releasing ${this.chargeCost} volts!`, MESSAGE_TYPE.ACTION);\n      this.actor.energy -= this.energyCost;\n      this.actor.decreaseCharge(this.chargeCost);\n      success = true;\n    }\n    return {\n      success,\n      alternative: null,\n    }\n  }\n};\n\nexport class Sign extends Base {\n  constructor({ sign, ...args }) {\n    super({ ...args });\n    this.sign = sign;\n  }\n  perform() {\n    this.game.addMessage(`${this.actor.name} threw a ${this.sign.name} sign.`, MESSAGE_TYPE.ACTION);\n    this.actor.addSign(this.sign);\n    this.actor.energy -= this.energyCost;\n    return {\n      success: true,\n      alternative: null,\n    }\n  }\n};\n\nexport class SignRelease extends Base {\n  constructor({requiredSequence = [], ...args}) {\n    super({...args});\n    this.requiredSequence = requiredSequence;\n  }\n\n  requiredSequenceIsFulfilled () {\n    let signHistory = this.actor.signHistory.concat();\n    let relevantHistory = signHistory.slice(\n      Math.max(signHistory.length - this.requiredSequence.length, 0)\n    )\n    let result = JSON.stringify(relevantHistory) === JSON.stringify(this.requiredSequence);\n    return result\n  }\n\n  perform() {\n    let success = false;\n    if (this.requiredSequenceIsFulfilled()) {\n      this.game.addMessage(\n        `${this.actor.name} is releasing the power of ${this.requiredSequence.map(\n          (sign) => sign.type\n        ).join(' and ')}!`,\n        MESSAGE_TYPE.ACTION\n      );\n      this.actor.energy -= this.energyCost;\n      success = true;\n      this.actor.clearSigns();\n    }\n    return {\n      success,\n      alternative: null,\n    }\n  }\n};\n\nexport class CursorMove extends Base {\n  constructor({ targetPos, processDelay = 0, ...args}) {\n    super({...args});\n    this.targetPos = targetPos\n    this.processDelay = processDelay\n  }\n  perform() {\n    let success = false;\n    let alternative = null;\n\n    const initiatedFrom = this.actor.initiatedBy.pos; \n    const path = Helper.calculatePath(this.game, this.targetPos, initiatedFrom, 8);\n    const isInRange = this.actor.range ? path.length <= this.actor.range : true;\n\n    if (isInRange && this.game.cursorCanOccupyPosition(this.targetPos)) {\n      let tile = this.game.map[Helper.coordsToString(this.actor.pos)]\n      this.game.map[Helper.coordsToString(this.actor.pos)] = { ...tile, entities: tile.entities.filter((e) => e.id !== this.actor.id) }\n      this.actor.pos = this.targetPos\n      this.game.map[Helper.coordsToString(this.targetPos)].entities.push(this.actor);\n      success = true;\n    }\n\n    return {\n      success,\n      alternative,\n    }\n  }\n};\n\nexport class ParticleMove extends CursorMove {\n  constructor({...args}) {\n    super({...args})\n  }\n\n  perform () {\n    this.actor.energy -= this.energyCost;\n    if (this.actor.energy <= 0) {\n      this.actor.destroy();\n      return { success: false }\n    } \n    return super.perform();\n  }\n}\n\nexport class PlaceActor extends Base {\n  constructor({ targetPos, entity, interrupt = true, forcePlacement = false, ...args}) {\n    super({...args});\n    this.targetPos = targetPos\n    this.entity = entity\n    this.interrupt = interrupt\n    this.forcePlacement = forcePlacement\n  }\n  perform() {\n    let success = false;\n    let alternative = null;\n    \n    // let canPlace = true;\n    // if (!this.game.canOccupyPosition(this.targetPos, this.entity)) canPlace = false;\n    // if (this.entity.entityTypes.includes('PARENT')) {\n    //   this.entity.children.forEach((child) => {\n    //     console.log(child.pos);\n        \n    //     if (!this.game.canOccupyPosition(child.pos, child)) canPlace = false;\n    //   })\n    // }\n\n    // if (canPlace) {\n    //   this.entity.pos = this.targetPos;\n    //   this.game.engine.addActorAsPrevious(this.entity);\n    //   this.game.engine.start(); // should this be used outside of engine?\n    //   success = true;      \n    // }\n\n    let canOccupyPosition = this.forcePlacement ? true : this.game.canOccupyPosition(this.targetPos, this.entity);\n    const tile = this.game.map[Helper.coordsToString(this.targetPos)];\n\n    if (canOccupyPosition && tile) {\n      this.entity.pos = this.targetPos;\n      tile.entities.push(this.entity);\n      // this.game.engine.addActorAsPrevious(this.entity);\n      // this.game.engine.addActor(this.entity);\n      this.game.engine.addActorAsNext(this.entity);\n      // this.interrupt = true;\n      // this.game.engine.start(); // BUGGED - should this be used outside of engine?\n      success = true;\n    }\n      \n    if (success) {\n      this.actor.energy -= this.energyCost;\n    }\n    \n    return {\n      success,\n      alternative,\n    }\n  }\n};\n\nexport class PlaceItem extends Base {\n  constructor({ targetPos, entity, processDelay = 25, ...args}) {\n    super({...args});\n    this.targetPos = targetPos\n    this.processDelay = processDelay\n    this.entity = entity\n  }\n  perform() {\n    let success = false;\n    let alternative = null;\n    \n    if (this.game.canOccupyPosition(this.targetPos, this.entity)) {\n      this.entity.pos = this.targetPos;\n      success = this.game.placeActorOnMap(this.entity)\n    }\n      \n    if (success) {\n      this.actor.energy -= this.energyCost;\n    }\n    \n    return {\n      success,\n      alternative,\n    }\n  }\n};\n\nexport class PlaceItems extends PlaceItem {\n  constructor({targetPositions = [], ...args}) {\n    super({...args});\n    this.targetPositions = targetPositions\n  }\n  perform() {\n    let success = false;\n    let alternative = null;\n    this.targetPositions.forEach((targetPos) => {\n      if (this.game.canOccupyPosition(targetPos, this.entity)) {\n        let clone = cloneDeep(this.entity);\n        clone.game = this.game;\n        clone.id = uuid();\n        clone.pos = targetPos;\n        let placementSuccess = this.game.placeActorOnMap(clone);\n        if (placementSuccess) success = true;\n      }\n    });\n\n    if (success) this.actor.energy -= this.energyCost;\n\n    return {\n      success,\n      alternative,\n    }\n  }\n};\n\nexport class Move extends Base {\n  constructor({ targetPos, processDelay = 25, ...args}) {\n    super({...args});\n    this.targetPos = targetPos\n    this.processDelay = processDelay\n  }\n  perform() {\n    let success = false;\n    let alternative = null;\n    let moveSuccess = this.actor.move(this.targetPos);\n    if (moveSuccess) {\n      this.actor.energy -= this.energyCost;\n      success = true;\n    } else {\n      success = true;\n      alternative = new Action.Attack({\n        targetPos: this.targetPos,\n        game: this.game, \n        actor: this.actor, \n        energyCost: Constant.ENERGY_THRESHOLD\n      })\n    }\n\n    return {\n      success,\n      alternative,\n    }\n  }\n};\n\nexport class ProjectileMove extends Base {\n  constructor({ targetPos, damageToSelf = 1, processDelay = 25, ...args}) {\n    super({...args});\n    this.targetPos = targetPos\n    this.processDelay = processDelay\n    this.damageToSelf = damageToSelf\n  }\n\n  perform() {\n    let success = false;\n    let alternative = null;\n    let moveSuccess = this.actor.move(this.targetPos);\n    if (moveSuccess) {\n      this.actor.energy -= this.energyCost;\n      success = true;\n    } else {\n      success = true;\n      alternative = new Action.SelfDestructiveAttack({\n        targetPos: this.targetPos,\n        game: this.game, \n        actor: this.actor, \n        energyCost: Constant.ENERGY_THRESHOLD,\n        damageToSelf: this.damageToSelf,\n      })\n    }\n\n    return {\n      success,\n      alternative,\n    }\n  }\n};\n\nexport class MoveMultiple extends Base {\n  constructor({ direction, stepCount, processDelay = 25, ...args}) {\n    super({...args});\n    this.direction = direction;\n    this.stepCount = stepCount;\n    this.processDelay = processDelay;\n  }\n  perform() {\n    let success = false;\n    let alternative = null;\n    let newX = this.actor.pos.x + this.direction[0];\n    let newY = this.actor.pos.y + this.direction[1];\n    let targetPos = { x: newX, y: newY };\n    \n    if (this.stepCount > 0 && this.actor.move(targetPos)) {\n      this.stepCount -= 1;\n      this.actor.energy -= this.energyCost;\n      this.actor.setNextAction(this);\n      success = true;\n    } else {\n      success = true;\n      alternative = new Action.Attack({\n        targetPos: targetPos,\n        game: this.game, \n        actor: this.actor, \n        energyCost: Constant.ENERGY_THRESHOLD\n      })\n    }\n\n    return {\n      success,\n      alternative,\n    }\n  }\n};\n\nexport class Shove extends Base {\n  constructor({ targetPos, direction, ...args }) {\n    super({ ...args });\n    this.targetPos = targetPos\n    this.direction = direction\n  }\n  perform() {\n    let success = false;\n    let alternative = null;\n    let moveSuccess = this.actor.shove(this.targetPos, this.direction)\n    \n    if (moveSuccess) {\n      this.actor.energy -= this.energyCost;\n      success = true;\n    } else {\n      success = true;\n      alternative = new Action.Attack({\n        targetPos: this.targetPos,\n        game: this.game,\n        actor: this.actor,\n        energyCost: Constant.ENERGY_THRESHOLD\n      })\n    }\n\n    return {\n      success,\n      alternative,\n    }\n  }\n};\n\nexport class GrabDirection extends Base {\n  constructor({ targetPos, ...args }) {\n    super({ ...args });\n    this.targetPos = targetPos\n  }\n\n  perform() {\n    let success = false;\n    let alternative = null;\n\n    if (this.actor.grab(this.targetPos)) {\n      this.actor.energy -= this.energyCost;\n      success = true;\n\n      // add particles\n      this.addParticle(\n        2,\n        { ...this.targetPos },\n        { x: 0, y: 0 },\n        Constant.PARTICLE_TEMPLATES.succede.renderer,\n      )\n\n      SOUNDS.grab_0.play();\n    }\n\n    return {\n      success,\n      alternative,\n    }\n  }\n};\n\nexport class ReleaseGrab extends Base {\n  constructor({ ...args }) {\n    super({ ...args });\n  }\n\n  perform() {\n    let success = false;\n    let alternative = null;\n\n    const releasedEntity = this.actor.release()\n    \n    if (releasedEntity) {\n      this.actor.energy -= this.energyCost;\n      // add particles\n      this.addParticle(\n        2,\n        { ...releasedEntity.pos },\n        { x: 0, y: 0 },\n        Constant.PARTICLE_TEMPLATES.succede.renderer,\n      )\n      success = true;\n      SOUNDS.release_0.play();\n    };\n\n    return {\n      success,\n      alternative,\n    }\n  }\n};\n\nexport class Tackle extends MoveMultiple {\n  constructor({ direction, stepCount, additionalAttackDamage = 0, processDelay = 25, ...args}) {\n    super({...args});\n    this.direction = direction;\n    this.stepCount = stepCount;\n    this.additionalAttackDamage = additionalAttackDamage;\n    this.processDelay = processDelay;\n  }\n  perform() {\n    let success = false;\n    let alternative = null;\n    let newX = this.actor.pos.x + this.direction[0];\n    let newY = this.actor.pos.y + this.direction[1];\n    let targetPos = { x: newX, y: newY };\n    \n    if (this.stepCount > 0 && this.actor.shove(targetPos, this.direction)) {\n      this.stepCount -= 1;\n      this.actor.energy -= this.energyCost;\n      this.actor.setNextAction(this);\n      for (let i = 0; i < 3; i++) {\n        this.addParticle(\n          1,\n          {\n            x: this.actor.pos.x - (this.direction[0] * i),\n            y: this.actor.pos.y - (this.direction[1] * i),\n          },\n          { x: 0, y: 0 }\n        )\n      }\n      success = true;\n    } else {\n      success = true;\n      this.actor.attack(targetPos, this.additionalAttackDamage);\n    }\n\n    return {\n      success,\n      alternative,\n    }\n  }\n};\n\nexport class Attack extends Base {\n  constructor({ targetPos, processDelay = 100, ...args}) {\n    super({...args});\n    this.targetPos = targetPos\n    this.processDelay = processDelay\n    this.particleTemplate = Constant.PARTICLE_TEMPLATES.damage\n  }\n  perform() {\n    let success = false;\n    let alternative = null;\n    \n    if (!this.actor.entityTypes.includes('ATTACKING')) { \n      return { \n        success: true, \n        alternative: new Action.Say({\n          message: `Ooh I don\\'t know how to attack`,\n          game: this.game,\n          actor: this.actor,\n        }),\n      } \n    }\n    \n    success = this.actor.attack(this.targetPos);\n    if (success) {\n      const sound = Helper.getRandomInArray([SOUNDS.chop_0, SOUNDS.chop_1])\n      sound.play();\n      this.addParticle(1, {...this.targetPos}, {x: 0, y:0})\n      this.actor.energy -= this.energyCost;\n    }\n\n    return {\n      success,\n      alternative,\n    }\n  }\n};\n\nexport class SelfDestructiveAttack extends Attack {\n  constructor({ damageToSelf, ...args }) {\n    super({ ...args });\n    this.damageToSelf = damageToSelf\n    this.onSuccess = () => {\n      console.log('Self destruct success');\n      this.actor.decreaseDurabilityWithoutDefense(damageToSelf)\n    }\n    this.onFailure = () => {\n      console.log('Self destruct fails');\n      this.actor.destroy()\n    }\n  }\n}\n\nexport class MultiTargetAttack extends Base {\n  constructor({ targetPositions, processDelay = 25, ...args }) {\n    super({ ...args });\n    this.targetPositions = targetPositions\n    this.processDelay = processDelay\n  }\n\n  perform() {\n    let success = false;\n    let alternative = null;\n    \n    if (!this.actor.entityTypes.includes('ATTACKING')) {\n      return {\n        success: true,\n        alternative: new Action.Say({\n          message: `Ooh I don\\'t know how to attack`,\n          game: this.game,\n          actor: this.actor,\n        }),\n      }\n    }\n\n    let particlePath = [];\n    let particlePos = { x: this.actor.pos.x, y: this.actor.pos.y };\n    let renderer = this.particleTemplate.renderer;\n    this.targetPositions.forEach((targetPos) => {\n      let attackSuccess = this.actor.attack(targetPos);\n      particlePath.push(targetPos);\n      if (attackSuccess) success = true\n    })\n    this.addParticle(\n      particlePath.length + 1, \n      particlePos, \n      null, \n      renderer, \n      Constant.PARTICLE_TYPE.path, \n      particlePath\n    )\n    \n    if (success) { \n      this.actor.energy -= this.energyCost; \n    }\n\n    return {\n      success,\n      alternative,\n    }\n  }\n};\n\nexport class ThrowProjectile extends Move {\n  constructor({ ...args }) {\n    super({ ...args });\n  }\n\n  perform () {\n    let success = false;\n    let alternative = null;\n    this.actor.passable = false;\n    let move_result = super.perform();\n\n    if (move_result.success) {\n      this.actor.path.shift();\n      success = true;\n    }\n    if (this.actor.path.length === 0) {\n      success = true;\n      alternative = new Action.DestroySelf({\n        game: this.game,\n        actor: this.actor,\n        energyCost: Constant.ENERGY_THRESHOLD,\n        processDelay: 0,\n      });\n    }\n    if (move_result.alternative) {\n      let attackSuccess = this.actor.attack(this.targetPos);\n      if (attackSuccess) {\n        alternative = new Action.DestroySelf({\n          game: this.game,\n          actor: this.actor,\n          energyCost: Constant.ENERGY_THRESHOLD,\n          processDelay: 0,\n        });\n      }\n    }\n\n    return {\n      success,\n      alternative,\n    }\n  }\n}\n\nexport class ThrowProjectileGas extends Move {\n  constructor({ ...args }) {\n    super({ ...args });\n    this.processDelay = 0\n  }\n\n  perform () {\n    let success = false;\n    let alternative = null;\n    this.actor.passable = false;\n    let move_result = super.perform();\n    if (move_result.success) {\n      this.actor.path.shift();\n      success = true;\n    } \n    if (this.actor.path.length === 0) {\n      success = true;\n      alternative = new Action.DestroySelf({\n        game: this.game,\n        actor: this.actor,\n        energyCost: Constant.ENERGY_THRESHOLD,\n        processDelay: 0,\n      });\n    }\n    if (move_result.alternative) {\n      this.actor.attack(this.targetPos)\n    }\n\n    return {\n      success,\n      alternative,\n    }\n  }\n}\n\nexport class CrankEngine extends Base {\n  constructor({ engine, ...args }) {\n    super({ ...args });\n    this.engine = engine;\n  }\n  async perform() {\n    let success = true;\n    let alternative = null;\n\n    console.log(`${this.actor.name} is cranking its engine.`);\n    try {\n      await this.engine.start();\n      this.actor.energy -= this.energyCost;\n    } catch (error) {\n      console.log('CrankEngine');\n      console.log(error);\n      alternative = new Action.DestroySelf({\n        game: this.game,\n        actor: this.actor,\n        energyCost: Constant.ENERGY_THRESHOLD,\n      });\n    }\n    \n    return {\n      success,\n      alternative,\n    }\n  }\n};\n","import uuid from 'uuid/v1';\nimport pipe from 'lodash/fp/pipe';\nimport * as Helper from '../helper';\nimport { destroyEntity } from './Entities/helper';\nimport * as Constant from './constants';\nimport * as Action from './actions';\nimport * as Engine from './engine';\nimport { cloneDeep, cloneDeepWith } from 'lodash';\nimport { MESSAGE_TYPE } from './message';\nimport SOUNDS from './sounds';\n\nexport class Entity {\n  constructor({ game = null, passable = false, name = 'nameless'}) {\n    let id = uuid();\n    this.entityTypes = ['Entity']\n    this.id = id;\n    this.name = name;\n    this.game = game;\n    this.passable = passable;\n    this.active = true;\n  }\n}\n\nconst Parent = superclass => class extends superclass {\n  constructor({ children = [], engine = new Engine.CrankEngine({}), ...args }) {\n    super({...args })\n    this.entityTypes = this.entityTypes.concat('PARENT');\n    this.children = children;\n    this.engine = engine;\n    this.isInitialized = false;\n  }\n\n  destroyChild(child) {\n    child.energy = 0;\n    let tile = this.game.map[Helper.coordsToString(child.pos)];\n    this.game.map[Helper.coordsToString(child.pos)].entities = tile.entities.filter((e) => e.id !== child.id);\n    this.engine.actors = this.engine.actors.filter((e) => e.id !== child.id);\n    this.game.draw()\n  }\n\n  canAttack (entity) {\n    const childIds = this.children.map((child) => child.id); \n    return !childIds.includes(entity.id)\n  }\n  \n  initialize() {\n    this.isInitialized = true;\n    this.engine.game = this.game;\n    this.engine.actors = this.children;\n    this.engine.actors.forEach((actor) => {\n      actor.game = this.game;\n      actor.destroy = () => {this.destroyChild(actor)};\n      actor.canAttack = this.canAttack.bind(this);\n      // actor.canAttack = (entity) => {this.canAttack(entity)};\n      this.game.placeActorOnMap(actor)\n      this.engine.addActor(actor);\n      this.game.draw();\n    });\n  }\n\n  getAction(game) {\n    // crank engine one turn\n    if (!this.isInitialized) {\n      this.initialize()\n    }\n\n    let result = new Action.CrankEngine({\n      game,\n      actor: this,\n      engine: this.engine,\n      energyCost: Constant.ENERGY_THRESHOLD,\n      processDelay: 10\n    });\n\n    return result;\n  }\n\n}\n\nconst HasInnerGates = superclass => class extends superclass {\n  constructor({ currentGate = null, gates = [], ...args }) {\n    super({ ...args })\n    this.entityTypes = this.entityTypes.concat('HAS_INNER_GATES');\n    this.currentGate = currentGate;\n    this.gates = [\n      {\n        name: 'Gate of Opening',\n        damageBuff: 1,\n        speedBuff: 100,\n        durabilityDebuff: 1,\n        character: '1'\n      },\n      {\n        name: 'Gate of Healing',\n        damageBuff: 1,\n        speedBuff: 100,\n        durabilityDebuff: 1,\n        character: '2'\n      },\n      {\n        name: 'Gate of Life',\n        damageBuff: 1,\n        speedBuff: 100,\n        durabilityDebuff: 1,\n        character: '3'\n      },\n      {\n        name: 'Gate of Pain',\n        damageBuff: 1,\n        speedBuff: 100,\n        durabilityDebuff: 1,\n        character: '4'\n      },\n      {\n        name: 'Gate of Limit',\n        damageBuff: 1,\n        speedBuff: 100,\n        durabilityDebuff: 1,\n        character: '5'\n      },\n    ];\n  }\n\n  setNextGate() {\n    let currentGate = this.currentGate;\n    let nextGate = null;\n    if (!currentGate) {\n      nextGate = this.gates[0];\n      this.currentGate = { ...nextGate };\n    } else {\n      let nextGateIndex = this.gates.findIndex((gate) => currentGate.name === gate.name) + 1;\n      if (this.gates.length > nextGateIndex) {\n        nextGate = this.gates[nextGateIndex];\n        this.currentGate = { ...nextGate };\n      }\n    }\n    return nextGate;\n  }\n\n  getNextGate() {\n    let currentGate = this.currentGate;\n    let nextGate = null;\n    if (!currentGate) {\n      nextGate = this.gates[0];\n    } else {\n      let nextGateIndex = this.gates.findIndex((gate) => currentGate.name === gate.name) + 1;\n      if (this.gates.length > nextGateIndex) {\n        nextGate = this.gates[nextGateIndex];\n      }\n    }\n    return nextGate;\n  }\n}\n\nconst UI = superclass => class extends superclass {\n  constructor({ initiatedBy = null, range = null, ...args }) {\n    super({...args })\n    this.entityTypes = this.entityTypes.concat('UI');\n    this.initiatedBy = initiatedBy;\n    this.active = true;\n    this.range = range;\n  }\n\n  hasEnoughEnergy() {\n    return this.active;\n  }\n}\n\nexport const Attacking = superclass => class extends superclass {\n  constructor({attackDamage = 1, ...args }) {\n    super({ ...args })\n    this.entityTypes = this.entityTypes.concat('ATTACKING')\n    this.attackDamage = attackDamage;\n  }\n\n  getAttackDamage (additional = 0) {\n    return this.attackDamage + additional;\n  }\n\n  canAttack (entity) {\n    return true;\n  }\n\n  attack (targetPos, additional = 0) {\n    let success = false;\n    let tile = this.game.map[Helper.coordsToString(targetPos)]\n    if (!tile) { return success }\n    let targets = Helper.getDestructableEntities(tile.entities);\n    if (targets.length > 0) {\n      let target = targets[0];\n      if (this.canAttack(target)) {\n        let damage = this.getAttackDamage(additional);\n        if (this.entityTypes.includes('EQUIPING')) {\n          this.equipment.forEach((slot) => {\n            if (slot.item) {\n              if (slot.item.entityTypes.includes('ATTACKING')) {\n                damage += slot.item.getAttackDamage();\n              }\n            }\n          });\n        }\n        this.game.addMessage(`${this.name} does ${damage} to ${target.name}`, MESSAGE_TYPE.DANGER);\n        target.decreaseDurability(damage);\n        success = true;\n      }\n    }\n\n    return success;\n  }\n}\n\nexport const Equipable = superclass => class extends superclass {\n  constructor({name = 'nameless', equipmentType = Constant.EQUIPMENT_TYPES.HAND, ...args }) {\n    super({ ...args })\n    this.entityTypes = this.entityTypes.concat('EQUIPABLE')\n    this.name = name;\n    this.equipmentType = equipmentType;\n  }\n}\n\nconst Acting = superclass => class extends superclass {\n  constructor({actions = [], speed = 100, energy = 0, ...args}) {\n    super({...args})\n    this.entityTypes = this.entityTypes.concat('ACTING')\n    this.actions = actions;\n    this.speed = speed;\n    this.energy = speed;\n  }\n\n  getAction() {\n    let action = Helper.getRandomInArray(this.actions)\n    if (action) { return action }\n  }\n\n  gainEnergy(value = this.speed) {\n    this.energy += value;\n  }\n\n  hasEnoughEnergy() {\n    return this.energy > 0;\n  }\n}\n\nconst Rendering = superclass => class extends superclass {\n  constructor({pos = {x: 0, y: 0}, renderer, ...args}) {\n    super({...args})\n    this.entityTypes = this.entityTypes.concat('RENDERING')\n    this.pos = pos;\n    this.renderer = {...renderer};\n    this.currentFrame = 0;\n  }\n\n  getPosition () {\n    return this.pos;\n  }\n\n  move (targetPos) {\n    let success = false;\n    if (this.game.canOccupyPosition(targetPos, this)) {\n      let tile = this.game.map[Helper.coordsToString(this.pos)]\n      this.game.map[Helper.coordsToString(this.pos)] = { ...tile, entities: tile.entities.filter((e) => e.id !== this.id) }\n      this.pos = targetPos\n      this.game.map[Helper.coordsToString(targetPos)].entities.push(this);\n      success = true;\n    }\n    return success;\n  }\n\n  shove (targetPos, direction) {\n    let success = false;\n    let targetTile = this.game.map[Helper.coordsToString(targetPos)];\n    if (targetTile) {\n      targetTile.entities.map((entity) => { \n        if(entity.entityTypes.includes('PUSHABLE')){\n          if (!entity.passable && entity.pushable) {\n            let newX = entity.pos.x + direction[0];\n            let newY = entity.pos.y + direction[1];\n            let newPos = { x: newX, y: newY };\n            entity.move(newPos);\n          }\n        }\n      });\n    }\n    success = this.move(targetPos);\n    return success;\n  }\n}\n\nexport class ContainerSlot {\n  constructor({ itemType, items }) {\n    this.itemType = itemType;\n    this.items = items;\n  }\n}\n\nconst Containing = superclass => class extends superclass {\n  constructor({container = [], ...args}) {\n    super({...args})\n    this.entityTypes = this.entityTypes.concat('CONTAINING')\n    this.container = container;\n  }\n\n  createSlot (item) {\n    let slot = new ContainerSlot({\n      itemType: item.name,\n      items: [item],\n    });\n    this.container.push(slot)\n  }\n\n  contains (itemType) {\n    let container = this.container;\n    let slots = container.filter((slot) => slot.itemType === itemType);\n    return slots.length > 0 ? slots[0].items[0] : false;\n  }\n\n  addToContainer (item) {\n    const index = this.container.findIndex((slot) => slot.itemType === item.name);\n    if (index >= 0) {\n      this.container[index].items.push(item);\n    } else {\n      this.createSlot(item);\n    }\n  }\n  \n  removeFromContainer (item) {\n    this.container.forEach((slot, index) => {\n      slot.items = slot.items.filter((it) => it.id !== item.id);\n      if (!slot.items.length) this.container.splice(index, 1);\n    });\n  }\n}\n\nconst Equiping = superclass => class extends superclass {\n  constructor({equipment = Constant.EQUIPMENT_LAYOUTS.human(), ...args}) {\n    super({...args})\n    this.entityTypes = this.entityTypes.concat('EQUIPING')\n    this.equipment = equipment;\n  }\n\n  hasItemNameEquipped (itemName) {\n    const equipment = this.equipment.filter((slot) => {\n      if (slot.item) {\n        if (slot.item.name === itemName) {\n          return true;\n        }\n      }\n      return false;\n    })\n\n    return equipment.length > 0;\n\n  }\n\n  getItemInSlot (slotName) {\n    let openSlots = this.equipment.filter((slot) => {\n      return (slot.item === null && slot.type === slotName)\n    })\n    if (openSlots.length > 0) { return false; }\n    let slot = this.equipment.find((slot) => slot.type === slotName);\n    if (!slot) { return false; }\n    if (!slot.item) { return false; }\n    return slot.item;\n  }\n\n  equip (slotName, item) {\n    let foundSlot = false;\n    this.equipment = this.equipment.map((slot) => {\n      if (!foundSlot && slot.type === slotName && slot.item === null) {\n        slot.item = item;\n        foundSlot = true;\n        SOUNDS.equip_1.play();\n      }\n      return slot;\n    })\n    return foundSlot;\n  }\n  \n  unequip (item) {\n    this.equipment = this.equipment.map((slot) => {\n      if (slot.item) {\n        if (slot.item.id === item.id) {\n          slot.item = null;\n          SOUNDS.equip_0.play();\n        }\n      }\n      return slot;\n    })\n  }\n}\n\nconst Charging = superclass => class extends superclass {\n  constructor({charge = 10, ...args}) {\n    super({...args})\n    this.entityTypes = this.entityTypes.concat('CHARGING')\n    this.charge = charge;\n    this.chargeMax = charge;\n  }\n\n  decreaseCharge(value) {\n    this.charge = Math.max(0, this.charge - value);\n  }\n  \n  increaseCharge(value) {\n    this.charge = Math.min(this.chargeMax, this.charge + value);\n  }\n}\n\nconst Signing = superclass => class extends superclass {\n  constructor({...args}) {\n    super({...args})\n    this.entityTypes = this.entityTypes.concat('SIGNING')\n    this.signHistory = [];\n  }\n\n  addSign(sign) {\n    if (this.signHistory.length >= 4) {\n      this.signHistory.shift();\n    }\n    this.signHistory.push(sign);\n  }\n  \n  clearSigns() {\n    this.signHistory = [];\n  }\n}\n\nconst Playing = superclass => class extends superclass {\n  constructor({keymap = {}, ...args}) {\n    super({...args})\n    this.entityTypes = this.entityTypes.concat('PLAYING')\n    this.nextAction = null;\n    this.keymap = keymap;\n  }\n\n    setNextAction(action) {\n      this.nextAction = action;\n    }\n\n    getAction() {\n      let action = this.nextAction;\n      this.nextAction = null;\n      return action;\n    }\n}\n\nconst Cloning = superclass => class extends superclass {\n  constructor({cloneLimit = 1, ...args}) {\n    super({...args})\n    this.entityTypes = this.entityTypes.concat('CLONING')\n    this.cloneLimit = cloneLimit;\n    this.clones = [];\n  }\n  \n  // perhaps clones should have a status effect that leeches parent actor's energy or chakra\n  \n  // status effects should be removed from engine when owner is removed.\n  \n  destroy() {\n    // add function to override self destroy funtion \n    // if this actor dies, clones should be destroyed as well\n    if (this.clones) {\n      this.clones.map((clone) => {\n        destroyEntity(clone)\n      });\n    }\n    destroyEntity(this);\n  }\n\n  destroyClone (id) {\n  // overrides clone destroy function\n  // when clone is destroyed, clone count will change accordingly\n    const index = this.clones.findIndex((c) => c.id == id);\n    if (index >= 0) {\n      this.clones[index].super__destroy();\n      this.clones.splice(index, 1);\n    }\n  }\n\n  createClone (cloneArgs) {\n    if (this.clones.length < this.cloneLimit) {\n      let clone = cloneDeep(this);\n      clone.name = `Clone`\n      clone.game = this.game;\n      clone.id = uuid();\n      delete clone.clones;\n      clone['super__destroy'] = clone.destroy;\n      clone.destroy = () => { this.destroyClone(clone.id) };\n      cloneArgs.forEach((arg) => {\n        clone[arg.attribute] = arg.value\n      });\n      if (this.game.placeActorOnMap(clone)) {\n        this.game.engine.addActorAsNext(clone);\n        this.game.draw();\n        this.clones.push(clone);\n        return true;\n      };\n    }\n    return false;\n  }\n}\n\nconst Projecting = superclass => class extends superclass {\n  constructor({path = false, targetPos = null ,...args}) {\n    super({...args})\n    this.entityTypes = this.entityTypes.concat('PROJECTING')\n    this.path = path;\n    this.targetPos = targetPos;\n  }\n\n  createPath (game) {\n    let path = Helper.calculatePath(game, this.targetPos, this.pos, 8);\n    this.path = path;\n  }\n\n  getAction(game) {\n    if (!this.path) {\n      this.createPath(game);\n    }\n    let targetPos = this.path.length > 0 ? this.path[0] : this.pos;\n    let result = new Action.Move({\n      targetPos, \n      game, \n      actor: this, \n      energyCost: Constant.ENERGY_THRESHOLD\n    });\n    if (this.game.canOccupyPosition(targetPos, this)) {\n      this.path.shift();\n    }\n    return result;\n  }\n}\n\nconst DestructiveProjecting = superclass => class extends superclass {\n  constructor({path = false, targetPos = null, attackDamage = 1, range = 3, ...args}) {\n    super({...args})\n    this.entityTypes = this.entityTypes.concat('DESTRUCTIVE_PROJECTING')\n    this.path = path;\n    this.targetPos = targetPos;\n    this.attackDamage = attackDamage;\n    this.range = range;\n  }\n\n  createPath (game) {\n    let path = Helper.calculatePathWithRange(game, this.targetPos, this.pos, 8, this.range);\n    this.path = path;\n  }\n\n  getAction (game) {\n    if (!this.path) {\n      this.createPath(game);\n    }\n\n    let targetPos = this.path.length > 0 ? this.path[0] : this.pos;\n    \n    let result = new Action.ThrowProjectile({\n      targetPos, \n      game, \n      actor: this, \n      energyCost: Constant.ENERGY_THRESHOLD\n    });\n\n    return result;\n  }\n}\n\nconst DirectionalProjecting = superclass => class extends superclass {\n  constructor({path = false, direction = {x: 0, y: 0}, attackDamage = 1, range = 3, ...args}) {\n    super({...args})\n    this.entityTypes = this.entityTypes.concat('DIRECTIONAL_PROJECTING')\n    this.path = path;\n    this.direction = direction;\n    this.attackDamage = attackDamage;\n    this.range = range;\n  }\n\n  createPath(game) {\n    let path = [];\n    for (let i = 1; i < this.range + 1; i++) {\n      path.push({\n        x: this.pos.x + (this.direction[0] * i),\n        y: this.pos.y + (this.direction[1] * i)\n      })\n    }\n    this.path = path;\n  }\n\n  getAction (game) {\n    let result = null;\n    let newX = this.pos.x + this.direction[0];\n    let newY = this.pos.y + this.direction[1];\n    let targetPos = { x: newX, y: newY };\n    this.passable = false\n    \n    if (this.range > 0) {\n      result = new Action.ProjectileMove({\n        targetPos: targetPos,\n        game: game,\n        actor: this,\n        energyCost: Constant.ENERGY_THRESHOLD,\n        damageToSelf: 1,\n        onSuccess: () => this.range -= 1,\n        onAfter: () => {\n          if (this.energy <= 100) {\n            game.engine.setActorToPrevious();\n          }\n        }\n      })\n    } else {\n      result = new Action.DestroySelf({\n        game: game,\n        actor: this,\n        energyCost: 0\n      })\n    }\n\n    return result;\n  }\n}\n\nconst DirectionalPushing = superclass => class extends superclass {\n  constructor({path = false, direction = {x: 0, y: 0}, range = 3, ...args}) {\n    super({...args})\n    this.entityTypes = this.entityTypes.concat('DIRECTIONAL_PUSHING')\n    this.path = path;\n    this.direction = direction;\n    this.range = range;\n  }\n\n  getAction (game) {\n    let result = null;\n    let newX = this.pos.x + this.direction[0];\n    let newY = this.pos.y + this.direction[1];\n    let targetPos = { x: newX, y: newY };\n    this.passable = false\n    \n    if (this.range > 0) {\n      result = new Action.Shove({\n        targetPos: targetPos,\n        direction: this.direction,\n        game: game,\n        actor: this,\n        energyCost: Constant.ENERGY_THRESHOLD,\n        onSuccess: () => this.range -= 1,\n      })\n    } else {\n      result = new Action.DestroySelf({\n        game: game,\n        actor: this,\n        energyCost: 0\n      })\n    }\n\n    return result;\n  }\n}\n\nconst GaseousDestructiveProjecting = superclass => class extends superclass {\n  constructor({owner_id = null, path = false, targetPos = null, attackDamage = 1, range = 3, ...args}) {\n    super({...args})\n    this.entityTypes = this.entityTypes.concat('GASEOUS_DESTRUCTIVE_PROJECTING')\n    this.path = path;\n    this.targetPos = targetPos;\n    this.attackDamage = attackDamage;\n    this.range = range;\n    this.owner_id = owner_id;\n  }\n\n  canAttack (entity) {\n    let success = super.canAttack();\n    if (success) {\n      success = this.owner_id === null || (entity.owner_id !== this.owner_id);\n    }\n    return success\n  }\n\n  createPath (game) {\n    let path = Helper.calculatePathWithRange(game, this.targetPos, this.pos, 8, this.range);\n    this.path = path;\n  }\n\n  getAction (game) {\n    if (!this.path) {\n      this.createPath(game);\n    }\n    let targetPos = this.path.length > 0 ? this.path[0] : this.pos;\n    \n    let result = new Action.ThrowProjectileGas({\n      targetPos, \n      game, \n      actor: this, \n      energyCost: Constant.ENERGY_THRESHOLD\n    });\n\n    return result;\n  }\n}\n\nconst Gaseous = superclass => class extends superclass {\n  constructor({\n    isClone = false,\n    cloneCount = 0,\n    clonePattern = Constant.CLONE_PATTERNS.square,\n    ...args\n  }) {\n    super({...args})\n    this.entityTypes = this.entityTypes.concat('GASEOUS')\n    this.isClone = isClone;\n    this.cloneCount = cloneCount;\n    this.clonePattern = cloneDeep(clonePattern);\n  }\n\n  getAction (game) {\n    let offset = this.clonePattern.positions.find((pos) => !pos.taken);\n    if (!this.isClone && offset) {\n      offset.taken = true\n      let clone = cloneDeepWith(this, (value, key) => {\n        switch (key) {\n          case 'id':\n          case 'game':\n          case 'engine':\n          case 'clones':\n            return null\n            break;\n          default:\n            return undefined\n            break;\n        }\n      });\n      clone.game = game;\n      clone.id = uuid();\n      if (this.hasOwnProperty('pos')) {\n        let referencePos = this.pos\n        clone.pos = {\n          x: referencePos.x + offset.x,\n          y: referencePos.y + offset.y\n        }\n      }\n      if (clone.hasOwnProperty('path')) {\n        clone.path = clone.path.map((pos) => {\n          return {\n            x: pos.x + offset.x,\n            y: pos.y + offset.y\n          }\n        })\n      }\n      clone.isClone = true\n      this.cloneCount += 1\n      game.placeActorOnMap(clone)\n      game.engine.addActor(clone);\n      game.draw();\n    }\n\n    let result = super.getAction(game);\n    return result;\n  }\n}\n\nconst Chasing = superclass => class extends superclass {\n  constructor({targetEntity = null ,...args}) {\n    super({...args})\n    this.entityTypes = this.entityTypes.concat('CHASING')\n    this.targetEntity = targetEntity;\n  }\n\n  getAction(game) {\n    let path = Helper.calculatePath(game, this.targetEntity.pos, this.pos);\n    let targetPos = path.length > 0 ? path[0] : this.pos;\n\n    let result = new Action.Move({\n      targetPos, \n      game, \n      actor: this, \n      energyCost: Constant.ENERGY_THRESHOLD\n    });\n    return result;\n  }\n}\n\nconst RangedChasing = superclass => class extends superclass {\n  constructor({ targetEntity = null, getProjectile = () => null, ...args }) {\n    super({ ...args })\n    this.entityTypes = this.entityTypes.concat('RANGED_CHASING')\n    this.targetEntity = targetEntity;\n    this.getProjectile = getProjectile;\n  }\n\n  targetInPath (pathToCheck, targetPos) {\n    let inPath = false;\n    pathToCheck.forEach((pos) => {\n      if (pos.x === targetPos.x && pos.y === targetPos.y) {\n        inPath = true;\n      }\n    })\n    return inPath;\n  }\n\n  getAction(game) {\n    let throwDirection = {\n      x: Math.sign(this.targetEntity.pos.x - this.pos.x),\n      y: Math.sign(this.targetEntity.pos.y - this.pos.y),\n    }\n\n    // projectile.initialize()\n    let projectile = this.getProjectile({\n      pos: {\n        x: this.pos.x,\n        y: this.pos.y,\n      },\n      targetPos: { ...this.targetEntity.pos },\n      direction: [throwDirection.x, throwDirection.y],\n      range: 10,\n    });\n\n    // projectile.getPath()\n    projectile.createPath(game);\n    // is target in path\n    const inPath = this.targetInPath(projectile.path, this.targetEntity.pos);\n\n    if (inPath) {\n      // throw\n      if (game.canOccupyPosition(projectile.pos, projectile)) {\n        return new Action.PlaceActor({\n          targetPos: { ...projectile.pos },\n          entity: projectile,\n          game,\n          actor: this,\n          energyCost: Constant.ENERGY_THRESHOLD\n        })\n      }\n      return new Action.Say({\n        message: `I'll get you with this kunai!`,\n        game,\n        actor: this,\n        energyCost: Constant.ENERGY_THRESHOLD\n      })\n    }\n    // if not, select target tile in range of enemy and move\n    let movePath = Helper.calculatePath(game, this.targetEntity.pos, this.pos);\n    let targetPos = movePath.length > 0 ? movePath[0] : this.pos;\n    \n    return new Action.Move({\n      targetPos,\n      game,\n      actor: this,\n      energyCost: Constant.ENERGY_THRESHOLD\n    });\n\n  }\n}\n\nconst Dragging = superclass => class extends superclass {\n  constructor({ draggedEntity = null, ...args }) {\n    super({ ...args })\n    this.entityTypes = this.entityTypes.concat('DRAGGING')\n    this.draggedEntity = draggedEntity;\n  }\n\n  grab (pos) {\n    const tile = this.game.map[Helper.coordsToString(pos)];\n    if (!tile) return false;\n    if (tile.entities.length > 0) {\n      const entity = tile.entities[0];\n      if(entity.entityTypes.includes('DRAGGABLE'))\n        if (!this.draggedEntity && entity.draggable === true) {\n          this.draggedEntity = entity;\n          return true;\n        }\n      \n    }\n    return false;\n  }\n\n  release () {\n    if (!this.draggedEntity) return false;\n    const draggedEntity = {...this.draggedEntity};\n    this.draggedEntity = null;\n    return draggedEntity;\n  }\n\n  drag (lastPos) {\n    // update entity position\n    const pos = this.draggedEntity.pos;\n    // get tile of draged entity\n    let tile = this.game.map[Helper.coordsToString(pos)]\n    // remove dragged entity from that tile\n    this.game.map[Helper.coordsToString(pos)] = { ...tile, entities: tile.entities.filter((e) => e.id !== this.draggedEntity.id) }\n    // update dragged ent to player's position\n    this.draggedEntity.pos = lastPos\n    // add dragged ent to new tile\n    this.game.map[Helper.coordsToString(lastPos)].entities.push(this.draggedEntity);\n  }\n\n  move (targetPos) {\n    const lastPos = {...this.pos}\n    if (this.draggedEntity) {\n      const moveSuccess = super.move(targetPos);\n      if (moveSuccess) {\n        this.drag(lastPos);\n        return true;\n      }\n      return moveSuccess;\n    }\n    return super.move(targetPos);\n  }\n}\n\nconst Draggable = superclass => class extends superclass {\n  constructor({draggable = true, ...args }) {\n    super({ ...args })\n    this.draggable = draggable\n    this.entityTypes = this.entityTypes.concat('DRAGGABLE')\n  }\n}\nconst Pushable = superclass => class extends superclass {\n  constructor({pushable = true, ...args}) {\n    super({ ...args })\n    this.pushable = pushable\n    this.entityTypes = this.entityTypes.concat('PUSHABLE')\n  }\n}\n\nconst Spreading = superclass => class extends superclass {\n  constructor({ timeToSpread = 5, spreadCount = 1, ...args }) {\n    super({ ...args })\n    this.entityTypes = this.entityTypes.concat('SPREADING')\n    this.timeToSpreadMax = timeToSpread;\n    this.timeToSpread = timeToSpread;\n    this.spreadCountMax = spreadCount;\n    this.spreadCount = spreadCount;\n  }\n\n  getAction (game) {\n    // if no more spreads, then destroy\n    if (this.spreadCount <= 0) {\n      return new Action.DestroySelf({\n        game: game,\n        actor: this,\n        energyCost: Constant.ENERGY_THRESHOLD,\n        processDelay: 0,\n        onAfter: () => {\n          game.map[Helper.coordsToString(this.pos)].type = 'BURNT';\n        },\n      });\n    }\n\n    // if its time to expand again, create a new fire spread and placeActor\n    if (this.timeToSpread <= 0) {\n      // find adjacent spot to spread to\n      let adjacentPositions = [\n        {\n          x: this.pos.x + 1,\n          y: this.pos.y + 0,\n        },\n        {\n          x: this.pos.x + -1,\n          y: this.pos.y + 0,\n        },\n        {\n          x: this.pos.x + 0,\n          y: this.pos.y + 1,\n        },\n        {\n          x: this.pos.x + 0,\n          y: this.pos.y + -1,\n        },\n      ];\n      let adjacentPos = null;\n      let kill = 100;\n      while (kill > 0) {\n        let newPos = Helper.getRandomInArray(adjacentPositions);\n        let newTile = this.game.map[Helper.coordsToString(newPos)];\n        let tileExists = Boolean(newTile);\n        let notBurnt = true;\n        let canBurn = false;\n        if (newTile) {\n          notBurnt = newTile.type !== 'BURNT';\n          canBurn = ['WALL', 'FLOOR', 'DOOR'].includes(newTile.type)\n        }\n        if (tileExists && notBurnt && canBurn) {\n          adjacentPos = newPos;\n          break;\n        }\n        kill -= 1;\n      }\n      \n      if (adjacentPos) {\n        // create new fire actor and place\n        let fire = new FireSpread({\n          name: 'Pyro',\n          pos: {x: 0, y: 0},\n          game,\n          renderer: {\n            character: '*',\n            sprite: '',\n            color: Constant.THEMES.SOLARIZED.base3,\n            background: Constant.THEMES.SOLARIZED.red,\n          },\n          timeToSpread: this.timeToSpreadMax,\n          spreadCount: this.spreadCountMax,\n          durability: this.durability,\n          attackDamage: this.attackDamage,\n          speed: this.speed,\n        })\n\n        this.timeToSpread = this.timeToSpreadMax\n        this.spreadCount -= 1\n        \n        return new Action.PlaceActor({\n          targetPos: adjacentPos,\n          entity: fire,\n          game,\n          actor: this,\n          interrupt: false,\n          energyCost: Constant.ENERGY_THRESHOLD,\n          processDelay: 0,\n          forcePlacement: true,\n        })\n      }\n      this.timeToSpread = this.timeToSpreadMax\n      this.spreadCount -= 1\n    }\n\n    this.timeToSpread -= 1;\n    \n    return new Action.Say({\n      message: 'burning',\n      game,\n      actor: this,\n      processDelay: 0,\n    })\n  }\n}\n\n  const Pushing = superclass => class extends superclass {\n  constructor({ path = false, targetPos = null, ...args }) {\n    super({ ...args })\n    this.entityTypes = this.entityTypes.concat('PUSHING')\n    this.path = path;\n    this.targetPos = targetPos;\n  }\n\n  createPath(game) {\n    let path = Helper.calculatePath(game, this.targetPos, this.pos, 8);\n    this.path = path;\n  }\n\n  getAction(game) {\n    if (!this.path) {\n      this.createPath(game);\n    }\n    let targetPos = this.path.length > 0 ? this.path[0] : this.pos;\n    let direction = [\n      targetPos.x - this.pos.x ,\n      targetPos.y - this.pos.y ,\n    ]\n    if (direction[0] === 0 && direction[1] === 0) {\n      return new Action.DestroySelf({\n        game: game,\n        actor: this,\n        energyCost: Constant.ENERGY_THRESHOLD,\n        processDelay: 0,\n      });\n    }\n    let result = new Action.Shove({\n      targetPos,\n      direction,\n      game,\n      actor: this,\n      energyCost: Constant.ENERGY_THRESHOLD\n    });\n    this.path.shift();\n\n    return result;\n  }\n}\n\nconst Destructable = superclass => class extends superclass {\n  constructor({durability = 1, defense = 0 ,onDestroy = () => null, ...args }) {\n    super({ ...args })\n    this.entityTypes = this.entityTypes.concat('DESTRUCTABLE')\n    this.durability = durability;\n    this.defense = defense;\n    this.onDestroy = onDestroy;\n  }\n\n  getDefense () {\n    let defense = this.defense;\n    // add in reducer to get defense stats of all equpiment\n    if (this.entityTypes.includes('EQUIPING')) {\n      this.equipment.forEach((slot) => {\n        if (slot.item) {\n          if (slot.item.entityTypes.includes('DESTRUCTABLE')) {\n            defense += slot.item.getDefense();\n          }\n        }\n      });\n    }\n    \n    return defense;\n  }\n\n  decreaseDurabilityWithoutDefense (value) {\n    this.durability -= value;\n    if (this.durability <= 0) {\n      this.destroy();\n    }\n  }\n\n  decreaseDurability (value) {\n    const current = this.durability;\n    const newDurability = current - (value - this.getDefense());\n    this.durability = Math.min(current, newDurability);\n    this.renderer.character = this.durability;\n    this.game.draw()\n    if (this.durability <= 0) {\n      this.destroy();\n    }\n  }\n\n  increaseDurability (value) {\n    this.durability += value\n  }\n\n  destroy () {\n    this.onDestroy();\n    destroyEntity(this);\n  }\n}\n\nconst IsParticle = superclass => class extends superclass {\n  constructor({\n    pos = { x: 1, y: 1 },\n    direction = { x: 0, y: 0 },\n    life = 1,\n    speed = 1,\n    type = Constant.PARTICLE_TYPE.directional,\n    path = null,\n    ...args\n  }) {\n    super({ ...args })\n    this.pos = pos;\n    this.direction = direction;\n    this.life = life;\n    this.speed = speed;\n    this.type = type;\n    this.path = path;\n    this.entityTypes = this.entityTypes.concat('PARTICLE')\n  }\n\n  getNextPos(step) {\n    switch (this.type) {\n      case Constant.PARTICLE_TYPE.directional:\n        return {\n          x: this.pos.x + (this.direction.x * this.speed) * step,\n          y: this.pos.y + (this.direction.y * this.speed) * step,\n        }\n      case Constant.PARTICLE_TYPE.path:\n        const nextPos = this.path.shift();\n        return nextPos ? {...nextPos} : {...this.pos}\n    }\n  }\n\n  update(step) {\n    this.life -= step;\n    if (this.life > 0) {\n      this.pos = this.getNextPos(step);\n    }\n  }\n}\n\nconst Speaking = superclass => class extends superclass {\n  constructor({ messages = ['I have nothing to say.'], messageType, ...args }) {\n    super({ ...args })\n    this.entityTypes = this.entityTypes.concat('SPEAKING')\n    this.messages = messages;\n    this.messageType = messageType\n  }\n\n  getAction (game) {\n    const message = this.messages.shift();\n    this.messages.push(message);\n    return new Action.Say({\n      actor: this,\n      game,\n      message: message,\n      messageType: this.messageType,\n      processDelay: 0,\n    });\n  }\n}\n\nconst Burnable = superclass => class extends superclass {\n  constructor({ ...args }) {\n    super({ ...args })\n    this.entityTypes = this.entityTypes.concat('BURNABLE')\n    this.canBurn = true;\n    this.willResetCanBurn = false;\n  }\n\n  resetCanBurn () {\n    this.willResetCanBurn = false;\n    this.canBurn = true;\n  }\n\n  burn () {\n    if (this.canBurn) {\n      this.decreaseDurability(2)\n      return true;\n    }\n    return false;\n  }\n}\n\nconst Exploding = superclass => class extends superclass {\n  constructor({ flammability = 1, explosivity = 1, ...args }) {\n    super({ ...args })\n    this.entityTypes = this.entityTypes.concat('EXPLODING')\n    this.flammability = flammability;\n    this.explosivity = explosivity;\n  }\n\n  enflame () {\n    // create num of fireSpreads\n    const fires = Array(this.flammability).fill('').map((item) => {\n      return new FireSpread({\n        name: 'Pyro',\n        pos: { ...this.pos },\n        game: this.game,\n        renderer: {\n          character: '*',\n          color: Constant.THEMES.SOLARIZED.base3,\n          background: Constant.THEMES.SOLARIZED.red,\n        },\n        timeToSpread: 1,\n        spreadCount: 1,\n        durability: 1,\n        attackDamage: 1,\n        speed: 100,\n      })\n    })\n\n    fires.forEach((fire) => {\n      // add them to map\n      this.game.placeActorOnMap(fire);\n      // add them to engine\n      this.game.engine.addActor(fire)\n    })\n  }\n\n  explode () {\n    let structure = {\n      x_offset: 0,\n      y_offset: 0,\n      positions: Array(this.explosivity).fill('').reduce((acc, curr, i) => {\n        return acc.concat(...Helper.getPointsOnCircumference(0, 0, i + 1))\n      }, [])\n    };\n\n    structure.positions.forEach((slot) => {\n      let position = {\n        x: this.pos.x + slot.x + structure.x_offset,\n        y: this.pos.y + slot.y + structure.y_offset\n      }\n      const tile = this.game.map[Helper.coordsToString(position)];\n      if (tile) tile.type = 'BURNT';\n    });\n\n    if (this.explosivity > 0) SOUNDS.explosion_0.play();\n\n    // this.game.draw(); //may not need draw here\n  }\n\n  destroy () {\n    this.enflame();\n    this.explode();\n    super.destroy();\n  }\n}\n\nconst Helpless = superclass => class extends superclass {\n  constructor({ ...args }) {\n    super({ ...args })\n    this.entityTypes = this.entityTypes.concat('HELPLESS');\n    this.saved = false;\n  }\n\n  save () {\n    this.saved = true;\n    SOUNDS.save.play();\n  }\n\n  destroy () {\n    const sound = Helper.getRandomInArray([SOUNDS.scream_0, SOUNDS.scream_1, SOUNDS.scream_2])\n    sound.play();\n    super.destroy();\n  }\n}\n\nexport const UI_Actor = pipe(\n  Acting, \n  Rendering, \n  Playing, \n  UI\n)(Entity);\n\nexport const Actor = pipe(\n  Acting, \n  Rendering\n)(Entity);\n\nexport const Speaker = pipe(\n  Acting,\n  Rendering,\n  Destructable,\n  Speaking,\n  Draggable,\n  Pushable,\n  Burnable,\n  Helpless,\n)(Entity);\n\nexport const Wall = pipe(\n  Rendering,\n  Destructable,\n)(Entity);\n\nexport const Debris = pipe(\n  Rendering,\n  Containing,\n  Draggable,\n  Burnable,\n  Destructable,\n  Exploding,\n  Pushable,\n)(Entity);\n\nexport const MovingWall = pipe(\n  Acting,\n  Rendering,\n  // Pushing,\n  DirectionalPushing,\n  Destructable,\n)(Entity);\n\nexport const Chaser = pipe(\n  Acting, \n  Rendering, \n  Chasing, \n  Destructable\n)(Entity);\n\nexport const Bandit = pipe(\n  Acting, \n  Rendering, \n  Chasing, \n  Destructable,\n  Attacking,\n)(Entity);\n\nexport const RangedBandit = pipe(\n  Acting, \n  Rendering, \n  RangedChasing, \n  Destructable,\n  Attacking,\n)(Entity);\n\nexport const Player = pipe(\n  Acting,\n  Rendering,\n  Dragging,\n  Charging, \n  Signing, \n  Containing, \n  Equiping, \n  Attacking, \n  HasInnerGates,\n  Destructable, \n  Cloning,\n  Playing,\n  Burnable,\n)(Entity);\n\nexport const Weapon = pipe(\n  Rendering, \n  Equipable, \n  Attacking\n)(Entity);\n\nexport const Armor = pipe(\n  Rendering, \n  Equipable, \n  Destructable,\n)(Entity);\n\nexport const DestructiveProjectile = pipe(\n  Acting, \n  Rendering, \n  Attacking, \n  DestructiveProjecting, \n  Destructable\n)(Entity);\n\nexport const DirectionalProjectile = pipe(\n  Acting, \n  Rendering, \n  Attacking, \n  DirectionalProjecting, \n  Destructable\n)(Entity);\n\nexport const DestructiveCloudProjectile = pipe(\n  Acting, \n  Rendering, \n  Attacking, \n  GaseousDestructiveProjecting, \n  Destructable, \n  Gaseous\n)(Entity);\n\nexport const DestructiveCloudProjectileV2 = pipe(\n  Acting, \n  Destructable,\n  Parent, \n)(Entity);\n\nexport const FireSpread = pipe (\n  Acting,\n  Rendering,\n  Destructable,\n  Attacking,\n  Spreading,\n)(Entity);\n\nexport const Particle = pipe(\n  Acting,\n  Rendering,\n  IsParticle,\n)(Entity);\n\nexport const ParticleEmitter = pipe(\n  Acting, \n  Destructable,\n  Parent, \n)(Entity);","import { ALPHABET, DIRECTIONS } from '../constants';\n\nexport const addAlphabeticallyToKeymap = (keymap, obj) => {\n  let alphabetAllowed = ALPHABET.filter((letter) => {\n    return !Object.keys(keymap).includes(letter);\n  });\n  keymap[alphabetAllowed[0]] = obj;\n}\n\nexport const deactivateUIKeymap = (engine, visibleUIKey) => {\n  let currentUiActor = engine.actors[engine.currentActor];\n  engine.game.removeActor(currentUiActor);\n  engine.game[visibleUIKey] = null;\n}\n\nexport const createFourDirectionMoveOptions = (moveFunction, engine, label = 'move', hidden = false) => {\n  return {\n    w: {\n      activate: () => moveFunction(DIRECTIONS.N, engine),\n      label: `${label} N`,\n      hidden,\n    },\n    d: {\n      activate: () => moveFunction(DIRECTIONS.E, engine),\n      label: `${label} E`,\n      hidden,\n    },\n    s: {\n      activate: () => moveFunction(DIRECTIONS.S, engine),\n      label: `${label} S`,\n      hidden,\n    },\n    a: {\n      activate: () => moveFunction(DIRECTIONS.W, engine),\n      label: `${label} W`,\n      hidden,\n    },\n  }\n}\n\nexport const createEightDirectionMoveOptions = (moveFunction, engine, label = 'move') => {\n  return {\n    w: {\n      activate: () => moveFunction(DIRECTIONS.N, engine),\n      label: `${label} N`,\n    },\n    e: {\n      activate: () => moveFunction(DIRECTIONS.NE, engine),\n      label: `${label} NE`,\n    },\n    d: {\n      activate: () => moveFunction(DIRECTIONS.E, engine),\n      label: `${label} E`,\n    },\n    c: {\n      activate: () => moveFunction(DIRECTIONS.SE, engine),\n      label: `${label} SE`,\n    },\n    x: {\n      activate: () => moveFunction(DIRECTIONS.S, engine),\n      label: `${label} S`,\n    },\n    z: {\n      activate: () => moveFunction(DIRECTIONS.SW, engine),\n      label: `${label} SW`,\n    },\n    a: {\n      activate: () => moveFunction(DIRECTIONS.W, engine),\n      label: `${label} W`,\n    },\n    q: {\n      activate: () => moveFunction(DIRECTIONS.NW, engine),\n      label: `${label} NW`,\n    },\n  }\n}","import { UI_Actor } from '../../entites';\nimport { UnequipItem, UnequipItemToTile } from '../../actions';\nimport { addAlphabeticallyToKeymap, deactivateUIKeymap } from '../helper';\n\nconst keymapEquipment = (engine, initiatedBy) => {\n  let keymap = {\n    Escape: {\n      activate: () => deactivateUIKeymap(engine, 'visibleEquipment'),\n      label: 'Close',\n    }\n  };\n\n  initiatedBy.equipment.filter((slot) => slot.item).map((slot) => {\n    let obj = {\n      activate: null,\n      label: ''\n    }\n    obj['activate'] = () => {\n      initiatedBy.setNextAction(new UnequipItemToTile({\n        item: slot.item,\n        game: engine.game,\n        actor: initiatedBy,\n      }))\n      deactivateUIKeymap(engine, 'visibleEquipment');\n    }\n    obj['label'] = `Unequip ${slot.item.name}`;\n    addAlphabeticallyToKeymap(keymap, obj);\n    return true;\n  })\n\n  return keymap;\n}\n\nexport const activateEquipment = (engine) => {\n  let currentActor = engine.actors[engine.currentActor]\n  engine.game.visibleEquipment = currentActor.equipment;\n\n  let ui = new UI_Actor({\n    initiatedBy: currentActor,\n    pos: { ...currentActor.pos },\n    renderer: {\n      character: 'E',\n      color: 'white',\n      background: '',\n    },\n    name: 'Equipment',\n    game: engine.game,\n  })\n  engine.addActorAsPrevious(ui);\n  engine.game.placeActorOnMap(ui)\n  engine.game.draw()\n  ui.keymap = keymapEquipment(engine, currentActor);\n}","import { CursorMove } from '../../actions';\n\nexport const moveCursor = (direction, engine) => {\n  let actor = engine.actors[engine.currentActor];\n  let newX = actor.pos.x + direction[0];\n  let newY = actor.pos.y + direction[1];\n  actor.setNextAction(new CursorMove({\n    targetPos: { x: newX, y: newY },\n    game: engine.game,\n    actor,\n    energyCost: 0,\n  }))\n}","import * as Action from '../../actions';\nimport * as Item from '../../items';\nimport * as Constant from '../../constants';\nimport { UI_Actor } from '../../entites';\nimport { moveCursor } from './moveCursor';\nimport { createFourDirectionMoveOptions } from '../helper';\n\nconst trigger = (engine, actor, radius = 1) => {\n  let cursor = engine.actors[engine.currentActor];\n\n  actor.setNextAction(\n    // new Action.Say({\n    //   game: engine.game,\n    //   actor,\n    //   message: 'I\\'ll crush you!',\n    //   energyCost: Constant.ENERGY_THRESHOLD\n    // })\n    new Action.SprayWater({\n      targetPos: { ...cursor.pos },\n      radius,\n      game: engine.game,\n      actor,\n      energyCost: Constant.ENERGY_THRESHOLD\n    })\n  )\n}\n\nconst keymap = (engine, initiatedBy, previousKeymap, radius) => {\n  const goToPreviousKeymap = () => {\n    let cursor = engine.actors[engine.currentActor];\n    cursor.active = false;\n    engine.game.removeActor(cursor);\n    // make sure actor is burnable once targeting is complete or canceled\n    initiatedBy['willResetCanBurn'] = true;\n    \n  };\n  return {\n    Escape: {\n      activate: goToPreviousKeymap,\n      label: 'Close',\n    },\n    ...createFourDirectionMoveOptions(moveCursor, engine),\n    t: {\n      activate: () => {\n        // make sure actor is burnable once targeting is complete or canceled\n        initiatedBy['canBurn'] = true;\n        trigger(engine, initiatedBy, radius);\n        goToPreviousKeymap();\n      },\n      label: 'activate'\n    },\n  };\n}\n\nexport const activateProjectile = (engine, radius, range = 2) => {\n  let currentActor = engine.actors[engine.currentActor]\n  let game = engine.game;\n  let pos = currentActor.pos;\n  // prevent player from being burned while on fire.\n  currentActor['canBurn'] = false;\n\n  let cursor = new UI_Actor({\n    initiatedBy: currentActor,\n    range,\n    pos,\n    renderer: {\n      character: '█',\n      color: 'white',\n      background: '',\n    },\n    name: 'Cursor',\n    game,\n    keymap: keymap(engine, currentActor, { ...currentActor.keymap }, radius),\n  })\n  engine.addActorAsPrevious(cursor);\n  game.placeActorOnMap(cursor)\n  game.draw()\n}","import { Shove } from '../../actions';\nimport { ENERGY_THRESHOLD } from '../../constants';\n\nexport const push = (direction, engine) => {\n  let actor = engine.actors[engine.currentActor];\n  let newX = actor.pos.x + direction[0];\n  let newY = actor.pos.y + direction[1];\n  actor.setNextAction(new Shove({\n    targetPos: { x: newX, y: newY },\n    game: engine.game,\n    actor,\n    direction,\n    energyCost: ENERGY_THRESHOLD,\n    processDelay: 25,\n  }))\n}","import { Attack }from '../../actions'\nimport { getDirectionKey, DIRECTIONS, ENERGY_THRESHOLD, THEMES } from '../../constants';\n\n\nconst keyMapChop = (engine, initiatedBy, previousKeymap, animations) => {\n  let actor = engine.actors[engine.currentActor];\n  const goToPreviousKeymap = () => {\n    initiatedBy.keymap = previousKeymap;\n    // animation code\n    if (animations.length) {\n      animations.forEach((animation) => engine.game.display.removeAnimation(animation.id))\n    }\n    // end\n  }\n  return {\n    Escape: {\n      activate: goToPreviousKeymap,\n      label: 'Cancel Chop',\n    },\n    w: {\n      activate: () => {\n        let targetPos = {\n            x: actor.pos.x + DIRECTIONS.N[0], //[0, -1]\n            y: actor.pos.y + DIRECTIONS.N[1]\n        }\n        actor.setNextAction( new Attack({\n            targetPos: targetPos,\n            game: engine.game,\n            actor: actor,\n        }))\n        goToPreviousKeymap();\n      },\n      label: 'activate N',\n    },\n    d: {\n      activate: () => {\n        let targetPos = {\n            x: actor.pos.x + DIRECTIONS.E[0],\n            y: actor.pos.y + DIRECTIONS.E[1]\n        }\n        actor.setNextAction( new Attack({\n            targetPos: targetPos,\n            game: engine.game,\n            actor: actor,\n        }))\n        goToPreviousKeymap();\n      },\n      label: 'activate E',\n    },\n    s: {\n      activate: () => {\n        let targetPos = {\n            x: actor.pos.x + DIRECTIONS.S[0],\n            y: actor.pos.y + DIRECTIONS.S[1]\n        }\n        actor.setNextAction( new Attack({\n            targetPos: targetPos,\n            game: engine.game,\n            actor: actor,\n        }))\n        goToPreviousKeymap();\n      },\n      label: 'activate S',\n    },\n    a: {\n      activate: () => {\n        let targetPos = {\n            x: actor.pos.x + DIRECTIONS.W[0],\n            y: actor.pos.y + DIRECTIONS.W[1]\n        }\n        actor.setNextAction( new Attack({\n            targetPos: targetPos,\n            game: engine.game,\n            actor: actor,\n        }))\n        goToPreviousKeymap();\n      },\n      label: 'activate W',\n    },\n  };\n}\n\nexport const chop = (engine) => {\n  let currentActor = engine.actors[engine.currentActor]\n\n  // animation code: could be abstrated for easier use\n  const directions = [\n    DIRECTIONS.N,\n    DIRECTIONS.E,\n    DIRECTIONS.S,\n    DIRECTIONS.W,\n  ];\n\n  let animations = [];\n\n  directions.forEach((direction) => {\n    let pos = {\n      x: currentActor.pos.x + direction[0],\n      y: currentActor.pos.y + direction[1],\n    }\n    const animation = engine.game.display.addAnimation(1, { x: pos.x, y: pos.y, color: THEMES.SOLARIZED.base3 })\n    animations.push(animation);\n  })\n  // end\n\n  currentActor.keymap = keyMapChop(engine, currentActor, { ...currentActor.keymap }, animations);\n}","import * as Action from '../../actions';\nimport * as Constant from '../../constants';\nimport { coordsToString } from '../../../helper';\nimport * as Item from '../../items';\nimport { UI_Actor } from '../../entites';\nimport { createFourDirectionMoveOptions } from '../helper';\n\nconst grabDirection = (direction, engine, actor, animation) => {\n  const pos = {\n    x: actor.pos.x + direction[0],\n    y: actor.pos.y + direction[1],\n  };\n  actor.setNextAction(\n    new Action.GrabDirection({\n      targetPos: pos,\n      game: engine.game,\n      actor,\n      energyCost: Constant.ENERGY_THRESHOLD,\n    })\n  )\n}\n\n\nconst keymapCursorToGrabEntity = (engine, initiatedBy, initialKeymap, animations) => {\n  const goToPreviousKeymap = () => {\n    initiatedBy.keymap = initialKeymap;\n    // animation code\n    if (animations.length) {\n      animations.forEach((animation) => engine.game.display.removeAnimation(animation.id))\n    }\n    // end\n  }\n  return {\n    Escape: {\n      activate: goToPreviousKeymap,\n      label: 'Cancel Grab',\n    },\n    ...createFourDirectionMoveOptions(\n      (direction, engine) => {\n        grabDirection(direction, engine, initiatedBy);\n        goToPreviousKeymap();\n      },\n      engine,\n      'grab',\n    )\n  }\n}\n\nexport const activateGrab = (engine) => {\n  let game = engine.game;\n  let currentActor = engine.actors[game.engine.currentActor]\n  let initialKeymap = currentActor.keymap;\n\n  // animation code: could be abstrated for easier use\n  const directions = [\n    Constant.DIRECTIONS.N,\n    Constant.DIRECTIONS.E,\n    Constant.DIRECTIONS.S,\n    Constant.DIRECTIONS.W,\n  ];\n\n  let animations = [];\n\n  directions.forEach((direction) => {\n    let pos = {\n      x: currentActor.pos.x + direction[0],\n      y: currentActor.pos.y + direction[1],\n    }\n    const animation = engine.game.display.addAnimation(1, { x: pos.x, y: pos.y, color: Constant.THEMES.SOLARIZED.base3 })\n    animations.push(animation);\n  }) \n  // end\n\n  currentActor.keymap = keymapCursorToGrabEntity(engine, currentActor, initialKeymap, animations);\n}\n\nexport const releaseGrab = (engine) => {\n  let actor = engine.actors[engine.currentActor];\n  actor.setNextAction(new Action.ReleaseGrab({\n    game: engine.game,\n    actor,\n    energyCost: Constant.ENERGY_THRESHOLD\n  }))\n}","import * as Helper from '../helper';\nimport { Particle } from './entites';\nimport { PARTICLE_TEMPLATES } from './constants';\nimport RockLee from './Characters/RockLee';\n\nexport class Engine {\n  constructor({\n    statusEffects = [],\n    actors = [],\n    currentActor = 0,\n    isRunning = false,\n    game = null,\n  }) {\n    this.statusEffects = statusEffects;\n    this.actors = actors;\n    this.currentActor = currentActor;\n    this.isRunning = isRunning;\n    this.game = game;\n  }\n\n  async processV1 () { // a turn-based system using speed and round-robin\n    let actor = this.actors[this.currentActor]\n    actor.gainEnergy(actor.speed);\n    if (actor.hasEnoughEnergy()) {\n      let action = actor.getAction(this.game);\n      if (!action) { return false; } // if no action given, kick out to UI input\n      while (true) {\n        let result = action.perform();\n        this.game.draw();\n        await Helper.delay(action.processDelay);\n        if (!result.success) return false;\n        if (result.alternative === null) break;\n        action = result.alternative;\n      }\n    }\n    this.currentActor = (this.currentActor + 1) % this.actors.length;\n    return true\n  }\n\n  async processV2() { // a turn-based system using speed and Action Points\n    let actor = this.actors[this.currentActor]\n    let acting = true;\n    while (acting) {\n      if (!actor) return false;\n      // if (!actor.active) return false;\n      if (!actor.active) break;\n      let timePassed = 0;\n      if (actor.hasEnoughEnergy()) {\n        // if (!actor.active) break;\n        let action = actor.getAction(this.game);\n        if (!action) { return false; } // if no action given, kick out to UI input\n        timePassed += action.energyCost;\n        while (true) {\n          action.onBefore();\n          let result = await action.perform();\n          if (result.success) {\n            action.onSuccess();\n          } else {\n            action.onFailure();\n          }\n          action.onAfter();\n          if (!await this.processActionFX(action, result.success)) {\n            if (this.shouldAutoRun()) {\n              await Helper.delay(25);\n            } else {\n              await Helper.delay(action.processDelay);\n            }\n            this.game.draw();\n          }\n          if (!actor.active) break;\n          if (!result.success) return false;\n          if (result.alternative === null) break;\n          action = result.alternative;\n        }\n        this.processStatusEffects(timePassed);\n        if (action.interrupt) {\n          acting = false;\n          break;\n        }\n      } else {\n        actor.gainEnergy(actor.speed);\n        acting = false;\n      }\n    }\n    this.actors = this.actors.filter((actor) => actor.active)\n    this.currentActor += 1;\n    if (this.currentActor >= this.actors.length) {\n      this.currentActor = 0;\n    }\n    return true\n  }\n\n  // a turn-based system using speed and Action Points\n  // it reorders all actors by energy after every round robin\n  async processV3() { \n    let actor = this.actors[this.currentActor]\n    if (!actor) return false;\n    let timePassed = 0;\n    if (actor.hasEnoughEnergy()) {\n      let action = actor.getAction(this.game);\n      if (!action) { return false; } // if no action given, kick out to UI input\n      timePassed += action.energyCost;\n      while (true) {\n        let result = await action.perform();\n        if (!await this.processActionFX(action, result.success)) {\n            await Helper.delay(action.processDelay);\n            this.game.draw();\n        }\n        if (!result.success) return false;\n        if (result.alternative === null) break;\n        action = result.alternative;\n      }\n      this.processStatusEffects(timePassed);\n    } else {\n      actor.gainEnergy(actor.speed);\n    }\n    this.currentActor = (this.currentActor + 1) % this.actors.length;\n    if (this.currentActor === 0) this.sortActorsByEnergy();\n    return true\n  }\n\n  // TODO process that reorders actors after every action\n\n  async start() {\n    this.isRunning = true;\n    while (this.isRunning) {\n      this.isRunning = await this.processV2();\n    }\n    let actor = this.actors[this.currentActor]\n    \n    if (!actor) {\n      // this.game.backToTitle();\n      return false;\n    }\n    \n    if (actor.keymap) {\n      this.game.visibleKeymap = actor.keymap;\n    }\n    this.game.updateMode();\n    await this.game.updateReact(this.game);\n  }\n  \n  stop() {\n    this.isRunning = false;\n  }\n\n  sortActorsByEnergy () {\n    this.actors = this.actors.sort((a, b) => b.energy - a.energy);\n  }\n\n  shouldAutoRun () {\n  // if there is no player, the engine will continue to run, we don't want it to run too fast\n    const hasPlayer = this.actors.filter((actor) => actor.entityTypes.includes('PLAYING')).length\n    if (hasPlayer) return false;\n    return true;\n  }\n\n  addStatusEffect(newEffect) {\n    if (!newEffect.allowDuplicates) {\n      if (this.statusEffects.filter((effect) => (\n        effect.actor.id === newEffect.actor.id &&\n        effect.name === newEffect.name\n      )).length > 0) {\n        console.log(`${newEffect.name} cannot be applied twice to ${newEffect.actor.name}`);\n        return false;\n      };\n    }\n    newEffect.onStart();\n    this.statusEffects.push(newEffect)\n    return true;\n  }\n\n  removeStatusEffectById (id) {\n    this.statusEffects = this.statusEffects.filter((effect) => {\n      if (effect.id !== id) return true;\n      effect.onStop();\n      return false;\n    });\n  }\n  \n  removeStatusEffectByActorId (actorId) {\n    this.statusEffects = this.statusEffects.filter((effect) => {\n      if (effect.actor.id !== actorId) return true;\n      effect.onStop();\n      return false;\n    });\n  }\n\n  removeDeadStatusEffects() {\n    this.statusEffects = this.statusEffects.filter((effect) =>{\n      if (effect.lifespan >= 0 && effect.timeToLive <= 0) {\n        effect.onStop();\n        return false;\n      }\n      return true;\n    });\n  }\n\n  processStatusEffects (timePassed) {\n    this.statusEffects.forEach((effect) => {\n      effect.timeSinceLastStep += timePassed;\n      effect.timeToLive -= timePassed;\n      if (effect.timeSinceLastStep >= effect.stepInterval) {\n        effect.onStep();\n        effect.timeSinceLastStep = 0;\n      } \n    });\n    this.removeDeadStatusEffects();\n  }\n\n  async processActionFX (action, actionSuccess) {\n    // EASE IN\n    // let time = .8\n    // let nextT = (t) => t *= t; \n    // EASE OUT\n    // let time = .03\n    // let nextT = (t) => t * (2 - t); \n    // EASE IN OUT QUAD\n    // let time = .4\n    // let nextT = (t) => t < .5 ? 2 * t * t : -1 + (4 - 2 * t) * t; \n    // EASE IN CUBIC\n    // let time = .8\n    // let nextT = (t) => t * t * t; \n    // EASE OUT CUBIC\n    // let time = .001\n    // let nextT = (t) => (--t) * t * t + 1; \n    if (!actionSuccess) { \n      // If action is not successful, instead of running action's normal particle animation\n      // we'll show a red X on the entity that initiated the action\n      const particle = new Particle({\n        game: this.game,\n        name: 'particle',\n        passable: true,\n        pos: {...action.actor.pos},\n        renderer: PARTICLE_TEMPLATES.fail.renderer,\n      })\n      this.game.placeActorOnMap(particle);\n      this.game.draw();\n      await Helper.delay(100);\n      this.game.removeActorFromMap(particle);\n      particle.update(1);\n      this.game.draw();\n      action.removeDeadParticles(); // is this needed?\n      return true;\n    }\n\n    if (action.particles.length) {\n      while (action.particles.length > 0) {\n        action.particles.forEach((particle) => {\n          this.game.placeActorOnMap(particle);\n        })\n        this.game.draw();\n        // await Helper.delay(time * 100);\n        // await Helper.delay(time * action.processDelay);\n        await Helper.delay(action.processDelay);\n        // await Helper.delay(0);\n        action.particles.forEach((particle) => {\n          this.game.removeActorFromMap(particle);\n          particle.update(1);\n\n        })\n        this.game.draw();\n        action.removeDeadParticles();\n        // time = nextT(time);\n      }\n      return true;\n    }\n    return false;\n  }\n\n  addActor (entity) {\n    this.actors.push(entity);\n  }\n\n  addActorAsPrevious (entity) {\n    this.actors.splice(this.currentActor, 0, entity);\n  }\n\n  addActorAsNext (entity) {\n    this.actors.splice(this.currentActor + 1, 0, entity);\n  }\n\n  setActorToPrevious (entity) {\n    this.currentActor -= 1;\n    if (this.currentActor <= -1) this.currentActor = this.actors.length - 1;\n  }\n\n  setActorToNext (entity) {\n    this.currentActor = (this.currentActor + 1) % this.actors.length;\n  }\n\n}\n\n\nexport class CrankEngine extends Engine {\n  async process() { // a turn-based system using speed and Action Points\n    let actor = this.actors[this.currentActor]\n    let acting = true;\n    while (acting) {\n      if (actor.hasEnoughEnergy()) {\n        let action = actor.getAction(this.game);\n        if (!action) { return false; } // if no action given, kick out to UI input\n        while (true) {\n          this.game.draw();\n          let result = await action.perform();\n          await Helper.delay(action.processDelay);\n          if (!result.success) return false;\n          if (result.alternative === null) break;\n          action = result.alternative;\n        }\n      } else {\n        // actor.gainEnergy(actor.speed);\n        acting = false;\n      }\n    }\n    // this.currentActor = (this.currentActor + 1) % this.actors.length;\n    this.currentActor += 1;\n    if (this.currentActor + 1 >= this.actors.length) {\n      this.currentActor = 0;\n      this.actors.forEach((actor) => actor.gainEnergy(actor.speed));\n      return false;\n    }\n    return true\n  }\n\n  async start() {\n    this.isRunning = true;\n    while (this.isRunning) {\n      this.isRunning = await this.process();\n    }\n    let actor = this.actors[this.currentActor]\n    if (actor.keymap) {\n      this.game.visibleKeymap = actor.keymap;\n    }\n    // this.game.updateMode();\n    this.game.mode.update();\n    await this.game.updateReact(this.game);\n  }\n}","import Konva from 'konva';\nimport uuid from 'uuid/v1';\nimport * as Helper from '../../helper';\n\nexport const ANIMATION_TYPES = {\n  DEFAULT: 0,\n  BLINK_TILE: 1,\n  SOLID_TILE: 2,\n}\n\nclass Animation {\n  constructor({display}) {\n    const id = uuid();\n    this.id = id;\n    this.lifeTime = 0;\n    this.active = true;\n    this.display = display;\n    this.node = null;\n  }\n\n  getActive () {\n    return false;\n  }\n\n  initialize () {\n    return;\n  }\n\n  update (frame) {\n    this.lifeTime += frame.timeDiff;\n    this.active = this.getActive();\n    if (!this.active) {\n      this.display.removeAnimation(this.id);\n    }\n  }\n}\n\nclass ExampleAnimation extends Animation {\n  constructor({...args}) {\n    super({...args})\n  }\n\n  getActive () {\n    if (this.lifeTime > 500) {\n      return false;\n    }\n    return true;\n  }\n}\n\nclass BlinkTile extends Animation {\n  constructor({\n    x,\n    y,\n    lerpDirection = -1,\n    color = '#fff',\n    ...args\n  }) {\n    super({ ...args });\n    this.x = x;\n    this.y = y;\n    this.lerpDirection = lerpDirection;\n    this.color = color;\n  }\n\n  getActive () {\n    return this.active;\n  }\n\n  initialize () {\n    this.active = true;\n    let rect = new Konva.Rect({\n      name: 'rect',\n      x: (this.display.tileWidth * this.x) + (this.display.tileOffset + this.display.tileGutter),\n      y: (this.display.tileHeight * this.y) + (this.display.tileOffset + this.display.tileGutter),\n      offsetX: this.display.tileWidth / -4,\n      offsetY: this.display.tileHeight / -4,\n      width: this.display.tileWidth / 2,\n      height: this.display.tileHeight / 2,\n      fill: this.color,\n      strokeEnabled: false,\n      // for optimization\n      transformsEnabled: 'position',\n      perfectDrawEnabled: false,\n      listening: false,\n      shadowForStrokeEnabled: false,\n    });\n    this.display.animationLayer.add(rect);\n    this.node = rect;\n    super.initialize();\n  }\n\n  update (frame) {\n    let opacity = this.node.opacity();\n    if (opacity >= 1) this.lerpDirection = -1;\n    if (opacity <= 0) this.lerpDirection = 1;\n    opacity += (0.05 * this.lerpDirection)\n    this.node.opacity(Helper.clamp(opacity, 0, 1))\n    super.update(frame);\n  }\n  \n}\n\nexport class Display {\n  constructor({\n    containerId = null,\n    width = 100,\n    height = 100,\n    tileWidth = 10,\n    tileHeight = 10,\n    tileGutter = 0,\n    tileOffset = 10,\n    cameraFollow = false,\n    game = null,\n  }) {\n    this.containerId = containerId;\n    this.width = width;\n    this.height = height;\n    this.tilesWide = this.getTilesWide(width, tileOffset, tileWidth);\n    this.tilesHigh = this.getTilesHigh(height, tileOffset, tileHeight);\n    this.tileWidth = tileWidth;\n    this.tileHeight = tileHeight;\n    this.tileGutter = tileGutter;\n    this.tileOffset = tileOffset;\n    this.cameraFollow = cameraFollow;\n    this.stage = null;\n    this.layer = null;\n    this.animationLayer = null;\n    this.animations = [];\n    this.animationLoop = null;\n    this.game = game;\n  }\n\n  initialize (document) {\n    let d = document.getElementById(this.containerId)\n    let displayContainer = document.createElement('div');\n    d.appendChild(displayContainer);\n\n    this.stage = new Konva.Stage({\n      container: 'display',   // id of container <div>\n      width: this.width,\n      height: this.height\n    });\n\n    // setting up main tile map layer\n    this.layer = new Konva.Layer({\n      hitGraphEnabled: false,\n    });\n    this.stage.add(this.layer);\n    \n    // setting up animation layer\n    this.animationLayer = new Konva.Layer({});\n    this.stage.add(this.animationLayer);\n    let animationLoop = new Konva.Animation((frame) => {\n      this.animations.forEach((animation) => animation.update(frame))\n      // Stop animation updates if no animations to process\n      if (this.animations.length <= 0) {\n        if (this.animationLoop) {\n          if (this.animationLoop.isRunning()) {\n            this.animationLoop.stop();\n          }\n        }\n      }\n    }, this.animationLayer);\n    this.animationLoop = animationLoop;\n    animationLoop.start();\n  }\n\n  addAnimation (type, args) {\n    let animation;\n    switch (type) {\n      case ANIMATION_TYPES.DEFAULT:\n        animation = new Animation({display: this, ...args})\n        break;\n      case ANIMATION_TYPES.SOLID_TILE:\n        animation = new ExampleAnimation({display: this, ...args})\n        break;\n      case ANIMATION_TYPES.BLINK_TILE:\n        animation = new BlinkTile({display: this, ...args})\n        break;\n      \n      default:\n        animation = new Animation({ display: this, ...args})\n        break;\n    }\n    animation.initialize();\n    this.animations.push(animation)\n    if (!this.animationLoop.isRunning()) this.animationLoop.start();\n    return animation\n  }\n\n  removeAnimation (id) {\n    this.animations = this.animations.filter((anim) => {\n      if (anim.id !== id) return true;\n      // if anim is being removed, remove associated nodes and shapes too\n      anim.node.destroy();\n      return false;\n    });\n    \n  }\n\n  updateTile(tile, character, foreground, background) {\n    // child[0] is the rectangle\n    // child[1] is the text\n    tile.children[0].fill(background);\n    tile.children[1].fill(foreground);\n    tile.children[1].text(character);\n  }\n\n  createTile(x, y, character, foreground, background) {\n    let node = new Konva.Group({\n      id: `${x},${y}`,\n      x: (this.tileWidth * x) + (this.tileOffset + this.tileGutter),\n      y: (this.tileHeight * y) + (this.tileOffset + this.tileGutter),\n      width: this.tileWidth,\n      height: this.tileHeight,\n      transformsEnabled: 'position',\n      perfectDrawEnabled: false,\n      listening: false,\n      shadowForStrokeEnabled: false,\n    });\n\n    let rect = new Konva.Rect({\n      name: 'rect',\n      width: this.tileWidth,\n      height: this.tileHeight,\n      fill: background,\n      strokeEnabled: false,\n      // for optimization\n      transformsEnabled: 'position',\n      perfectDrawEnabled: false,\n      listening: false,\n      shadowForStrokeEnabled: false,\n    });\n\n    let text = new Konva.Text({\n      name: 'text',\n      text: character,\n      width: this.tileWidth,\n      height: this.tileHeight,\n      fontSize: 24,\n      fontFamily: 'scroll-o-script',\n      fill: foreground,\n      align: 'center',\n      verticalAlign: 'middle',\n      // for optimization\n      transformsEnabled: 'position',\n      perfectDrawEnabled: false,\n      listening: false,\n      shadowForStrokeEnabled: false,\n    });\n\n    node.add(rect);\n    node.add(text);\n    this.layer.add(node);\n    return node;\n  }\n\n  getAbsoultueX(x) {\n    return (this.tileWidth * x) + (this.tileOffset + this.tileGutter)\n  }\n\n  getAbsoultueY(y) {\n    return (this.tileWidth * y) + (this.tileOffset + this.tileGutter)\n  }\n\n  getTilesWide (width, tileOffset, tileWidth) {\n    return Math.floor((width - tileOffset) / tileWidth)\n  }\n  \n  getTilesHigh(height, tileOffset, tileHeight) {\n    return Math.floor((height - tileOffset) / tileHeight)\n  }\n\n  draw (playerPos) {\n    if (this.cameraFollow && playerPos) {\n      const tilesWide = this.tilesWide;\n      const tilesHigh = this.tilesHigh;\n      const tilesAcrossOnScreen = Math.floor(this.width / this.tileWidth)\n      const tilesDownOnScreen = Math.floor(this.height / this.tileHeight)\n      \n      const bufferX = Math.ceil(tilesWide - (tilesAcrossOnScreen / 2));\n      const bufferY = Math.ceil(tilesHigh - (tilesDownOnScreen / 2));\n      let newX = 0;\n      let newY = 0;\n      if (playerPos.x > tilesWide - bufferX) {\n        newX = tilesWide - bufferX - playerPos.x\n      }\n      if (playerPos.y > tilesHigh - bufferY) {\n        newY = tilesHigh - bufferY - playerPos.y;\n      }\n      this.layer.x(this.getAbsoultueX(newX))\n      this.layer.y(this.getAbsoultueY(newY))\n    }\n    this.layer.batchDraw();\n    // this.animationLayer.batchDraw();\n    // this.layer.draw();\n  }\n}","import * as Helper from '../../helper';\n\nexport const generate = (map, offsetX, offsetY, unitCount = 12, unitSize = 4, borderWidth = 1) => {\n  let data = {};\n  // const floorPlan = createFloorPlan(unitCount);\n  // let maxX = 0; \n  // let minX = 0; \n  // let maxY = 0; \n  // let minY = 0; \n  // floorPlan.forEach((pos) => {\n  //   if (pos.x > maxX) maxX = pos.x;\n  //   if (pos.x < minX) minX = pos.x;\n  //   if (pos.y > maxY) maxY = pos.y;\n  //   if (pos.y < minY) minY = pos.y;\n  // })\n  // const floorPlanWidth = Math.abs(maxX) + Math.abs(minX) + 1;\n  // const floorPlanHeight = Math.abs(maxY) + Math.abs(minY) + 1;\n  // console.log(floorPlanWidth);\n  // console.log(floorPlanHeight);\n  \n  let floorPlan = createFloorPlan();\n  let kill = 1000\n  while (floorPlan.length < unitCount + 1) {\n    \n    let unit = createRoomInFloorPlan(floorPlan);\n    if (unit) {\n      const unitPosition = getUnitPosition(unit, offsetX, offsetY, unitSize);\n      let didCreate = createUnit(map, unitPosition, unitSize, 0);\n      if (didCreate) floorPlan.push(unit);\n    }\n    \n    kill -= 1;\n    if (kill <= 0) break;\n  }\n  \n  removeInnerWalls(map)\n  addInnerWalls(map, floorPlan.length)\n  return data;\n}\n\nconst createFloorPlan = () => {\n  // create origin\n  let floorPlan = [{x: 0, y: 0}];\n  return floorPlan\n}\n\nconst createRoomInFloorPlan = (floorPlan) => {\n  // randomly choose previously created unit\n  // let origin = floorPlan[floorPlan.length - 1];\n  let origin = Helper.getRandomInArray(floorPlan);\n  // randomly choose neighboring point\n  let newUnit = getNeighboringUnit(origin);\n  let unitAlreadyExists = unitExists(newUnit, floorPlan)\n  let kill = 1000\n  while (unitAlreadyExists) {\n    origin = Helper.getRandomInArray(floorPlan.filter((pnt) => !Helper.coordsAreEqual(pnt, origin)));\n    newUnit = getNeighboringUnit(origin);\n    unitAlreadyExists = unitExists(newUnit, floorPlan)\n    kill -= 1;\n    if (kill <= 0) {\n      unitAlreadyExists = false;\n      newUnit = false;\n      break;\n    }\n  }\n  \n  return newUnit\n}\n\nconst getNeighboringUnit = (origin) => Helper.getRandomInArray(getNeighboringPoints(origin))\nconst unitExists = (newUnit, existingUnits) => existingUnits.filter((unit) => unit.x === newUnit.x && unit.y === newUnit.y).length > 0;\nconst getUnitPosition = (floorPlanPos, mapOffsetX, mapOffsetY, unitSize) => {\n  return {\n    x: floorPlanPos.x + mapOffsetX + (unitSize * floorPlanPos.x),\n    y: floorPlanPos.y + mapOffsetY + (unitSize * floorPlanPos.y),\n  }\n}\n\nconst getNeighboringPoints = (origin, eightWay = false) => {\n  let neighbors = [\n    {\n      x: origin.x,\n      y: origin.y + 1\n    },\n    {\n      x: origin.x + 1,\n      y: origin.y\n    },\n    {\n      x: origin.x,\n      y: origin.y - 1\n    },\n    {\n      x: origin.x - 1,\n      y: origin.y\n    },\n  ]\n\n  if (eightWay) {\n    neighbors = neighbors.concat([\n      {\n        x: origin.x + 1,\n        y: origin.y + 1\n      },\n      {\n        x: origin.x + 1,\n        y: origin.y - 1\n      },\n      {\n        x: origin.x - 1,\n        y: origin.y - 1\n      },\n      {\n        x: origin.x - 1,\n        y: origin.y + 1\n      },\n    ])\n  }\n  return neighbors;\n}\n\nconst createUnit = (map, position, size, border) => {\n  // const length = size; // this will leave a border\n  // const length = size + 1; // this will close the gap\n  const length = size + 1 - border; // this will calculate using border\n\n  // prevent units from hitting map edge\n  let unitCollidesWithEdge = false;\n  for (let i = 0; i < length; i++) {\n    for (let j = 0; j < length; j++) {\n      const newPosition = {\n        x: position.x + i,\n        y: position.y + j,\n      }\n      let tile = map[Helper.coordsToString(newPosition)];\n      if (!tile) unitCollidesWithEdge = true;\n    }\n  }\n\n  if (!unitCollidesWithEdge) {\n    for (let i = 0; i < length; i++) {\n      for (let j = 0; j < length; j++) {\n        const newPosition = {\n          x: position.x + i,\n          y: position.y + j,\n        }\n        let type = 'FLOOR';\n        if (i === 0 || i === (length - 1)) type = 'WALL';\n        if (j === 0 || j === (length - 1)) type = 'WALL';\n        let tile = map[Helper.coordsToString(newPosition)];\n        if (tile) tile.type = type;\n      }\n    }\n  }\n\n  return !unitCollidesWithEdge;\n}\n\nconst removeInnerWalls = (map) => {\n  let walls = Object.keys(map).filter((key) => {\n    return map[key].type === 'WALL';\n  })\n\n  let innerWalls = walls.filter((key) => {\n    const coordArray = key.split(',').map((i) => parseInt(i));\n    const coords = {\n      x: coordArray[0],\n      y: coordArray[1],\n    }\n    const neighbors = getNeighboringPoints(coords, true).filter((point) => {\n      let t = map[Helper.coordsToString(point)];\n      if (t) {\n        if (['WALL', 'FLOOR'].includes(t.type)) {\n          return true;\n        }\n      }\n      return false\n    });\n    \n    if (neighbors.length === 8) {\n      return true;\n    }\n    return false;\n  })\n\n  innerWalls.forEach((key) => {\n    map[key].type = 'FLOOR';\n  })\n}\n\nconst addInnerWalls = (map, count = 2) => {\n  // Finding corners\n  let corners = Object.keys(map).filter((key) => {\n    const tile = map[key];\n    if (tile.type !== 'WALL') return false;\n    const coordArray = key.split(',').map((i) => parseInt(i));\n    const coords = {\n      x: coordArray[0],\n      y: coordArray[1],\n    }\n    const neighbors = getNeighboringPoints(coords, false).filter((point) => {\n      let t = map[Helper.coordsToString(point)];\n      if (t) {\n        if (['GROUND'].includes(t.type)) {\n          return true;\n        }\n      }\n      return false\n    });\n    if (neighbors.length === 2) return true;\n    return false\n  })\n\n  // building walls\n  let wallCount = 0;\n  while (wallCount < count) {\n  // while (wallCount < corners.length) {\n  // for (let i = 0; i < count; i++) {\n    const corner = Helper.getRandomInArray(corners);\n    const coordArray = corner.split(',').map((i) => parseInt(i));\n    const coords = {\n      x: coordArray[0],\n      y: coordArray[1],\n    }\n    const wallNeighbors = getNeighboringPoints(coords, false).filter((point) => {\n      let t = map[Helper.coordsToString(point)];\n      if (t) {\n        if (['WALL'].includes(t.type)) {\n          return true;\n        }\n      }\n      return false\n    });\n    const selectedWallPos = Helper.getRandomInArray(wallNeighbors)\n    if (!selectedWallPos) continue;\n    const direction = {\n      x: Math.sign(selectedWallPos.x - coords.x),\n      y: Math.sign(selectedWallPos.y - coords.y)\n    };\n\n    let kill = 100;\n    let build = true;\n    let currentPosition = {...coords}\n    let previousFloorPositions = [];\n    while (build) {\n      currentPosition.x += direction.x;\n      currentPosition.y += direction.y;\n      let tile = map[Helper.coordsToString(currentPosition)];\n      if (!tile) break;\n      // if (tile.type === 'WALL') continue;\n      if (tile.type === 'FLOOR') {\n        tile.type = 'WALL';\n        previousFloorPositions.push({...currentPosition})\n        // console.log(previousFloorPositions.length);\n        \n      } else if (tile.type === 'GROUND' || (tile.type === 'WALL' && previousFloorPositions.length)) {\n        // go back two and make FLOOR\n        let prevPos = {\n          x: currentPosition.x - (direction.x * 2),\n          y: currentPosition.y - (direction.y * 2),\n        }\n        map[Helper.coordsToString(prevPos)].type = 'DOOR';\n        // map[Helper.coordsToString(prevPos)].type = 'FLOOR';\n        // go back one more and make FLOOR\n        prevPos = {\n          x: currentPosition.x - (direction.x * 3),\n          y: currentPosition.y - (direction.y * 3),\n        }\n        map[Helper.coordsToString(prevPos)].type = 'DOOR';\n        // map[Helper.coordsToString(prevPos)].type = 'FLOOR';\n        if (previousFloorPositions.length <= 0) {\n          //   // we need to create another wall, this one is bust\n          if (count <= 100) count += 1\n        }\n        break;\n      }\n      kill -= 1;\n      if (kill <= 0) build = false;\n    }\n    wallCount += 1;\n  }\n}","import * as Constant from '../constants';\nimport * as Helper from '../../helper';\nimport * as Item from '../items';\nimport * as MapHelper from '../Maps/helper';\nimport { generate as generateBuilding } from '../Maps/generator';\nimport { FireSpread, Speaker, Debris } from '../entites';\nimport { MESSAGE_TYPE } from '../message';\nimport { Mode } from './default';\nimport SOUNDS from '../sounds';\n\nexport class Play extends Mode {\n  constructor({ ...args }) {\n    super({ ...args });\n  }\n\n  initialize () {\n    super.initialize();\n    const offsetX = Math.floor(this.game.mapWidth / 2)\n    const offsetY = Math.floor(this.game.mapHeight / 2)\n    generateBuilding(this.game.map, offsetX, offsetY);\n    MapHelper.addTileZone(\n      { x: 0, y: 0 },\n      3,\n      'SAFE',\n      this.game.map,\n      this.game.mapHeight,\n      this.game.mapWidth,\n    );\n    this.placeInitialItems();\n    this.placePlayersInSafeZone();\n\n    let array = Object.keys(this.game.map).filter((key) => this.game.map[key].type === 'FLOOR')\n    for (let index = 0; index < this.data.debrisCount; index++) {\n      let pos = Helper.getRandomInArray(array);\n      let posXY = pos.split(',').map((coord) => parseInt(coord));\n      this.addDebris({ x: posXY[0], y: posXY[1] });\n    }\n    for (let index = 0; index < this.data.mediumDebrisCount; index++) {\n      let pos = Helper.getRandomInArray(array);\n      let posXY = pos.split(',').map((coord) => parseInt(coord));\n      this.addDebris({ x: posXY[0], y: posXY[1] }, 'Medium Sized Debris', 'm', 10, 0);\n    }\n    for (let index = 0; index < this.data.heavyDebrisCount; index++) {\n      let pos = Helper.getRandomInArray(array);\n      let posXY = pos.split(',').map((coord) => parseInt(coord));\n      this.addDebris({ x: posXY[0], y: posXY[1] }, 'Heavy Sized Debris', 'H', 10, 0, false, false);\n    }\n    for (let index = 0; index < this.data.smallGasCanCount; index++) {\n      let pos = Helper.getRandomInArray(array);\n      let posXY = pos.split(',').map((coord) => parseInt(coord));\n      this.addDebris({ x: posXY[0], y: posXY[1] }, 'gas can', 'Xs', 1, 1, true, true, Constant.THEMES.SOLARIZED.orange);\n    }\n    for (let index = 0; index < this.data.mediumCanCount; index++) {\n      let pos = Helper.getRandomInArray(array);\n      let posXY = pos.split(',').map((coord) => parseInt(coord));\n      this.addDebris({ x: posXY[0], y: posXY[1] }, 'gas can', 'X', 1, 3, true, true, Constant.THEMES.SOLARIZED.orange);\n    }\n    for (let index = 0; index < this.data.largeGasCanCount; index++) {\n      let pos = Helper.getRandomInArray(array);\n      let posXY = pos.split(',').map((coord) => parseInt(coord));\n      this.addDebris({ x: posXY[0], y: posXY[1] }, 'gas can', 'XL', 1, 10, true, true, Constant.THEMES.SOLARIZED.orange);\n    }\n    for (let index = 0; index < this.data.fireIntensity; index++) {\n      let pos = Helper.getRandomInArray(array);\n      let posXY = pos.split(',').map((coord) => parseInt(coord));\n      this.addFire({ x: posXY[0], y: posXY[1] });\n    }\n    for (let index = 0; index < this.data.npcCount; index++) {\n      let pos = Helper.getRandomInArray(array);\n      let posXY = pos.split(',').map((coord) => parseInt(coord));\n      this.addNPC({ x: posXY[0], y: posXY[1] });\n    }\n    // sounds\n    if (!SOUNDS.fire_1.playing()) SOUNDS.fire_1.play();    \n  }\n\n  checkRemoveSafeFloors () {\n    const currentActor = this.game.engine.actors[this.game.engine.currentActor];\n    if (currentActor.name !== Constant.PLAYER_NAME) return;\n\n    this.data.turnCount += 1;\n    if (this.data.turnCount > this.getSaveCountRequirement() * 50) {\n      Object.keys(this.game.map).filter((key) => this.game.map[key].type == 'SAFE_FLOOR').forEach((key) => {\n        this.game.map[key].type = 'FLOOR';\n      });\n\n    }\n  }\n\n  update () {\n    super.update();\n    this.propogateFire();\n    this.burnEntities();\n    this.checkRemoveSafeFloors();\n    if (this.hasLost()) {\n      this.reset();\n      this.game.initializeGameData();\n    }\n    // triggerd once all npcs are saved\n    if (this.hasWon()) {\n      this.nextLevel();\n      this.increaseIntensity()\n      this.game.initializeGameData();\n    }\n  }\n  \n  //Extras\n\n  setLevel (level) {\n    this.data.level = level;\n    this.data.turnCount = 0;\n  }\n\n  nextLevel () {\n    this.setLevel(this.data.level + 1);\n  }\n\n  reset () {\n    this.resetIntensity();\n    this.setLevel(1);\n    this.initialize();\n  }\n\n  increaseIntensity () {\n    switch (this.data.level) {\n\n      case 2:\n        this.data.fireIntensity = 2;\n        this.data.npcCount = 1;\n        this.data.debrisCount = 4;\n        this.data.mediumDebrisCount = 4;\n        this.data.heavyDebrisCount = 1\n        this.data.smallGasCanCount = 1;\n        this.data.mediumGasCanCount = 1;\n        this.data.largeGasCanCount = 1;\n        break;\n      case 3:\n        this.data.fireIntensity = 3;\n        this.data.npcCount = 2;\n        this.data.debrisCount = 50;\n        this.data.mediumDebrisCount = 4;\n        this.data.heavyDebrisCount = 1\n        this.data.smallGasCanCount = 1;\n        this.data.mediumGasCanCount = 2;\n        this.data.largeGasCanCount = 1;\n        break;\n      case 4:\n        this.data.fireIntensity = 4;\n        this.data.npcCount = 2;\n        this.data.debrisCount = 6;\n        this.data.mediumDebrisCount = 4;\n        this.data.heavyDebrisCount = 1\n        this.data.smallGasCanCount = 3;\n        this.data.mediumGasCanCount = 2;\n        this.data.largeGasCanCount = 1;\n        break;\n      case 5:\n        this.data.fireIntensity = 5;\n        this.data.npcCount = 3;\n        this.data.debrisCount = 6;\n        this.data.mediumDebrisCount = 4;\n        this.data.heavyDebrisCount = 1\n        this.data.smallGasCanCount = 3;\n        this.data.mediumGasCanCount = 1;\n        this.data.largeGasCanCount = 1;\n        break;\n      case 6:\n        this.data.fireIntensity = 4;\n        this.data.npcCount = 3;\n        this.data.debrisCount = 10;\n        this.data.mediumDebrisCount = 4;\n        this.data.heavyDebrisCount = 1\n        this.data.smallGasCanCount = 3;\n        this.data.mediumGasCanCount = 1;\n        this.data.largeGasCanCount = 1;\n        break;\n      case 7:\n        this.data.fireIntensity = 1;\n        this.data.npcCount = 3;\n        this.data.debrisCount = 80;\n        this.data.mediumDebrisCount = 4;\n        this.data.heavyDebrisCount = 1\n        this.data.smallGasCanCount = 25;\n        this.data.mediumGasCanCount = 1;\n        this.data.largeGasCanCount = 1;\n        break;\n      case 8:\n        this.data.fireIntensity = 3;\n        this.data.npcCount = 3;\n        this.data.debrisCount = 20;\n        this.data.mediumDebrisCount = 4;\n        this.data.heavyDebrisCount = 1\n        this.data.smallGasCanCount = 6;\n        this.data.mediumGasCanCount = 1;\n        this.data.largeGasCanCount = 1;\n        break;\n      case 9:\n        this.game.toWin();\n        break;\n      default:\n        this.data.fireIntensity = 3;\n        this.data.npcCount = 3;\n        this.data.debrisCount = 20;\n        this.data.mediumDebrisCount = 4;\n        this.data.heavyDebrisCount = 1\n        this.data.gasCanCount = 5;\n        break;\n    }\n  }\n\n  resetIntensity () {\n    this.data.fireIntensity = 1;\n    this.data.npcCount = 1;\n    this.data.debrisCount = 4;\n  }\n\n  countNpcSafe () {\n    const helpless = this.game.engine.actors.filter((actor) => {\n      if (actor.entityTypes.includes('HELPLESS')) {\n        const tile = this.game.map[Helper.coordsToString(actor.pos)];\n        if (tile.type === 'SAFE') {\n          if (!actor.saved) actor.save();\n          return true;\n        }\n      }\n      return false\n    });\n\n    return helpless.length;\n  }\n\n  getSaveCountRequirement () {\n    const minimum = Math.ceil(this.data.npcCount * 0.66);\n    return Math.max(1, minimum);\n  }\n\n  hasWon () {\n    return this.countNpcSafe() >= this.getSaveCountRequirement();\n  }\n\n  hasLost () {\n    const helpless = this.game.engine.actors.filter((actor) => actor.entityTypes.includes('HELPLESS'));\n    if (helpless.length < this.getSaveCountRequirement()) {\n      SOUNDS.lose.play();\n      this.game.toLose();\n      return true;\n    }\n    return false;\n  }\n\n  addDebris (pos, name = 'box', character = '%', durability = 5, explosivity = 0, pushable = true, draggable = true, background = Constant.THEMES.SOLARIZED.base01) {\n    let sprite = Helper.getRandomInArray(['', '', '', '', '', '']);\n    switch (character) {\n      case '%':\n        sprite = Helper.getRandomInArray(['', '']);\n        break;\n      case 'm':\n        sprite = Helper.getRandomInArray(['', '']);\n        break;\n      case 'H':\n        sprite = Helper.getRandomInArray(['', '']);\n        break;\n      case 'Xs':\n        sprite = ''\n        break;\n      case 'X':\n        sprite = ''\n        break;\n      case 'XL':\n        sprite = ''\n        break;\n      default:\n        sprite = '';\n        break;\n    }\n\n    let box = new Debris({\n      pos,\n      renderer: {\n        character,\n        sprite,\n        color: Constant.THEMES.SOLARIZED.base2,\n        background,\n      },\n      name,\n      game: this.game,\n      durability,\n      explosivity,\n      flammability: 0,\n      draggable,\n      pushable,\n    })\n\n    this.game.placeActorOnMap(box)\n    this.game.draw();\n  }\n\n  addNPC (pos) {\n    // create new entity and place\n    let entity = new Speaker({\n      name: Constant.NPC_NAME,\n      // messages: SOLANGE.lyrics,\n      messages: ['help!', 'ahh!', 'It\\'s getting hot in hurr.'],\n      messageType: MESSAGE_TYPE.ACTION,\n      pos,\n      game: this.game,\n      renderer: {\n        character: 'C',\n        sprite: '',\n        color: Constant.THEMES.SOLARIZED.base3,\n        background: Constant.THEMES.SOLARIZED.violet,\n      },\n      durability: 2,\n    })\n\n    if (this.game.placeActorOnMap(entity)) {\n      const tile = this.game.map[Helper.coordsToString(entity.pos)];\n      tile.type = 'SAFE_FLOOR';\n      this.game.engine.addActor(entity);\n      this.game.draw();\n    };\n  }\n\n  addFire (pos) {\n    // create new fire actor and place\n    let fire = new FireSpread({\n      name: 'Pyro',\n      pos,\n      game: this.game,\n      renderer: {\n        character: '*',\n        sprite: '',\n        color: Constant.THEMES.SOLARIZED.base3,\n        background: Constant.THEMES.SOLARIZED.red,\n      },\n      timeToSpread: 1,\n      spreadCount: 1,\n      durability: 1,\n      attackDamage: 2,\n      speed: 100,\n    })\n\n    if (this.game.placeActorOnMap(fire)) {\n      this.game.engine.addActor(fire);\n      this.game.draw();\n    };\n  }\n\n  propogateFire () {\n    const fires = this.game.engine.actors.filter((actor) => actor.name === 'Pyro')\n    if (fires.length < this.data.fireIntensity) {\n      // find burnt tile\n      const keys = Object.keys(this.game.map).filter((key) => this.game.map[key].type == 'BURNT');\n      const key = Helper.getRandomInArray(keys);\n      if (key) {\n        const position = {\n          x: parseInt(key.split(',')[0]),\n          y: parseInt(key.split(',')[1]),\n        }\n        this.addFire(position)\n      }\n    }\n  }\n\n  burnEntities () {\n    // burn all entiies on burning tiles\n    const coordinates = Object.keys(this.game.map).filter((key) => this.game.map[key].type === 'BURNT');\n    const entities = coordinates.reduce((acc, curr) => acc.concat(this.game.map[curr].entities), []);\n    entities.forEach((ent) => {\n      if (ent.entityTypes.includes('BURNABLE')) {\n        const burned = ent.burn();\n        if (burned) this.game.addMessage(`${ent.name} is burned.`, MESSAGE_TYPE.DANGER);\n        if (ent.willResetCanBurn) ent.resetCanBurn();\n      }\n    })\n  }\n\n  placeInitialItems () {\n    let objects = [\n      Item.axe(this.game.engine),\n      Item.waterGun(this.game.engine),\n      Item.fireJacket(this.game.engine),\n    ];\n\n    const keys = Object.keys(this.game.map).filter((key) => this.game.map[key].type == 'SAFE');\n\n    objects.forEach((item) => {\n      const key = keys.pop();\n      if (key) {\n        const position = {\n          x: parseInt(key.split(',')[0]),\n          y: parseInt(key.split(',')[1]),\n        }\n        item.pos = position;\n        let tile = this.game.map[key];\n        if (tile) {\n          tile.entities.push(item);\n        }\n      }\n    })\n  }\n\n  placePlayersInSafeZone () {\n    let players = this.game.engine.actors.filter((actor) => actor.entityTypes.includes('PLAYING'))\n    const keys = Object.keys(this.game.map).filter((key) => this.game.map[key].type == 'SAFE');\n    players.forEach((player) => {\n      const key = keys.shift();\n      if (key) {\n        const position = {\n          x: parseInt(key.split(',')[0]),\n          y: parseInt(key.split(',')[1]),\n        }\n        player.pos = position;\n        let tile = this.game.map[key];\n        if (tile) {\n          tile.entities.push(player);\n        }\n      }\n    })\n  }\n\n}\n","import * as Constant from '../constants';\nimport * as Helper from '../../helper';\n\nexport const addTileZone = (origin = { x: 0, y: 0 }, size = 3, type = 'GROUND', map, mapHeight, mapWidth) => {\n  for (let i = 0; i < mapHeight; i++) {\n    for (let j = 0; j < mapWidth; j++) {\n      if (i >= origin.y && i <= origin.y + (size - 1) && j >= origin.x && j <= origin.x + (size - 1)) {\n        const key = `${j},${i}`\n        let currentFrame = 0;\n\n        if (Constant.TILE_KEY[type].animation) {\n          currentFrame = Helper.getRandomInt(0, Constant.TILE_KEY[type].animation.length)\n        }\n\n        map[key] = {\n          type,\n          currentFrame,\n          entities: [],\n        };\n      }\n    }\n  }\n}","import uuid from 'uuid/v1';\n\nexport class Mode {\n  constructor({\n    game = null,\n    data = {},\n  }) {\n    let id = uuid();\n    this.id = id;\n    this.game = game;\n    this.data = data;\n  }\n\n  initialize() {}\n\n  update() {}\n\n}","import React from 'react';\nimport * as ROT from 'rot-js';\nimport * as Constant from './constants';\nimport * as Helper from '../helper';\nimport * as Message from './message';\nimport { Display } from './Display/konvaCustom';\nimport * as Mode from './Modes/index';\n\n// const MAP_DATA = require('./Maps/building.json');\n// const MAP_DATA = require('./Maps/building_w_floor.json');\n// const MAP_DATA = require('./Maps/building_w_ambo.json');\n// const SOLANGE = require('./Data/solange.json');\n\nconst MAP_WIDTH = 50;\nconst MAP_HEIGHT = 25;\nconst TILE_WIDTH = 30;\nconst TILE_HEIGHT = 30;\nconst TILE_OFFSET = 5;\nconst canvasWidth = (MAP_WIDTH * TILE_WIDTH) + TILE_OFFSET;\nconst canvasHeight = (MAP_HEIGHT * TILE_HEIGHT) + TILE_OFFSET;\n\nexport class Game {\n  constructor({\n    engine = null,\n    map = {},\n    mapInitialized = false,\n    tileMap = {},\n    mapWidth = MAP_WIDTH,\n    mapHeight = MAP_HEIGHT,\n    getSelectedCharacter = () => false,\n    display = new Display({\n      containerId: 'display',\n      width: canvasWidth,\n      height: canvasHeight,\n      tileWidth: TILE_WIDTH,\n      tileHeight: TILE_HEIGHT,\n      tileOffset: TILE_OFFSET,\n      cameraFollow: false,\n      game: this,\n    }),\n    spriteMode = true,\n    tileKey = Constant.TILE_KEY,\n    mode = new Mode.Play({\n      game: this,\n      data: {\n        level: 1,\n        highestLevel: null,\n        fireIntensity: 1, // increase this number to increase fire spread\n        npcCount: 1,\n        debrisCount: 4,\n        mediumDebrisCount: 3,\n        heavyDebrisCount: 4,\n        smallGasCanCount: 3,\n        mediumGasCanCount: 0,\n        largeGasCanCount: 1,\n        turnCount: 0,\n      },\n    }),\n    messages = [],\n  }) {\n    this.engine = engine;\n    this.map = map;\n    this.mapInitialized = mapInitialized;\n    this.tileMap = tileMap;\n    this.mapWidth = mapWidth;\n    this.mapHeight = mapHeight;\n    this.display = display;\n    this.spriteMode = spriteMode;\n    this.tileKey = tileKey;\n    this.mode = mode;\n    this.messages = messages;\n    this.getSelectedCharacter = getSelectedCharacter;\n  }\n\n  initializeMode () {\n    this.mode.initialize();\n  }\n  \n  updateMode () { // this is run every game turn\n    this.mode.update();\n  }\n\n  randomlyPlaceActorOnMap(actor) {\n    let kill = 0;\n    let placed = false;\n    while (!placed) {\n      let pos = Helper.getRandomPos(this.map).coordinates\n      if (this.canOccupyPosition(pos, actor)) {\n        let tile = this.map[Helper.coordsToString(pos)]\n        actor.pos = { ...pos }\n        tile.entities.push(actor);\n        placed = true;\n      }\n      kill += 1;\n      if (kill >= 100) {\n        placed = true;\n      }\n    }\n    return placed;\n  }\n\n  randomlyPlaceAllActorsOnMap() {\n    this.engine.actors.forEach((actor) => {\n      this.randomlyPlaceActorOnMap(actor);\n    })\n  }\n\n  placeActorsOnMap() {\n    this.engine.actors.forEach((actor) => {\n      let tile = this.map[Helper.coordsToString(actor.pos)]\n      if (tile) {\n        tile.entities.push(actor);\n      } else {\n        console.log(`could not place ${actor.id}: ${actor.name} on map`);\n      }\n    })\n  }\n\n  placeActorOnMap(actor) {\n    let tile = this.map[Helper.coordsToString(actor.pos)]\n    if (tile) {\n      tile.entities.push(actor);\n      return true\n    } else {\n      console.log(`could not place ${actor.id}: ${actor.name} on map`);\n      return false\n    }\n  }\n\n  removeActorFromMap (actor) {\n    let tile = this.map[Helper.coordsToString(actor.pos)]\n    if (!tile) return false;\n    this.map[Helper.coordsToString(actor.pos)].entities = tile.entities.filter((ac) => ac.id !== actor.id);\n    return true;\n  }\n\n  createLevel () {\n    let digger = new ROT.Map.Arena(this.mapWidth, this.mapHeight);\n    // let digger = new ROT.Map.Rogue();\n    // let digger = new ROT.Map.DividedMaze();\n    // let digger = new ROT.Map.EllerMaze();\n    // let digger = new ROT.Map.Cellular();\n    // let digger = new ROT.Map.Digger(this.mapWidth, this.mapHeight);\n    // let digger = new ROT.Map.IceyMaze();\n    // let digger = new ROT.Map.Uniform();\n    let freeCells = [];\n    let digCallback = function (x, y, value) {      \n      let key = x + \",\" + y;\n      let type = 'GROUND';\n      let currentFrame = 0;\n      if (value) { \n        type = 'WALL';\n        // type = 'WATER';\n      }\n\n      if (Constant.TILE_KEY[type].animation) {\n        currentFrame = Helper.getRandomInt(0, Constant.TILE_KEY[type].animation.length)\n      }\n\n      this.map[key] = {\n        type,\n        currentFrame,\n        entities: [],\n      };\n      freeCells.push(key);\n    }\n    digger.create(digCallback.bind(this));\n    this.randomlyPlaceAllActorsOnMap()\n  }\n\n  createEmptyLevel () {\n    for (let i = 0; i < this.mapHeight; i ++) {\n      for (let j = 0; j < this.mapWidth; j ++) {\n        const key = `${j},${i}`\n        let type = 'GROUND';\n        let currentFrame = 0;\n\n        if (Constant.TILE_KEY[type].animation) {\n          currentFrame = Helper.getRandomInt(0, Constant.TILE_KEY[type].animation.length)\n        }\n\n        this.map[key] = {\n          type,\n          currentFrame,\n          entities: [],\n        };\n      }\n    }\n  }\n\n  createCustomLevel (data) {\n    Object.keys(data.tiles).forEach((key, i) => {\n      const tile = data.tiles[key];\n      let type = JSON.parse(tile.data);\n      let currentFrame = 0;\n      if (!type) {\n        type = 'GROUND';\n      }\n\n      if (Constant.TILE_KEY[type].animation) {\n        currentFrame = Helper.getRandomInt(0, Constant.TILE_KEY[type].animation.length)\n      }\n\n    \n      this.map[key] = {\n        type,\n        currentFrame,\n        entities: [],\n      };\n    })\n\n    this.placeInitialEntities();\n  }\n\n  canOccupyPosition (pos, entity = {passable: false}) {\n    let result = false;\n    let targetTile = this.map[Helper.coordsToString(pos)];\n    if (targetTile) {\n      let hasImpassableEntity = targetTile.entities.filter((entity) => !entity.passable).length > 0;\n      if (!hasImpassableEntity || entity.passable) {\n        let tile = this.map[Helper.coordsToString(pos)];\n        if (this.tileKey[tile.type].passable) {\n          result = true;\n        }\n      }\n    }\n\n    return result;\n  }\n\n  cursorCanOccupyPosition(pos) {\n    let result = false;\n    let targetTile = this.map[Helper.coordsToString(pos)];\n    if (targetTile) {\n      result = true;\n    }\n\n    return result;\n  }\n\n  show (document) {\n    this.display.initialize(document)\n  }\n\n  processTileMap (callback) {\n    for (let key in this.map) {\n      let parts = key.split(\",\");\n      let x = parseInt(parts[0]);\n      let y = parseInt(parts[1]);\n      let tile = this.map[key];\n      // let { foreground, background } = this.tileKey[tile.type]\n      // Proto code to handle tile animations\n      let tileRenderer = this.tileKey[tile.type]\n      let nextFrame = this.animateTile(tile, tileRenderer);\n      let character = nextFrame.character;\n      let foreground = nextFrame.foreground;\n      let background = nextFrame.background;\n\n      if (tile.entities.length > 0) {\n        let entity = tile.entities[tile.entities.length - 1]\n        nextFrame = this.animateEntity(entity);\n        \n        character = nextFrame.character\n        foreground = nextFrame.foreground\n        if (nextFrame.background) {\n          background = nextFrame.background\n        }\n      }\n      callback(key, x, y, character, foreground, background);\n    }\n  }\n\n  initializeMap () {\n    if (this.mapInitialized) return false;\n    this.mapInitialized = true;\n    this.processTileMap((tileKey, x, y, character, foreground, background) => {\n      let node = this.display.createTile(x, y, character, foreground, background);\n      this.tileMap[tileKey] = node;\n    });\n    this.display.draw();\n  }\n\n  getPlayers () {\n    return this.engine.actors.filter((actor) => actor.entityTypes.includes('PLAYING'))\n  }\n  \n  draw () {\n    this.processTileMap((tileKey, x, y, character, foreground, background) => {\n      this.display.updateTile(this.tileMap[tileKey], character, foreground, background);\n    });\n\n    let playerPos = null;\n    const players = this.getPlayers();\n    if (players.length) { playerPos = players[0].pos }\n\n    this.display.draw(playerPos);\n  }\n\n  getEntityRenderer (renderer) {\n    // if sprite mode is on and the renderer has a sprite defined, use that\n    if (this.spriteMode && renderer.hasOwnProperty('sprite')) {\n      return {...renderer, character: renderer.sprite, foreground: renderer.color}\n      // return {character: renderer.sprite, foreground: renderer.background, background: ''}\n    }\n    // else us the ascii character\n    return {...renderer, foreground: renderer.color}\n  }\n\n  getTileRenderer (renderer) {\n    // if sprite mode is on and the renderer has a sprite defined, use that\n    if (this.spriteMode && renderer.hasOwnProperty('sprite')) {\n      return {...renderer, character: renderer.sprite}\n    }\n    // else us the ascii character\n    return renderer\n  }\n  \n  animateEntity (entity) {\n    let renderer = entity.renderer;\n    let { character, foreground, background } = this.getEntityRenderer(renderer)\n    if (renderer.animation) {\n      let frame = this.getEntityRenderer(renderer.animation[entity.currentFrame]);\n      character = frame.character;\n      foreground = frame.foreground;\n      background = frame.background;\n      entity.currentFrame = (entity.currentFrame + 1) % renderer.animation.length;\n    }\n    return {character, foreground, background}\n  }\n\n  animateTile (tile, renderer) {\n    let {character, foreground, background} = this.getTileRenderer(renderer)\n    if (renderer.animation) {\n      let frame = this.getTileRenderer(renderer.animation[tile.currentFrame]);\n      character = frame.character\n      foreground = frame.foreground;\n      background = frame.background;\n      tile.currentFrame = (tile.currentFrame + 1) % renderer.animation.length;\n    }\n    return {character, foreground, background}\n  }\n\n  addActor (actor, engine = this.engine) {\n    let isPlaced = this.placeActorOnMap(actor); // replace with placeActorOnMap\n    if (!isPlaced) { return false }\n    engine.actors.push(actor);\n    this.draw();\n    return true\n  }\n\n  placeAndDrawActor (actor) {\n    this.placeActorsOnMap(); // replace with placeActorOnMap\n    this.draw();\n  }\n\n  removeActor (actor) {\n    this.engine.actors = this.engine.actors.filter((ac) => ac.id !== actor.id);\n    // this.engine.currentActor = this.engine.actors.length - 1; // should remove need for this line\n    // this.engine.currentActor = (this.engine.currentActor) % this.engine.actors.length;\n    // this.engine.currentActor = (this.engine.currentActor + 1) % this.engine.actors.length;\n    this.removeActorFromMap(actor);\n    this.draw();\n  }\n\n  initializeUI (presserRef, document) {\n    this.show(document);\n    presserRef.current.focus();\n  }\n\n  initializeGameData () {\n    this.engine.game = this;\n    const selectedCharacter = this.getSelectedCharacter();\n    this.engine.actors = [selectedCharacter];\n    this.engine.actors.forEach((actor) => {\n      actor.game = this;\n    });\n    this.createEmptyLevel();\n    // this.createLevel();\n    // this.createCustomLevel(MAP_DATA);\n    this.initializeMap();\n    this.draw();\n    // this.randomlyPlaceAllActorsOnMap()\n    // this.placeActorsOnMap()\n    // this.initializeMode();\n    this.mode.initialize();\n  }\n\n  initialize (presserRef, document) {\n    this.initializeUI(presserRef, document);\n    this.initializeGameData();\n    // hack to register sprite mode\n    setTimeout(() => {\n      this.spriteMode = false;\n      this.draw()\n    }, 100)\n    setTimeout(() => {\n      this.spriteMode = true;\n      this.draw()\n    }, 100)\n    // end hack\n  }\n\n  addMessage (text, type) {\n    const message = new Message.Message({text, type})\n    this.messages.push(message);\n  }\n}\n\n\n/************************** UI ********************************/\nexport const handleKeyPress = (event, engine) => {\n  if (!engine.isRunning) {\n    let actor = engine.actors[engine.currentActor];\n    let keymap = actor.keymap;\n    let code = event.key;\n    if (!(code in keymap)) { return; }\n    keymap[code]['activate']();\n    engine.start()\n  }\n  return;\n}\n\nexport const DisplayElement = (presserRef, handleKeyPress, engine) => {\n  return (\n    <div\n      id='display'\n      ref={presserRef}\n      onKeyDown={(event) => handleKeyPress(event, engine)}\n      // onKeyUp={(event) => handleKeyPress(event, engine)}\n      tabIndex='0'\n    />\n  )\n}\n/************************** UI ********************************/\n","import React from 'react';\nimport { SCREENS } from '../Screen/constants';\n\nclass Instructions extends React.Component {\n  render() {\n    let modeDetails = null;\n    try {\n      modeDetails = (\n        <span>\n          <div className='Instructions__block'>{`Wave ${this.props.game.mode.data.level}`}</div>\n          <div className='Instructions__block'>\n            {\n              `${this.props.game.mode.countNpcSafe()} of  ${this.props.game.mode.getSaveCountRequirement()} are safe!`\n            }\n          </div>\n        </span>\n      );\n    } catch { return }\n\n    return (\n      <div className=\"Instructions UI\">\n        <p className='flow-text'>\n          Save all of the citizens from the burning keep and get them to the safe zone!\n        </p>\n        <div className='flow-text'>\n          { modeDetails }\n          <div \n            className='Instructions__block'\n            onClick={() => this.props.setActiveScreen(SCREENS.TITLE)}\n          >\n            {/* <button className='btn btn-main' onClick={() => window.location.reload()}>\n              Restart\n            </button> */}\n            {/* <button className='btn btn-main' onClick={() => this.props.setActiveScreen(SCREENS.TITLE)}>\n              Restart\n            </button> */}\n            <button className='btn btn-main'>\n              Restart\n            </button>\n          </div>\n          <div \n            className='Instructions__block'\n            onClick={() => this.props.toggleSpriteMode()}\n          >\n            <button className='btn btn-main'>\n              {\n                this.props.spriteMode ? (\n                  'ASCII mode'\n                ) : (\n                  'Sprite mode'\n                )\n              }\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Instructions;","import React from 'react';\n\nfunction Button(props) {\n  let color = props['color'];\n  if (!color) color = 'grey';\n  return (\n    <button\n      onClick={props.onClick}\n      className={`Button btn ${color}`}\n    >\n      {props.children}  \n    </button>\n  )\n}\n\nexport default Button;\n","import React from 'react';\nimport Button from './Button';\n\nclass Information extends React.Component {\n  render() {\n    return (\n      <div className=\"Information UI\">\n        <div className='flow-text'>Information</div>\n        {\n          this.props.data && (\n            this.props.data.map((item, index) => {\n              return (\n                <Button key={index} color={item['color']} onClick={() => null}>\n                  {`${item.label}: ${item.value}`}\n                </Button>\n              )\n            })\n          )\n        }\n      </div>\n    );\n  }\n}\n\nexport default Information;","import React from 'react';\nimport Button from './Button';\n\nclass Equipment extends React.Component {\n  render() {\n    return (\n      <div className=\"Equipment UI\">\n        {\n          this.props.equipment && (\n            <div>\n              <div className='flow-text'>Equipment</div>\n              <div>\n                {\n                  this.props.equipment.map((slot, index) => {\n                    return (\n                      <Button key={index} onClick={() => null}>\n                        {slot.name} {slot.item ? slot.item.renderer.character : ''}\n                      </Button>\n                    )\n                  })\n                }\n              </div>\n            </div>\n          )\n        }\n      </div>\n    );\n  }\n}\n\nexport default Equipment;","import React from 'react';\nimport Button from './Button';\n\nclass Inventory extends React.Component {\n  render() {\n    return (\n      <div className=\"Inventory UI\">\n        {\n          this.props.inventory && (\n            <div>\n              <div className='flow-text'>Inventory</div>\n              <div>\n                {\n                  this.props.inventory.map((slot, index) => {\n                    return (\n                      <Button key={index} onClick={() => null}>\n                        {`${slot.itemType} | x ${slot.items.length}`}\n                      </Button>\n                    )\n                  })\n                }\n              </div>\n            </div>\n          )\n        }\n      </div>\n    );\n  }\n}\n\nexport default Inventory;","import React from 'react';\nimport Button from './Button';\n\nclass Keymap extends React.Component {\n  render() {\n    return (  \n      <div className=\"Keymap UI\">\n        <div className='flow-text center'>Keymap</div>\n        {\n          \n          this.props.keymap && (\n            Object.entries(this.props.keymap).map(([key, value], index) => {\n              const hidden = value.hasOwnProperty('hidden') ? value.hidden : false;\n              const color = key === 'Escape' ? 'amber darken-3' : 'grey darken-1';\n              if (!hidden) {\n                return (\n                  <Button \n                    key={index}\n                    onClick={() => {\n                        value.activate();\n                        if (!this.props.game.engine.isRunning) this.props.game.engine.start();\n                        this.props.refocus();\n                      } \n                    }\n                    color={color}\n                  >\n                    {key} {value.label}\n                  </Button>\n                )\n              }\n            })\n          )\n        }\n      </div>\n    );\n  }\n}\n\nexport default Keymap;","import React from 'react';\n\nfunction Message (props) {\n  return (\n    <div\n      className='Message'\n      style={{\n        color: props.color,\n        backgroundColor: props.backgroundColor,\n        borderColor: props.color,\n      }}\n    >\n      {props.children}\n    </div>\n  )\n}\n\nclass Messages extends React.Component {\n  render() {\n    return (\n      <div className=\"Messages UI\">\n        <div className='flow-text center'>Messages</div>\n        {\n          this.props.messages && (\n            this.props.messages.map((message, index) => {\n              return (\n                <Message \n                  key={index} \n                  color={message.type.color}\n                  backgroundColor={message.type.backgroundColor}\n                >\n                  {`${message.text}`}\n                </Message>\n              )\n            })\n          )\n        }\n      </div>\n    );\n  }\n}\n\nexport default Messages;","import * as Helper from '../lib/helper';\n\nexport const receiver = (pos) => {\n  return {\n    responded: false,\n    RECIEVE: (parameters) => {\n      let { self, component, message } = parameters\n      console.log(message, pos.x, pos.y)\n      if (!component.responded) {\n        component.responded = true\n        self.sendEvent(parameters.sender, 'hello', 'RECIEVE', { message: 'copy', sender: self })\n      }\n    }\n  }\n}\n\nexport const impasse = (passable = false) => {\n  return {\n    passable,\n    MAKE_PASSABLE: (parameters) => {\n      let { component } = parameters;\n      component.passable = true;\n    },\n    MAKE_IMPASSABLE: (parameters) => {\n      let { component } = parameters;\n      component.passable = false;\n    }\n  }\n}\n\nexport const body = (world, pos = { x: 0, y: 0 }) => {\n  if (world) {\n    return {\n      pos,\n      MOVE: (parameters) => {\n        let { self, component, currentPos, targetPos } = parameters\n        if (world.canOccupy(world.map, targetPos)) {\n          component.pos = targetPos\n          let tile = world.map[Helper.coordsToString(currentPos)]\n          world.map[Helper.coordsToString(currentPos)] = {...tile, entities: []}\n          self.sendEvent(self, 'PREPARE_RENDER')\n          // Helper.DRAW(world.map, world.display)\n        } else {\n          console.log('can\\'t move there')\n        }\n      }\n    }\n  }\n  console.log('No world to occupy');\n  return {}\n}\n\nexport const destructible = (world, durability = 1) => {\n  return {\n    durability,\n    DECREASE_DURABILITY: (parameters) => {\n      let { self, component, value } = parameters;\n      component.durability -= value\n      if (component.durability <= 0) {\n        self.sendEvent(self, 'DESTROY')\n      }\n    },\n    INCREASE_DURABILITY: (parameters) => {\n      let { component, value } = parameters;\n      component.durability += value\n    },\n    DESTROY: (parameters) => {\n      let { self, component, value } = parameters;\n      let tile = world.map[Helper.coordsToString(self.components.body.pos)];\n      world.map[Helper.coordsToString(self.components.body.pos)].entities = tile.entities.filter((e) => e.id !== self.id);\n      // self.sendEvent(self, 'PREPARE_RENDER')\n      // Helper.DRAW(world.map, world.display)\n    }\n  }\n}\n\nexport const attack = (damage = 1) => {\n  return {\n    damage,\n  }\n}\n\nexport const throwable = (world) => {\n  return {\n    THROW: (parameters) => {\n      let { self, component, direction } = parameters;\n      // if next tile is passable\n        // send move action to self\n        // send throw action to self\n      // else\n        // send decrease_durability to entity next in tile\n        // send decrease_durability to self\n      let currentPos = self.components.body.pos;\n      let nextPos = { x: currentPos.x + direction.x, y: currentPos.y + direction.y }\n      let nextTile = world.map[Helper.coordsToString(nextPos)];\n      if (world.canOccupy(world.map, nextPos)) { // change to check for target entity\n        self.sendEvent(\n          self, 'MOVE', {\n            currentPos: currentPos,\n            targetPos: nextPos\n          }\n        )\n        self.sendEvent(self, 'THROW', {direction});\n      } else {\n        if (world.map.hasOwnProperty(Helper.coordsToString(nextPos))) {\n          let impassable_and_destructable_entities = Helper.getDestructableEntities(Helper.getImpassableEntities(nextTile.entities))\n          if (impassable_and_destructable_entities.length > 0) {\n            self.sendEvent(impassable_and_destructable_entities[0], 'DECREASE_DURABILITY', { value: 1 });\n          }\n        }\n        self.sendEvent(self, 'DECREASE_DURABILITY', { value: 1 });\n      }\n    },\n  }\n}\n\nexport const renderer = (world, character = '', color = 'white', background = false) => {\n  return {\n    character,\n    color,\n    background,\n    PREPARE_RENDER: (parameters) => {\n      let { self } = parameters\n      if (self.components.hasOwnProperty('body')) {\n        world.map[Helper.coordsToString(self.components.body.pos)].entities.push(self)\n      }\n    }\n  }\n}","import React from 'react';\nimport { SCREENS } from './constants';\nimport * as Engine from '../engine';\nimport * as Game from '../game';\nimport Instructions from '../UI/Instructions';\nimport Information from '../UI/Information';\nimport Equipment from '../UI/Equipment';\nimport Inventory from '../UI/Inventory';\nimport KeymapUI from '../UI/Keymap';\nimport Messages from '../UI/Messages';\n\nclass Level extends React.Component {\n  constructor(props) {\n    super(props);\n    let ENGINE = new Engine.Engine({});\n    let game = new Game.Game({ engine: ENGINE, getSelectedCharacter: () => this.props.selectedCharacter.initialize(ENGINE)})\n\n    this.state = {\n      game: game,\n      activeTab: 0,\n      spriteMode: game.spriteMode,\n    };\n    this.presserRef = React.createRef();\n  }\n\n  async componentDidMount() {\n    this.state.game.initialize(this.presserRef, document)\n    this.state.game['backToTitle'] = () => this.props.setActiveScreen(SCREENS.TITLE);\n    this.state.game['toLose'] = () => this.props.setActiveScreen(SCREENS.LOSE);\n    this.state.game['toWin'] = () => this.props.setActiveScreen(SCREENS.WIN);\n    this.state.game.updateReact = (newGameState) => { this.setState({game: newGameState}) }\n    this.state.game.engine.start()\n  }\n\n  refocus () {\n    if (this.presserRef) this.presserRef.current.focus();\n  }\n\n  toggleSpriteMode () {\n    this.state.game.spriteMode = !this.state.game.spriteMode;\n    this.state.game.draw();\n    // this.presserRef.current.focus();\n    this.refocus();\n    this.setState({ spriteMode: this.state.game.spriteMode})\n  }\n\n  render() {\n    let currentActor = this.state.game.engine.actors[this.state.game.engine.currentActor];\n    let data = [\n      {\n        label: 'Wave',\n        value: `Current: ${this.state.game.mode.data.level}, Highest: ${this.state.game.mode.data.highestLevel}`,\n      },\n    ];\n\n    data = data.concat(\n      [\n        ...this.state.game.engine.actors.map((actor, index) => {\n          let result = {\n            label: actor.name,\n            value: index,\n            value: `HP: ${actor.durability}, En/Sp: ${actor.energy}/${actor.speed}`,\n          };\n          if (index === this.state.game.engine.currentActor) {\n            result['color'] = 'red';\n          }\n          return result;\n        })\n      ]\n    )\n\n    return (\n      <div className=\"Level\">\n        <div className='row'>\n          <div className='col s10'>\n            <div className='game_display_container'>\n              {Game.DisplayElement(this.presserRef, Game.handleKeyPress, this.state.game.engine)}\n              {/* <Information data={data} /> */}\n            </div>\n            <Instructions game={this.state.game} spriteMode={this.state.game.spriteMode} setActiveScreen={this.props.setActiveScreen} toggleSpriteMode={this.toggleSpriteMode.bind(this)} />\n          </div>\n          <div className='col s2'>\n            <KeymapUI keymap={this.state.game.visibleKeymap} game={this.state.game} refocus={this.refocus.bind(this)}/>\n            <Messages messages={this.state.game.messages.slice(-5).reverse()} />\n          </div>\n          {/* <button className='btn' onClick={() => this.props.setActiveScreen(SCREENS.TITLE)}>Quit</button> */}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Level;\n","import React from 'react';\nimport { SCREENS } from './constants';\n\nconst CharacterSelect = (props) => {\n  return (\n    <div className='CharacterSelect'>\n      {\n        props.characters.map((character, index) => {\n          let color = '';\n          if (props.selectedCharacter) {\n            color = props.selectedCharacter.name === character.name ? 'red' : ''\n          }\n\n          return (\n            <button\n              key={index}\n              style={{\n                position: 'relative',\n                top: '280px'\n              }}\n              className={`CharacterSelect__button btn btn-main`}\n              onClick={() => {\n                props.setSelectedCharacter(character)\n                props.setActiveScreen(SCREENS.LEVEL)\n              }}\n            >\n              Play Game\n            </button>\n          )\n        })\n      }\n    </div>\n  );\n}\n\nclass Title extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n  }\n\n  render() {\n    return (\n      <div className=\"Title\">\n        <div\n          style={{\n\n            width: '100vw',\n            height: '100vh',\n            backgroundColor: 'rgb(4, 49, 61)',\n            backgroundImage: `url(\"${window.PUBLIC_URL}/fire_man_blue.jpg\")`,\n            backgroundRepeat: 'no-repeat',\n            backgroundPosition: 'center',\n            backgroundPositionY: '10px'\n\n          }}\n        >\n          <CharacterSelect \n            characters={this.props.characters} \n            selectedCharacter={this.props.selectedCharacter} \n            setSelectedCharacter={this.props.setSelectedCharacter}\n            setActiveScreen={this.props.setActiveScreen}\n          />\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Title;","import React from 'react';\nimport { SCREENS } from './constants';\n\nconst CharacterSelect = (props) => {\n  return (\n    <div className='CharacterSelect'>\n      {\n        props.characters.map((character, index) => {\n          let color = '';\n          if (props.selectedCharacter) {\n            color = props.selectedCharacter.name === character.name ? 'red' : ''\n          }\n\n          return (\n            <button\n              key={index}\n              style={{\n                position: 'relative',\n                top: '280px'\n              }}\n              className={`CharacterSelect__button btn btn-main`}\n              onClick={() => {\n                props.setSelectedCharacter(character)\n                props.setActiveScreen(SCREENS.LEVEL)\n              }}\n            >\n              You Lost. Try Again?\n            </button>\n          )\n        })\n      }\n    </div>\n  );\n}\n\nclass Lose extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n  }\n\n  render() {\n    return (\n      <div className=\"Title\">\n        <div\n          style={{\n\n            width: '100vw',\n            height: '100vh',\n            backgroundColor: '#222',\n            // backgroundColor: 'rgb(4, 49, 61)',\n            backgroundImage: `url(\"${window.PUBLIC_URL}/fire_man_blue.jpg\")`,\n            backgroundRepeat: 'no-repeat',\n            backgroundPosition: 'center',\n            backgroundPositionY: '10px'\n\n          }}\n        >\n          <CharacterSelect \n            characters={this.props.characters} \n            selectedCharacter={this.props.selectedCharacter} \n            setSelectedCharacter={this.props.setSelectedCharacter}\n            setActiveScreen={this.props.setActiveScreen}\n          />\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Lose;","import React from 'react';\nimport { SCREENS } from './constants';\n\nconst CharacterSelect = (props) => {\n  return (\n    <div className='CharacterSelect'>\n      {\n        props.characters.map((character, index) => {\n          let color = '';\n          if (props.selectedCharacter) {\n            color = props.selectedCharacter.name === character.name ? 'red' : ''\n          }\n\n          return (\n            <button\n              key={index}\n              style={{\n                position: 'relative',\n                top: '280px'\n              }}\n              className={`CharacterSelect__button btn btn-main`}\n              onClick={() => {\n                props.setSelectedCharacter(character)\n                props.setActiveScreen(SCREENS.LEVEL)\n              }}\n            >\n              You Saved the Castle! Play Again?\n            </button>\n          )\n        })\n      }\n    </div>\n  );\n}\n\nclass Win extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n  }\n\n  render() {\n    return (\n      <div className=\"Title\">\n        <div\n          style={{\n\n            width: '100vw',\n            height: '100vh',\n            // backgroundColor: '#eee',\n            backgroundColor: 'rgb(54,160,190)',\n            backgroundImage: `url(\"${window.PUBLIC_URL}/fire_man_blue.jpg\")`,\n            backgroundRepeat: 'no-repeat',\n            backgroundPosition: 'center',\n            backgroundPositionY: '10px'\n\n          }}\n        >\n          <CharacterSelect \n            characters={this.props.characters} \n            selectedCharacter={this.props.selectedCharacter} \n            setSelectedCharacter={this.props.setSelectedCharacter}\n            setActiveScreen={this.props.setActiveScreen}\n          />\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Win;","// import deps\nimport * as Item from '../items';\nimport * as Entity from '../entites';\nimport * as Constant from '../constants';\nimport * as Keymap from '../Keymap';\nimport { createFourDirectionMoveOptions } from '../Keymap/helper';\n\nexport default function (engine) {\n  // define keymap\n  const keymap = (engine) => {\n    return {\n      ...createFourDirectionMoveOptions(Keymap.push, engine, 'push', true),\n      t: {\n        activate: () => Keymap.activateProjectile(engine, 1, 5),\n        label: 'shoot water',\n      },\n      c: {\n        activate: () => Keymap.chop(engine),\n        label: 'chop',\n      },\n      e: {\n        activate: () => Keymap.activateEquipment(engine),\n        label: 'equipment',\n      },\n      p: {\n        activate: () => Keymap.equipRandomFromTile(engine),\n        label: 'pick up',\n      },\n      g: {\n        activate: () => Keymap.activateGrab(engine),\n        label: 'grab',\n      },\n      r: {\n        activate: () => Keymap.releaseGrab(engine),\n        label: 'release',\n      },\n    };\n  }\n  // instantiate class\n  let actor = new Entity.Player({\n    pos: { x: 19, y: 22 },\n    renderer: {\n      character: 'F',\n      sprite: '',\n      color: Constant.THEMES.SOLARIZED.base3,\n      background: Constant.THEMES.SOLARIZED.yellow,\n    },\n    name: Constant.PLAYER_NAME,\n    equipment: Constant.EQUIPMENT_LAYOUTS.limited(),\n    actions: [],\n    speed: 100,\n    durability: 4,\n    keymap: keymap(engine),\n  })\n\n  // default items to container\n  // const axe = Array(2).fill('').map(() => Item.axe(engine));\n  // actor.container = [\n  //   new Entity.ContainerSlot({\n  //     itemType: axe[0].name,\n  //     items: axe,\n  //   }),\n  // ]\n  return actor;\n}","import { PickupItem, EquipItemFromTile } from '../../actions';\nimport { ENERGY_THRESHOLD } from '../../constants';\nimport { coordsToString, getRandomInArray } from '../../../helper';\nimport { MESSAGE_TYPE } from '../../message';\n\nexport const pickupRandom = (engine) => {\n  let actor = engine.actors[engine.currentActor];\n  let entities = engine.game.map[coordsToString(actor.pos)].entities.filter((e) => e.id !== actor.id);\n  if (entities.length > 0) {\n    actor.setNextAction(new PickupItem({\n      item: getRandomInArray(entities),\n      game: engine.game,\n      actor,\n      energyCost: ENERGY_THRESHOLD\n    }));\n  }\n  else {\n    console.log('nothing to pickup.');\n  }\n};\n\nexport const equipRandomFromTile = (engine) => {\n  let actor = engine.actors[engine.currentActor];\n  let entities = engine.game.map[coordsToString(actor.pos)].entities.filter((e) => e.id !== actor.id);\n  if (entities.length > 0) {\n    actor.setNextAction(new EquipItemFromTile({\n      item: getRandomInArray(entities),\n      game: engine.game,\n      actor,\n      energyCost: ENERGY_THRESHOLD\n    }));\n  }\n  else {\n    engine.game.addMessage(`nothing to equip.`, MESSAGE_TYPE.ACTION);\n  }\n};","import RockLee from './RockLee';\nimport FireFighter from './FireFighter';\n\nlet Characters = () => {\n  return {\n    // RockLee,\n    FireFighter,\n  }\n}\n\nexport default Characters;","import React from 'react';\nimport ReactCSSTransitionGroup from 'react-addons-css-transition-group';\nimport { SCREENS } from './Screen/constants';\nimport Level from './Screen/Level';\nimport Title from './Screen/Title';\nimport Lose from './Screen/Lose';\nimport Win from './Screen/Win';\nimport Characters from './Characters/index';\nimport SOUNDS from './sounds';\n\nclass Nystrum extends React.Component {\n  constructor() {\n    super();\n    let characterKey = Characters();\n    let characters = Object.keys(characterKey).map((key, i) => {\n      return {\n        // [key]: characterKey[key],\n        initialize: characterKey[key],\n        selected: false,\n        name: key,\n      }\n    });\n    this.state = {\n      activeScreen: SCREENS.TITLE,\n      characters,\n      selectedCharacter: null,\n    };\n  }\n\n  setActiveScreen (activeScreen) {\n    if (activeScreen === SCREENS.TITLE) {\n      Object.keys(SOUNDS).forEach(key => {\n        SOUNDS[key].stop();\n      });\n    }\n    this.setState({activeScreen})\n  }\n\n  setSelectedCharacter (character) {\n    this.setState({selectedCharacter: {...character}})\n  }\n\n  getActiveScreen () {\n    const titleScreen = <Title \n      key={SCREENS.TITLE} \n      setActiveScreen={this.setActiveScreen.bind(this)}\n      setSelectedCharacter={this.setSelectedCharacter.bind(this)}\n      selectedCharacter={this.state.selectedCharacter}\n      characters={this.state.characters}\n    />\n    const loseScreen = <Lose \n      key={SCREENS.LOSE} \n      setActiveScreen={this.setActiveScreen.bind(this)}\n      setSelectedCharacter={this.setSelectedCharacter.bind(this)}\n      selectedCharacter={this.state.selectedCharacter}\n      characters={this.state.characters}\n    />\n    const winScreen = <Win \n      key={SCREENS.WIN} \n      setActiveScreen={this.setActiveScreen.bind(this)}\n      setSelectedCharacter={this.setSelectedCharacter.bind(this)}\n      selectedCharacter={this.state.selectedCharacter}\n      characters={this.state.characters}\n    />\n    const levelScreen = <Level \n      key={SCREENS.LEVEL} \n      setActiveScreen={this.setActiveScreen.bind(this)}\n      selectedCharacter={this.state.selectedCharacter}\n    />\n\n    switch (this.state.activeScreen) {\n      case SCREENS.TITLE:\n        return titleScreen\n      case SCREENS.LOSE:\n        return loseScreen\n      case SCREENS.WIN:\n        return winScreen\n      case SCREENS.LEVEL:\n        return levelScreen\n      default:\n        return titleScreen\n    }\n  }\n\n  render() {\n    const activeScreen = this.getActiveScreen();\n    return (\n      <div className=\"Nystrum\">\n        <ReactCSSTransitionGroup\n          transitionName=\"fade\"\n          transitionAppear={true}\n          transitionEnter={true}\n          transitionLeave={true}\n          transitionAppearTimeout={500}\n          transitionEnterTimeout={500}\n          transitionLeaveTimeout={300}\n        >\n          { activeScreen }\n        </ReactCSSTransitionGroup>\n      </div>\n    );\n  }\n}\n\nexport default Nystrum;\n","import * as ROT from 'rot-js';\n\nexport const TILE_KEY = () => {\n  return {\n    'GROUND': {\n      background: '#974',\n      foreground: '#aaa',\n      character: '.',\n      passable: true,\n    }\n  }\n}\n\n// RENDERING\n\nexport const DRAW = (map, display) => {\n  for (let key in map) {\n    let parts = key.split(\",\");\n    let x = parseInt(parts[0]);\n    let y = parseInt(parts[1]);\n    let tile = map[key];\n    let { character, foreground, background } = TILE_KEY()[tile.type]\n    if (tile.entities.length > 0) {\n      let entity = tile.entities[tile.entities.length - 1]\n      character = entity.components.renderer.character\n      foreground = entity.components.renderer.color\n      if (entity.components.renderer.background) {\n        background = entity.components.renderer.background\n      }\n    }\n    display.draw(x, y, character, foreground, background);\n  }\n}\n\n// END RENDERING\n\nexport const coordsToString = (coords) => `${coords.x},${coords.y}`\n\nexport const getImpassableEntities = (entities) => {\n  return entities.filter((e) => e.components.hasOwnProperty('impasse') && !e.components.impasse.passable)\n}\n\nexport const getDestructableEntities = (entities) => {\n  return entities.filter((e) => e.components.hasOwnProperty('destructible'))\n}\n\nexport const delay = (timeDelayed = 100) => {\n  return new Promise(resolve => setTimeout(resolve, timeDelayed));\n}\n\nexport const exampleEngine = () => {\n  let scheduler = new ROT.Scheduler.Simple();\n  let engine = new ROT.Engine(scheduler);\n  let output = [];\n  /* sample actor: pauses the execution when dead */\n  let actor = {\n    lives: 3,\n    act: function () {\n      let done = null;\n      let promise = {\n        then: function (cb) { done = cb; }\n      }\n\n      output.push(\".\");\n      // SHOW(output.join(\"\"));\n      console.log(output.join(\"\"));\n\n      this.lives--;\n\n      /* if alive, wait for 500ms for next turn */\n      if (this.lives) {\n        setTimeout(function () { done(); }, 500);\n      }\n\n      return promise;\n    }\n  }\n  scheduler.add(actor, true);\n  engine.start();\n}\n\nexport const getRandomInArray = (array) => {\n  return array[Math.floor(Math.random() * array.length)];\n}","import * as Helper from '../lib/helper';\n\nexport const createEntity = (id = null, name = 'Empty', components = {}, world) => {\n  let entity = {\n    id,\n    name,\n    components,\n    world,\n    sendEvent: (target, eventType, parameters) => sendEvent(target, eventType, parameters, world),\n  };\n  return entity\n}\n\nexport const sendEvent = async (target = null, eventType = null, parameters = null, world = null) => {\n  let success = false;\n  for (let key in target.components) {\n    let component = target.components[key]\n    if (component.hasOwnProperty(eventType)) {\n      console.log('SUCCESSFUL EVENT: ', eventType)\n      success = true\n      if (eventType !== 'PREPARE_RENDER') {\n        await Helper.delay();\n      }\n      component[eventType]({ ...parameters, self: target, component: component });\n      Helper.DRAW(world.map, world.display)\n    }\n  }\n  if (!success) {\n    console.log('FAILED EVENT')\n  }\n};","import React from 'react';\nimport '../App.css';\nimport * as ROT from 'rot-js';\nimport * as Entity from './lib/entity'\nimport * as Helper from './lib/helper'\nimport * as Components from './components/index'\n\nconst SHOW = (canvas) => {\n  let d = document.getElementById('display')\n  d.appendChild(canvas)\n}\n\nconst CREATE_LEVEL = (world) => {\n  let digger = new ROT.Map.Arena();\n  let freeCells = [];\n  let digCallback = function (x, y, value) {\n    if (value) { return; }\n    let key = x + \",\" + y;\n    world.map[key] = {\n      type: 'GROUND',\n      entities: [],\n    };\n    freeCells.push(key);\n  }\n  digger.create(digCallback.bind(this));\n}\n\nlet scheduler = new ROT.Scheduler.Simple()\nlet engine = new ROT.Engine(scheduler)\n\nlet world = {\n  canAct: true,\n  scheduler,\n  engine,\n  map: {},\n  display: new ROT.Display({ fontSize: 24, bg: '#099' }),\n  canOccupy: (map, pos) => {\n    if (map.hasOwnProperty(Helper.coordsToString(pos))) {\n      let tile = map[Helper.coordsToString(pos)];\n      if (Helper.TILE_KEY()[tile.type].passable && Helper.getImpassableEntities(tile.entities).length === 0) {\n        return true\n      }\n    } else {\n      return false\n    }\n  },\n}\n\nlet naruto = {\n  ...Entity.createEntity(1, 'Naruto', {\n    reciever: Components.receiver({ x: 10, y: 30 }),\n    body: Components.body(world, { x: 19, y: 21 }),\n    renderer: Components.renderer(world, 'N', 'orange', 'black'),\n  },\n    world,\n  ),\n}\n\nlet box = {\n  ...Entity.createEntity(2, 'Box', {\n    body: Components.body(world, { x: 22, y: 21 }),\n    renderer: Components.renderer(world, '#', 'black'),\n    impasse: Components.impasse(),\n    destructible: Components.destructible(world),\n  },\n    world,\n  )\n}\n\nlet box2 = {\n  ...Entity.createEntity(2, 'Box', {\n    body: Components.body(world, { x: 22, y: 19 }),\n    renderer: Components.renderer(world, '#', 'black'),\n    impasse: Components.impasse(),\n    destructible: Components.destructible(world),\n  },\n    world,\n  )\n}\n\nlet box3 = {\n  ...Entity.createEntity(2, 'Box', {\n    body: Components.body(world, { x: 22, y: 17 }),\n    renderer: Components.renderer(world, '#', 'black'),\n    impasse: Components.impasse(),\n    destructible: Components.destructible(world),\n  },\n    world,\n  )\n}\n\nlet kunai = {\n  ...Entity.createEntity(3, 'Kunai', {\n    body: Components.body(world, { x: 20, y: 21 }),\n    renderer: Components.renderer(world, '<>', 'black'),\n    destructible: Components.destructible(world),\n    attack: Components.attack(),\n    throwable: Components.throwable(world),\n  },\n    world,\n  )\n}\n\nclass Original extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n    this.presserRef = React.createRef();\n  }\n\n  handleKeyPress = (event, world, entity) => {\n    let keymap = {\n      w: 0,\n      d: 1,\n      s: 2,\n      a: 3,\n    };\n\n    let code = event.key;\n    let dir = ROT.DIRS[4][keymap[code]];\n    if (code === 't') {\n      kunai.sendEvent(kunai, 'MOVE', {\n        currentPos: kunai.components.body.pos,\n        targetPos: {\n          x: entity.components.body.pos.x + 1,\n          y: entity.components.body.pos.y,\n        },\n      })\n      return kunai.sendEvent(kunai, 'THROW', { direction: { x: 1, y: 0 } })\n    }\n    if (!(code in keymap)) { return; }\n    let newX = entity.components.body.pos.x + dir[0];\n    let newY = entity.components.body.pos.y + dir[1];\n\n    entity.sendEvent(\n      entity, 'MOVE', {\n        currentPos: entity.components.body.pos,\n        targetPos: {\n          x: newX,\n          y: newY\n        }\n      }\n    )\n\n    return;\n    // return Helper.DRAW(world.map, world.display)\n\n  }\n\n  componentDidMount() {\n    ROT.RNG.setSeed(7);\n    SHOW(world.display.getContainer());\n    CREATE_LEVEL(world);\n    naruto.sendEvent(naruto, 'PREPARE_RENDER')\n    // kunai.sendEvent(kunai, 'PREPARE_RENDER')\n    box.sendEvent(box, 'PREPARE_RENDER')\n    box2.sendEvent(box2, 'PREPARE_RENDER')\n    box3.sendEvent(box3, 'PREPARE_RENDER')\n    Helper.DRAW(world.map, world.display)\n    this.presserRef.current.focus();\n  }\n\n  render() {\n    return (\n      <div className=\"App\" ref={this.presserRef} onKeyDown={(event) => this.handleKeyPress(event, world, naruto)} tabIndex='0'>\n        <div id='display'></div>\n      </div>\n    );\n  }\n}\n\nexport default Original;\n","import React from 'react';\nimport './App.css';\nimport Nystrum from './nystrum/Nystrum';\nimport Original from './original/Original';\n\nclass App extends React.Component {\n  render() {\n    return (\n      <div className=\"App container-fluid\">\n        <Nystrum />\n        {/* <Original /> */}\n      </div>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}